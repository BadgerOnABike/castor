---
title: "Fire_veg"
author: "Elizabeth Kleynhans"
date: '2022-08-19'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(sf)
library(tidyverse)
```


```{r}
fire_all<-st_read("C:\\Work\\caribou\\clus_data\\Fire\\Fire_sim_data\\data\\Fire_data_all.gpkg")

```


```{r}
##1. Remove all sites that are not classified as anything or NA's
## Things to consider: if a site is classified as Non-treed I shold probably make a bunch of the variables 0 e.g. stand percent dead, quad diam, crown closure, vri stems, proj_age, proj_height, live stand volume, etc. 
#fire_all<-fire_veg_sf

# looking at how many na values there are
table(is.na(fire_all$bclcs_level_1))
table(is.na(fire_all$bclcs_level_2))
table(is.na(fire_all$bclcs_level_3))
table(is.na(fire_all$bclcs_level_4))
table(is.na(fire_all$bclcs_level_5))

table((fire_all$bclcs_level_1)) # U=unreported, N = non-vegetated, V = vegetated
table((fire_all$bclcs_level_2)) # T= treed, N = Non-treed, L=Land, W=water
table((fire_all$bclcs_level_3)) # A = alpine, U = upland, W = wetland
table((fire_all$bclcs_level_4)) # 
table((fire_all$bclcs_level_5))
table(fire_all$bec_subzone)

```


### Now Im going to try to use the VRI vegetation data to classify vegetation as Perrakis et al. (2018) British Columbia Wildfire Fuel Typing and Fuel Type Layer Description


First I need to create some new variables i.e. time since disturbance in years and time since last harvest. 
```{r}
fire_all$yearHarvest<-as.numeric(as.character(stringi::stri_sub(fire_all$harvest_date,1,4)))
fire_all<- fire_all %>% dplyr::mutate(yearsSinceHarvest = fire_yr - yearHarvest)

fire_all$earliest_nonlogging_dist_type_2<-gsub('[" "]', '', fire_all$earliest_nonlogging_dist_type) # removing some weird characters
table(fire_all$earliest_nonlogging_dist_type)
table(fire_all$earliest_nonlogging_dist_type_2) # better

fire_all$earliest_nonlogging_dist_type<-fire_all$earliest_nonlogging_dist_type_2

fire_all$earliest_nonlogging_dist_type_2<- as.factor(fire_all$earliest_nonlogging_dist_type_2)
levels(fire_all$earliest_nonlogging_dist_type_2)<-list(burn="B",burn="BE", burn="BR", burn="BW", burn="NB",drought="D",  disease="DF", disease="DMP", disease="DS", disease="DSG", insect="I", insect="IBB", insect="IBD", insect="IBF", insect="IBM", insect="IBS", flooding="NF", slide="NS", windthrow="NW", planting="P" ) # amalgamate some categories
table(fire_all$earliest_nonlogging_dist_type_2)

fire_all$earliest_nonlogging_dist_date
fire_all$yearDisturb<-as.numeric(as.character(stringi::stri_sub(fire_all$earliest_nonlogging_dist_date,1,4)))

fire_all$yearsSinceDisturbance<- ifelse (fire_all$fire_yr >= fire_all$yearDisturb, fire_all$fire_yr - fire_all$yearDisturb, NA)
table(fire_all$yearsSinceDisturbance)

```

To save time and effort in coding I create a list of conifer and deciduous species and the bec_subzone codes that equate to wet areas. 
```{r}
conifer<-c("C","CW","Y","YC","F","FD","FDC","FDI","B","BA","BG","BL","H","HM","HW","HXM","J","JR","JS", "P","PJ","PF","PL","PLI","PXJ","PY","PLC","PW","PA","S","SB","SE","SS","SW","SX","SXW","SXL","SXS","T","TW", "XC", "ZC")

deciduous<-c("L", "LA", "LT", "LW", "D", "DR", "U", "UP", "A", "AC", "ACB", "ACT", "AX", "AT", "R", "RA", "E", "EA", "EXP", "EP", "EW", "K", "KC", "V", "VB", "VV", "VP", "G", "M", "MB", "MV", "Q", "QG", "W", "WB", "WP", "WA", "WD", "WS", "WT", "XH", "ZH")

wet<-c("mc", "mcp", "mh", "mk", "mkp", "mks", "mm", "mmp", "mmw", "ms", "mv", "mvp", "mw", "mwp", "mww", "vc", "vcp", "vcw", "vh", "vk", "vks", "vm", "wc", "wcp", "wcw", "wh", "whp", "wk", "wm", "wmp", "wmu", "ws", "wv", "wvp", "ww")
```


Now I can hopefully follow the rules outlined at the end of Perrakis et al (2018)
First Ill code the non-vegetated areas
```{r}
fire_all$FWI_veg<-NA

fire_all1<- fire_all %>%
  mutate(FWI_veg=case_when(bclcs_level_1=="N" & yearsSinceHarvest %in% 6:24 ~ "O-1a/b",
                            bclcs_level_1=="N" & yearsSinceHarvest >=25  & bec_zone_code %in% c("CWH", "IDF","CDF", "ICH") ~ "C-5", TRUE ~ as.character(FWI_veg)))

table(fire_all1$FWI_veg)

# not vegetated and logged
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="N" & yearsSinceHarvest <= 6 & coast_interior_cd=="C" ~ "S-3",
          bclcs_level_1=="N" & yearsSinceHarvest <= 6 & coast_interior_cd =="I" ~ "S-1",
          bclcs_level_1=="N" & yearsSinceHarvest %in% 6:24 & bec_zone_code %in% c("CWH","MH","ICH") ~ "D-1/2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="BAFA" ~ "D-1/2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="CWH" & bec_subzone %in% c("ds","xm") ~ "M-1/2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="BWBS" ~ "C-2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="SWB" ~ "M-1/2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="SBS" ~ "C-3",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="SBPS" ~ "C-7",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="MS" ~ "C-7",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="IDF" & bec_subzone %in% c("mw","ww") ~ "C-3",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code %in% c("PP","BG") ~ "O-1a/b",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="MH" ~ "D-1/2",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="ESSF" ~ "C-7",
          bclcs_level_1=="N" & yearsSinceHarvest >=25 & bec_zone_code=="ICH" & bec_subzone %in% c("dk","dm","dw","xw") ~ "C-3",
          
# not vegetated and not logged, Recently burned   

          bclcs_level_1=="N" & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance <=3 ~"N",
          bclcs_level_1=="N" & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 4:6 ~"D-1/2",
          bclcs_level_1=="N" & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 7:10 ~"O-1a/b",

# not logged and not recently burned
          bclcs_level_1=="N" & species_pct_1 > 0 & bec_zone_code %in% c("CWH", "MH", "ICH") ~ "D-1/2",
          bclcs_level_1=="N" & species_pct_1 > 0 & !bec_zone_code %in% c("CWH", "MH", "ICH") ~ "O-1a/b",
          bclcs_level_2=="W" ~ "W",
          bclcs_level_1=="N" ~ "N", # for all other "N"'s

TRUE ~ as.character(FWI_veg)))

# note the NA values in the fire_all table were causing ifelse statements to do weird things. This seems better. Hopefully its correct.

table(fire_all1$FWI_veg)


```


Now coding the VEGETATED areas

```{r}
# recently burned
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 == "TC" & crown_closure > 40 & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 0:3 ~ "N",
          bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 == "TC" & crown_closure > 40 & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 4:6 ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 == "TC" & crown_closure > 40 & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 7:10 ~ "C-5",
           bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 == "TC" & crown_closure <= 40 & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance <1 ~ "N",
           bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 == "TC" & crown_closure <= 40 & earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in% 2:6 ~ "D-1/2",
           bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 != "TC" &  earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance < 2 ~ "N",
          bclcs_level_1=="V" & bclcs_level_2=="T" & bclcs_level_4 != "TC" &  earliest_nonlogging_dist_type_2=="burn" & yearsSinceDisturbance %in%2:10 ~ "D-1/2",
          TRUE ~ as.character(FWI_veg)))
table(fire_all1$FWI_veg)

#Pure lodgepole or jack or undefined pine species
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & yearsSinceHarvest<=7 ~ "S-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 &  bclcs_level_5=="SP" & bec_zone_code %in% c("CWH", "CDF", "MH", "ICH") & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5=="SP" & !bec_zone_code %in% c("CWH", "CDF", "MH", "ICH") & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 &  bclcs_level_5!="SP" & proj_height_1<=4 &species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5!="SP" & proj_height_1 %in% 4:12 & (vri_live_stems_per_ha+vri_dead_stems_per_ha) > 8000 &species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-4",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5!="SP" & proj_height_1 %in% 4:12 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5!="SP" & proj_height_1 >12 & crown_closure <40 & bec_zone_code %in% c("BG", "PP", "IDF", "MS") & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5!="SP" & proj_height_1 >12 & crown_closure <40 & bec_zone_code %in% c("CWH", "MH", "ICH") & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-5",
           bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_5!="SP" & proj_height_1 >12 & crown_closure <40 &species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & earliest_nonlogging_dist_type_2=="insect" & yearsSinceDisturbance <=5 & stand_percentage_dead >50 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "M-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & earliest_nonlogging_dist_type_2=="insect" & yearsSinceDisturbance <=5 & stand_percentage_dead %in% 25:50 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & earliest_nonlogging_dist_type_2=="insect" & yearsSinceDisturbance <=5 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & earliest_nonlogging_dist_type_2=="insect" & yearsSinceDisturbance > 5 & stand_percentage_dead > 50 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & bclcs_level_4=="TC" & bclcs_level_5=="DE" & earliest_nonlogging_dist_type_2=="insect" & yearsSinceDisturbance > 5 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-3",
          TRUE ~ as.character(FWI_veg)))
          
table(fire_all1$FWI_veg)

# Pure ponderosa pine
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & yearsSinceHarvest<=10 ~ "S-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & proj_height_1 < 4~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & proj_height_1 %in% 4:12 & (vri_live_stems_per_ha+vri_dead_stems_per_ha)>8000 ~ "C-4",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & proj_height_1 %in% 4:12 & (vri_live_stems_per_ha+vri_dead_stems_per_ha) %in% 3000:8000 ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & proj_height_1 %in% 4:12 ~ "C-7",
           bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 =="DE" & proj_height_1 %in% 12:17 ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 =="OP" & proj_height_1 %in% 12:17 ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 %in% c("DE","OP") & proj_height_1 >17 ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 =="SP" & stand_percentage_dead >=40 ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 =="SP" & stand_percentage_dead <40 & yearsSinceHarvest<=10 ~ "S-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "PY" & bclcs_level_5 =="SP" & stand_percentage_dead <40 ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("PA", "PF", "PW") & bclcs_level_5 =="DE"  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("PA", "PF", "PW") & bclcs_level_5 %in% c("SP","OP") & (vri_live_stems_per_ha+vri_dead_stems_per_ha)>=900  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("PA", "PF", "PW") & bclcs_level_5 %in% c("SP","OP") & (vri_live_stems_per_ha+vri_dead_stems_per_ha) %in% 600:900  ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("PA", "PF", "PW") & bclcs_level_5 %in% c("SP","OP")  ~ "C-5",
        
          TRUE ~ as.character(FWI_veg)))

table(fire_all1$FWI_veg)

### pure douglas fir
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F")  & yearsSinceHarvest<=6 & bec_zone_code %in% c("CWH", "MH", "CDF") ~ "S-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F")  & yearsSinceHarvest<=6 & !bec_zone_code %in% c("CWH", "MH", "CDF") ~ "S-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F")  & yearsSinceHarvest<=6 & bec_zone_code =="ICH" & bec_subzone %in% wet ~ "S-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F")  & yearsSinceHarvest<=6 & bec_zone_code =="ICH" & !bec_subzone %in% wet ~ "S-1",
           bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code %in% c("CWH", "MH", "CDF") & proj_height_1 < 4 ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code =="ICH" & bec_subzone %in% wet & proj_height_1 < 4 ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & proj_height_1 < 4 ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code %in% c("CWH", "MH", "CDF") & proj_height_1 %in% 4:12 & crown_closure > 55 ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code =="ICH" & bec_subzone %in% wet & proj_height_1 %in% 4:12 & crown_closure > 55 ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & proj_height_1 %in% 4:12 & crown_closure > 55 & stand_percentage_dead > 34 ~ "C-4",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & proj_height_1 %in% 4:12 & crown_closure > 55 ~ "C-3",
          
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code %in% c("CWH", "MH", "CDF") & crown_closure<26  ~ "D-1/2", 
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code =="ICH" & bec_subzone %in% wet & crown_closure<26 ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & crown_closure<26 ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code %in% c("CWH", "MH", "CDF")  ~ "C-5", # these
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") & bec_zone_code =="ICH" & bec_subzone %in% wet ~ "C-5",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("FD", "F") ~ "C-7",
        
          TRUE ~ as.character(FWI_veg)))

table(fire_all1$FWI_veg)
# Pure Spruce

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SE"  & yearsSinceHarvest<=10  ~ "S-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SE" & bclcs_level_5=="SP"  ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SE" & bclcs_level_5=="DE"  ~ "C-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SE" & bclcs_level_5=="OP"  ~ "C-3",
          
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SS"  & yearsSinceHarvest<=6  ~ "S-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SS" & bclcs_level_5=="SP"  ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "SS" & bclcs_level_5 %in% c("DE","OP")  ~ "C-5",
          
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("SB", "SW")  & yearsSinceHarvest<=10  ~ "S-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1  %in% c("SB", "SW") & bclcs_level_5 %in% c("DE","OP")  ~ "C-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("SB", "SW") & bclcs_level_5=="SP" & bec_zone_code %in% c("BWBS", "SWB")  ~ "C-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("SB", "SW") & bclcs_level_5=="SP"  ~ "M-1/2",
          
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  & yearsSinceHarvest<=7  ~ "S-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  bec_zone_code %in% c("BWBS", "SWB") & bclcs_level_5 %in% c("DE", "OP")  ~ "C-2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  bec_zone_code %in% c("BWBS", "SWB")  ~ "C-1",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  !bec_zone_code %in% c("BWBS", "SWB") & bclcs_level_5 =="SP"  ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  bec_zone_code %in% c("CWH", "CDF") & bclcs_level_5 %in% c("DE", "OP")  ~ "C-5",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  !bec_zone_code %in% c("BWBS", "SWB") & bclcs_level_5 %in% c("DE", "OP") & proj_height_1 < 4  ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  !bec_zone_code %in% c("BWBS", "SWB") & bclcs_level_5 == "OP"  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("S", "SX")  &  !bec_zone_code %in% c("BWBS", "SWB") & bclcs_level_5 == "DE"  ~ "C-2",
        
          TRUE ~ as.character(FWI_veg)))
table(fire_all1$FWI_veg)

# Pure hemlock, redcedar or yellow cedar

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & yearsSinceHarvest<=6  ~ "S-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="DE" & proj_height_1<4  ~ "D-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="DE" & proj_height_1 %in% 4:15  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="DE" & proj_age_1<60  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="DE" & proj_age_1 %in% 60:99  ~ "M-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="DE"  ~ "C-5",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  & bclcs_level_5=="OP"  ~ "C-5",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("H","HM", "HW", "C","CW", "Y", "YC")  ~ "D-1/2",
        
          TRUE ~ as.character(FWI_veg)))

# True fir
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "BG"  ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "BA"  ~ "M-1/2",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("B", "BB", "BL")  & bclcs_level_5=="SP"  ~ "C-7",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("B", "BB", "BL")  ~ "C-3",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "T"  ~ "C-5",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 == "J"  ~ "O-1a/b",
          bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1>=80 & species_cd_1 %in% c("L","D", "DR", "A", "AC", "ACB", "ACT", "AT", "AX", "RA", "E", "EA", "EP", "EW", "VB", "M", "MB", "MV", "Q", "W", "WB","WS", "XH")  ~ "D-1/2",
           TRUE ~ as.character(FWI_veg)))


######################
# Mixed species stand
######################
# calculating total percent cover by conifers regardless of species. Also pulling out the name of the most dominant conifer. 

fire_all1<- fire_all1 %>%
  mutate(pct1 = ifelse(species_cd_1 %in% conifer, species_pct_1, NA),
         pct2 = ifelse(species_cd_2 %in% conifer, species_pct_2, NA),
         pct3 = ifelse(species_cd_3 %in% conifer, species_pct_3, NA),
         pct4 = ifelse(species_cd_4 %in% conifer, species_pct_4, NA),
         pct5 = ifelse(species_cd_5 %in% conifer, species_pct_5, NA),
         pct6 = ifelse(species_cd_6 %in% conifer, species_pct_6, NA),
         dominant_conifer = ifelse(species_cd_1 %in% conifer, species_cd_1, 
                                   ifelse(species_cd_2 %in% conifer, species_cd_2,
                                          ifelse(species_cd_3 %in% conifer, species_cd_3,
                                                 ifelse(species_cd_4 %in% conifer, species_cd_4,
                                                        ifelse(species_cd_5 %in% conifer, species_cd_5,
                                                               ifelse(species_cd_6 %in% conifer, species_cd_6, NA)))))))

fire_all1<-fire_all1 %>% mutate(conifer_pct_cover_total=rowSums(across(c(pct1:pct6)), na.rm=TRUE))

# the above calculation puts zeros in rows with NA's so Im changing them back to NA
fire_all1$conifer_pct_cover_total<- ifelse(is.na(fire_all1$pct1) & is.na(fire_all1$pct2) & is.na(fire_all1$pct3) & is.na(fire_all1$pct4) & is.na(fire_all1$pct5) & is.na(fire_all1$pct6), NA, fire_all1$conifer_pct_cover_total)


## % Conifer 0 - 65 

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total<=20 ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & yearsSinceHarvest<=6 & conifer_pct_cover_total %in% 21:80 ~ "S-1",
            
# note for below I made the assumption that  on pg 39 of Perrakis et al. (2018) there were refering to the dominant conifer species  when they listed specific species. That is why only the first occurrence of a conifer gets the specific species  

## conifer cover 41 - 65%
bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & dominant_conifer %in% c("T","TW") & conifer_pct_cover_total %in% 41:65 ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 41:65 & dominant_conifer %in% c("J","JR","JS")  ~ "O-1a/b",

TRUE ~ as.character(FWI_veg)))


## conifer cover 65-80% 
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80 & dominant_conifer =="PY" ~ "C-7",
            
bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("PA", "PF", "PW")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & bec_zone_code %in% c("CWH", "CDF") & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("F","FD","FDC")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("F","FD","FDC")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & bclcs_level_5!="DE" & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("F","FD","FDC") ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("SS")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & !bec_zone_code %in% c("BWBS", "SWB") & coast_interior_cd =="C" & bclcs_level_5 !="SP" & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("S", "SX")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("C","CW","Y","YC","H","HM","HW","HXM","T","TW")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80 & dominant_conifer %in% c("B","BA","BG","BL","J","JR","JS")  ~ "C-7",
            
bclcs_level_1=="V" & bclcs_level_2=="T" & species_pct_1<80 & conifer_pct_cover_total %in% 65:80  ~ "M-1/2",
TRUE ~ as.character(FWI_veg)))


## conifer cover 81-100 %            
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & yearsSinceHarvest<=7 ~ "S-1",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & bclcs_level_5 == "SP" & bec_zone_code %in% c("CWH", "CDF", "MH") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & bclcs_level_5 == "SP" & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & bclcs_level_5 == "SP" & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & bclcs_level_5 != "SP" & proj_height_1<4 ~ "O-1a/b", 

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5 != "SP" & proj_height_1 %in% 4:12 & (vri_live_stems_per_ha+vri_dead_stems_per_ha)>8000  ~ "C-4",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5 != "SP" & proj_height_1 %in% 4:12  ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5 != "SP" & proj_height_1 > 12 & crown_closure<40 & bec_zone_code %in% c("BG", "PP", "IDF", "MS")   ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5 != "SP" & proj_height_1 > 12 & crown_closure<40 & bec_zone_code %in% c("CWH", "MH", "ICH")   ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5 != "SP" & proj_height_1 > 12 & crown_closure<40 & !bec_zone_code %in% c("BG", "PP", "IDF", "MS", "CWH", "MH", "ICH")   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance<=5 &  stand_percentage_dead > 50 ~ "M-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance<=5 &  stand_percentage_dead %in% 25:50 ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & bclcs_level_5=="DE" & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance<=5 &  stand_percentage_dead < 25 ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance<=5 &  stand_percentage_dead < 25 ~ "C-3",

# years since IBM attack > 5
bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance > 5 &  stand_percentage_dead >50 ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance > 5 &  stand_percentage_dead %in% 25:50  & bclcs_level_5 == "DE" ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & earliest_nonlogging_dist_type=="IBM" & yearsSinceDisturbance > 5   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & !species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & crown_closure <40 & bec_zone_code %in% c("IDF", "PP", "BG", "SBPW", "MS")   ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & !species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12 & crown_closure <40 & bec_zone_code %in% c("CWH", "CDF", "ICH")   ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PL", "PLI", "PLC", "PJ", "P") & !species_cd_2 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS")  & proj_height_1 > 12   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PY") & yearsSinceHarvest<=7   ~ "S-1",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PY") & proj_height_1 < 4   ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PY") & bclcs_level_5=="DE"   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PY")   ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PA", "PF", "PW") & bclcs_level_5=="DE"   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PA", "PF", "PW") & (vri_live_stems_per_ha+vri_dead_stems_per_ha)>=900   ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PA", "PF", "PW") & (vri_live_stems_per_ha+vri_dead_stems_per_ha) %in% 600:900   ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total %in% 81:100 & species_cd_1 %in% c("PA", "PF", "PW")   ~ "C-5",
TRUE ~ as.character(FWI_veg)))

####################
#sp. 1 Fd or any F
####################

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total >20 & species_cd_1 %in% c("F","FD","FDC","FDI") & yearsSinceHarvest<=6 & bec_zone_code %in% c("CWH", "MH","CDF") ~ "S-3",
              
bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & yearsSinceHarvest<=6 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "S-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & yearsSinceHarvest<=6 ~ "S-1",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 < 4 & bec_zone_code %in% c("CWH", "MH", "CDF") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 < 4 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 < 4 ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 %in% 4:12 & crown_closure>55 & bec_zone_code %in% c("CWH", "MH", "CDF") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 %in% 4:12 & crown_closure>55 &bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 %in% 4:12 & crown_closure>55 & stand_percentage_dead >34 ~ "C-4",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & species_cd_2=="PY" & proj_height_1 %in% 4:12 & crown_closure>55 ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI") & proj_height_1 %in% 4:12 & crown_closure>55 ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & proj_height_1 >12 & crown_closure>55 & bec_zone_code %in% c("CWH", "MH", "CDF") ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & proj_height_1 >12 & crown_closure>55 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & proj_height_1 >12 & crown_closure>55  ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure %in% 26:55 & bec_zone_code %in% c("CWH", "MH", "CDF")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure %in% 26:55 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure %in% 26:55  ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure < 26 & bec_zone_code %in% c("CWH", "MH", "CDF") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure < 26 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("F","FD","FDC","FDI")  & crown_closure < 26 ~ "O-1a/b",

TRUE ~ as.character(FWI_veg)))

#### Sp1 S(any)
 
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & yearsSinceHarvest<=6 & bec_zone_code %in% c("CWH", "MH","CDF") ~ "S-3",
                             
bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & yearsSinceHarvest<=6 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "S-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("S","SB","SE","SS","SW","SX","SXW","SXL","SXS") & yearsSinceHarvest<=6 ~ "S-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") & bclcs_level_5=="SP" ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") & species_cd_2 %in% c("BL", "B", "PL", "P", "PLI") & bclcs_level_5=="DE" ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") & species_cd_2 %in% c("BL", "B", "PL", "P", "PLI") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") & species_cd_2 %in% c("HW", "HM", "CW", "YC") & bclcs_level_5=="DE" ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") & species_cd_2 %in% c("HW", "HM", "CW", "YC") ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SE") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SS") ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SB") & bclcs_level_5 %in% c("DE","OP") ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SB") & bclcs_level_5 %in% c("SP") & bec_zone_code=="BWBS" ~ "C-1",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SB") & bclcs_level_5 %in% c("SP") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bclcs_level_5 %in% c("DE") & bec_zone_code=="BWBS"  ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bclcs_level_5 %in% c("OP") & bec_zone_code=="BWBS"  ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bec_zone_code=="BWBS"  ~ "C-1",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bec_zone_code %in% c("CWH","MH","CDF") & species_cd_2 %in% c("BL", "B", "P","PJ","PF","PL","PLI","PXJ","PY","PLC","PW","PA") & bclcs_level_5=="SP"  ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bec_zone_code %in% c("CWH","MH","CDF") & species_cd_2 %in% c("BL", "B", "P","PJ","PF","PL","PLI","PXJ","PY","PLC","PW","PA")  ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & bec_zone_code %in% c("CWH","MH","CDF")  ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & coast_interior_cd=="I" & bclcs_level_5=="SP"  ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & coast_interior_cd=="I" & bclcs_level_5=="DE"  ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & coast_interior_cd=="I" & stand_percentage_dead>34 ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & coast_interior_cd=="I" & species_cd_2 %in% c("PL","PLI","P") ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("SX", "SW", "S") & coast_interior_cd=="I" ~ "C-3",

TRUE ~ as.character(FWI_veg)))

### H(any), C(any), Y(any)

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & yearsSinceHarvest<=6 ~ "S-3",
                             
bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & bclcs_level_5=="DE" & proj_height_1<4 ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & bclcs_level_5=="DE" & proj_height_1 %in% 4:15 ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & bclcs_level_5=="DE" & proj_age_1<60 ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & bclcs_level_5=="DE" & proj_age_1 %in% 60:90 ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") & bclcs_level_5=="SP" ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("C","CW","Y","YC","H","HM","HW","HXM") ~ "C-5",

TRUE ~ as.character(FWI_veg)))

### BG or BA

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("BG") ~ "C-7",
                             
bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("BA") & species_cd_2 %in% c("SE", "SW", "S") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("BA") ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("B","BL") & coast_interior_cd=="C" ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("B","BL") & bclcs_level_5=="SP" ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("B","BL") & bclcs_level_5=="DE" & species_cd_2 %in% c("SE", "SW", "S") ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("B","BL") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("T","TW") ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="T" &  species_pct_1<80 & conifer_pct_cover_total > 20 & species_cd_1 %in% c("J","JR","JS") ~ "C-7",

TRUE ~ as.character(FWI_veg)))

### non-forested bclcs_level_2==N recently burned

fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="N" & earliest_nonlogging_dist_type_2 == "burn" & yearsSinceDisturbance < 2 ~ "N",
                             
bclcs_level_1=="V" & bclcs_level_2=="N" & earliest_nonlogging_dist_type_2 == "burn" & yearsSinceDisturbance %in% 2:3 ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & earliest_nonlogging_dist_type_2 == "burn" & yearsSinceDisturbance %in% 4:10 ~ "O-1a/b",

TRUE ~ as.character(FWI_veg)))

### logged
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest<=7 & species_cd_1 %in% c("P","PJ","PF","PL","PLI","PXJ","PY","PLC","PW","PA") ~ "S-1",
                             
bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest<=7 & species_cd_1 %in% c("B","BA","BG","BL","S","SB","SE","SS","SW","SX","SXW","SXL","SXS") ~ "S-2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest<=7 & species_cd_1 %in% c("CW","YC","H","HM","HW","HXM") ~ "S-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest<=7 & species_cd_1 %in% c("FD") & bec_zone_code %in% c("CWH", "ICH") ~ "S-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest<=7 ~ "S-1",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest %in% 8:24 & bec_zone_code %in% ("CWH", "MH") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest %in% 8:24 & bec_zone_code %in% ("ICH") & bec_subzone %in% wet ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest %in% 8:24 ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("CMA", "IMA") ~ "N",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("BAFA") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("CWH") & bec_subzone %in% wet ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("CWH") ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("BWBS") ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("SWB") ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("SBS") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("SBPS") ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("MS", "ESSF") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("IDF") & bec_subzone %in% wet ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("PP", "BG") ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("MH") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("CDF", "ICH") & bec_subzone %in% wet ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("IDF", "CDF") ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="N" & yearsSinceHarvest >25 & bec_zone_code %in% c("ICH") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest <=5 ~ "S-1",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest %in% 6:24 & bec_zone_code %in% c("CWH", "MH", "ICH") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest %in% 6:24 ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("CMA", "IMA") ~ "N",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("BAFA") ~ "D-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("ICH") & bec_subzone %in% wet ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("ICH", "SWB") ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("BWBS") ~ "C-2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("SBS") ~ "C-3",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("IDF") & bec_subzone %in% wet ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("CDF", "ICH") & bec_subzone %in% wet ~ "C-5",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("ICH") ~ "M-1/2",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("SBPS", "MS", "IDF", "ESSF", "CDF") ~ "C-7",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("PP", "BG") ~ "O-1a/b",

bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(species_cd_1) & yearsSinceHarvest >= 25 & bec_zone_code %in% c("MH") ~ "D-1/2",

TRUE ~ as.character(FWI_veg)))


#### Unlogged
fire_all1<- fire_all1 %>%
  mutate(FWI_veg = case_when(bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(harvest_date) & !is.na(species_cd_1) & bec_zone_code %in% c("CMA", "IMA")  ~ "N",
                             bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(harvest_date) & !is.na(species_cd_1) & bec_zone_code %in% c("CWH", "MH", "ICH", "BAFA")  ~ "D-1/2",
                             bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(harvest_date) & !is.na(species_cd_1)  ~ "O-1a/b",
                             bclcs_level_1=="V" & bclcs_level_2=="N" & is.na(harvest_date) & is.na(species_cd_1)  ~ "O-1a/b",









                            
conifer<-c("C","CW","Y","YC","F","FD","FDC","FDI","B","BA","BG","BL","H","HM","HW","HXM","J","JR","JS", "P","PJ","PF","PL","PLI","PXJ","PY","PLC","PW","PA","S","SB","SE","SS","SW","SX","SXW","SXL","SXS","T","TW", "XC", "ZC")

deciduous<-c("L", "LA", "LT", "LW", "D", "DR", "U", "UP", "A", "AC", "ACB", "ACT", "AX", "AT", "R", "RA", "E", "EA", "EXP", "EP", "EW", "K", "KC", "V", "VB", "VV", "VP", "G", "M", "MB", "MV", "Q", "QG", "W", "WB", "WP", "WA", "WD", "WS", "WT", "XH", "ZH")

```
