---
title: "Chilcotin Moose Density Analysis"
author: "Tyler Muhly"
date: "25/07/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
Here I analyze the statistical relationship between landscape and forest attributes and moose density in wildlife management units (WMUs) in the Chilcotin region of British Columbia.  The purpose of this analysis is to identify forest and forestry-related features that may influence the density of moose in WMUs. If a useful statistical model (i.e., an ecologically sensible model with a good fit) can be identified, the intent is to use the model as module in a simulation model (i.e., the cariobu land use simualor - CLUS) to model how alternative caribou recovery management regimes influence moose density. Moose density is critical to caribou management, as moose are an apparent competitor of caribou, i.e., they share wolves as a predator and higher moose densities support higher wolf densities, increasing predation on caribou. 

Need some background lit on moose ecology, e.g., use wet areas, snow and temp limits, shrubs, fire, cutblocks

## Methods
The analysis includes data from WMU's 5-01, 5-02A, 5-02B, 5-02C. 5-02D, 5-03, 5-04, 5-06, 5-10, 5-12B, 5-13A, 5-13B, 5-13C, 5-14, 5-15A, 5-15B, 5-15C and 5-15D (Table 1). Here sightability-adjusted densities of moose were esitmated between 1994 and 2019 using aerial survey detection methods (cite ref). Each WMU had a unique survey history, for example, 5-04 was surveyed the most frequently, including in 1994, 1995, 1998, 2005, 2012 and 2017, whereas other units were surveyed once. Density estimates ranged from 0.10 moose/km^2^ (WMU 5-02A in 1996) to 1.42 moose/km^2^ (WMU 5-02B in 1994). 


```{r, wmu survey history, echo = F}
require (kableExtra)
require (data.table)
wmu.history <- data.table (
WMU = c ("5-01", "5-01", "5-01", "5-02A", "5-02A", "5-02A", "5-02A", "5-02B", "5-02B", "5-02B", "5-02B", "5-02B", "5-02C", "5-02C", "5-02C", "5-02C", "5-02C", "5-02D", "5-02D", "5-02D", "5-03", "5-03", "5-04", "5-04", "5-04", "5-04", "5-04", "5-04", "5-06", "5-10", "5-12B", "5-12B", "5-13A", "5-13A", "5-13A", "5-13A", "5-13B", "5-13B", "5-13C", "5-13C", "5-13C", "5-14", "5-14", "5-14", "5-14", "5-15A", "5-15B", "5-15C", "5-15D"),

Year = c ("2015", "2000", "1996", "2014", "2001", "1998", "1996", "2018", "2006", "2000", "1996", "1994", "2019", "2011", "2001", "1997", "1994", "2014", "1999", "1994", "2019", "1997", "2017", "2012", "2005", "1998", "1995", "1994", "1995", "1995", "2012", "2002", "2017", "2003", "1998", "1995", "2018", "1999", "2019", "2008", "1997", "2019", "2013", "2001", "1994", "2008", "2008", "2008", "2004"),
 
Density = c (0.36, 0.32, 0.44, 0.33, 0.22, 0.26, 0.10, 0.46, 0.39, 0.59, 0.73, 1.42, 0.37, 0.51, 0.62, 0.30, 0.56, 0.86, 0.67, 1.19, 0.23, 0.35, 0.22, 0.14, 0.29, 0.41, 0.39, 0.71, 0.18, 0.26, 0.23, 0.58, 0.17, 0.30, 0.44, 0.32, 0.37, 0.31, 0.27, 0.49, 0.40, 0.26, 0.25, 0.46, 0.33, 0.29, 0.17, 0.11, 0.13)                            
                             )
kable (wmu.history, 
       caption = "Table 1. Chilcotin Wildlife Management Unit (WMU) Estimated Moose Density") %>%
  kable_styling (position = "left")
```

### Statistical Model
I fit a generalized linear mixed effects (GLME) regression model (Zuur et al. 2009) to statistically identify relationships between landscape features within WMUs (see eblow) and density estimates. WMUs were modeled as a random effect (intercept) to account for multi-year estimaets within WMUs. 

- slope?

First, I tested whether habitat covariates were correlated using a Spearman correlation, where a correlation coefficient greater than 0.7 was used as criteria to consider the covariates as confounded, and one of the covariates was removed from analysis. In addition, I fit a generlaized linear model (GLM) to the data and estiametd variance infaltion factors (VIFs) for each covariate, where a VIF greater than 10 was considered confounded with other data and removed from the analysis. 



### Spatial Landscape Data and Sources
I fit models that included spatial data on moose habitat features measured within each WMU. WMU boundaries were obtained from the DataBC catalogue: [WMU boundaries](https://catalogue.data.gov.bc.ca/dataset/limited-entry-hunting-zone-boundaries-1-20-000). 

I measured minimum, maximum, mean, range, majority, minority and standard deviation values of habitat features estimated in each WMU from raster data using the zonal stistics table tool in ArcGIS 10.6.
Mean and majority values provide an indicator of 'typical' habitat conditions within the WMU. Minimum, maximum and minority values provide an indicator of 'extreme' habitat conditions, and range and standard deviation values provide an indicator of variabaility in habitat conditions within the WMU. These values were measured for [elevation](https://catalogue.data.gov.bc.ca/dataset/digital-elevation-model-for-british-columbia-cded-1-250-000) and climate variables estimated by [Wang et al. 2016](http://www.climatewna.com/ClimateBC_Map.aspx), including [mean annual temperature and annual precipitation as snow](http://raster.climatebc.ca/download/Normal_1981_2010MSY/Normal_1981_2010_annual.zip), and [winter precipitation as snow, summer precipitation, average summer temperature and average winter temperature](http://raster.climatebc.ca/download/Normal_1981_2010MSY/Normal_1981_2010_seasonal.zip). 

Data on polygonal spatial habitat datasets were combined with WMU boundary data usign the "Union" tool in ArcGIS 10.6. Unioned data were outputted and summarized in prorgam R (see below).

I estimated the total area of waterbodies in each WMU by calculating the area of [lakes](https://catalogue.data.gov.bc.ca/dataset/freshwater-atlas-lakes), [wetlands](https://catalogue.data.gov.bc.ca/dataset/freshwater-atlas-wetlands) and [watercourses](https://catalogue.data.gov.bc.ca/dataset/watercourses-trim-enhanced-base-map-ebm)). I estimated the total length of [roads](https://catalogue.data.gov.bc.ca/dataset/digital-road-atlas-dra-demographic-partially-attributed-roads) in each WMU, by type, including, paved, loose, rough and unknown surface roads. 

Fire and cutblock data included the year that the burn or forest harvest occurred, and thus I estimated the total area burnt or cut in 5 year periods, from 5 years to 40 years prior to the moose density estimate. Data on [historic](https://catalogue.data.gov.bc.ca/dataset/fire-perimeters-historical) and [2018](https://catalogue.data.gov.bc.ca/dataset/fire-locations-current) fire perimeters and [consolidated cutblock](https://catalogue.data.gov.bc.ca/dataset/harvested-areas-of-bc-consolidated-cutblocks-) polygons using data from the DataBC catalogue. 

I used the provincial [vegetation inventory](https://catalogue.data.gov.bc.ca/dataset/vri-forest-vegetation-composite-polygons-and-layer-1) dataset to estimate vegetation characteristics in each WMU. I estimated the area of shrub cover by multiplying estimated percent shrub cover in each polygon by the polygon area and summing those values across the WMU. I calculated the area of each bioegeclimatic (BEC) variant and landcover type, including: non-vegetated water, non-vegetated land, vegetated non-treed alpine tall shrub, vegetated non-treed alpine low shrub, vegetated non-treed upland tall shrub, vegetated non-treed upland low shrub, vegetated wetland upland tall shrub, vegetated wetland upland low shrub, vegetated treed wetland conifer, vegetated treed wetland deciduous, vegetated treed wetland mixed, vegetated treed upland conifer, vegetated treed upland deciduous and vegetated treed upland mixed. I estimated the area of leading tree species types in each WMU by calculating area of each species identified as the most common in each polygon. I calculated the minimum, maximum, mean, range, and standard deviation values of site index, projected age, and projected height of polygons in each WMU.

```{r, load and manipulate data top create data for analysis, echo = F, message = F error = F}
require (sf)
require (data.table)
require (dplyr)

data.moose.density <- data.table (read.csv ("C:\\Work\\caribou\\clus_data\\moose\\analysis_moose_chilcotin_density\\data_moose_chilcotin_density.csv", header = T, sep = ","))

data.moose.habitat <- data.table(sf::st_read (dsn = "C:\\Work\\caribou\\clus_data\\moose\\analysis_moose_chilcotin_density\\chilcotin_moose_habitat.gdb", layer = "wmu_moose_analysis_units_veg_cut_fire_wet_lake_water"))

data.moose.roads <- data.table (sf::st_read (dsn = "C:\\Work\\caribou\\clus_data\\moose\\analysis_moose_chilcotin_density\\chilcotin_moose_habitat.gdb", layer = "wmu_moose_analysis_units_roads"))


### AREA OF LANDCOVER BY WMU: 
data.moose.habitat.lc <- data.table (data.moose.habitat) [, .(wmu, BCLCS_LEVEL_1, BCLCS_LEVEL_2, BCLCS_LEVEL_3, BCLCS_LEVEL_4, BCLCS_LEVEL_5, area_ha)]

data.moose.habitat.lc <-  data.table (data.moose.habitat.lc) [wmu != "5-12-A"]

# area of non-vegetated, water
data.moose.habitat.lc.nw <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "N" & BCLCS_LEVEL_2 == "W",
                                                   .(N_W_area_ha = sum (area_ha)), 
                                                   by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.nw,
                                        by = "wmu")
rm (data.moose.habitat.lc.nw)
gc ()

# area of non-vegetated, land
data.moose.habitat.lc.nl <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "N" & BCLCS_LEVEL_2 == "L",
                                                   .(N_L_area_ha = sum (area_ha)), 
                                                   by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.nl,
                                        by = "wmu")
rm (data.moose.habitat.lc.nl)
gc ()

# area of vegetated, non-treed, alpine, tall shrub
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                   BCLCS_LEVEL_3 == "A" &  BCLCS_LEVEL_4 == "ST",
                                                   .(V_NT_A_ST_area_ha = sum (area_ha)), 
                                                   by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, non-treed, alpine, low shrub 
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                    BCLCS_LEVEL_3 == "A" &  BCLCS_LEVEL_4 == "SL",
                                                    .(V_NT_A_SL_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, non-treed, upland, tall shrub
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                    BCLCS_LEVEL_3 == "U" &  BCLCS_LEVEL_4 == "ST",
                                                    .(V_NT_U_ST_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, non-treed, upland, low shrub
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                    BCLCS_LEVEL_3 == "U" &  BCLCS_LEVEL_4 == "SL",
                                                    .(V_NT_U_SL_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, non-treed, wetland, tall shrub
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                    BCLCS_LEVEL_3 == "W" &  BCLCS_LEVEL_4 == "ST",
                                                    .(V_NT_W_ST_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, non-treed, wetland, low shrub
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "N" & 
                                                    BCLCS_LEVEL_3 == "W" &  BCLCS_LEVEL_4 == "SL",
                                                    .(V_NT_W_SL_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, treed, wetland, conifer
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "W" &  BCLCS_LEVEL_4 == "TC",
                                                    .(V_T_W_TC_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, treed, wetland, deciduous
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "W" &  BCLCS_LEVEL_4 == "TB",
                                                    .(V_T_W_TB_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, treed, wetland, mixed stand
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "W" &  BCLCS_LEVEL_4 == "TM",
                                                    .(V_T_W_TM_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, treed, upland, conifer
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "U" &  BCLCS_LEVEL_4 == "TC",
                                                    .(V_T_U_TC_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated, treed, upland, deciduous
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "U" &  BCLCS_LEVEL_4 == "TB",
                                                    .(V_T_U_TB_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub)
gc ()

# area of vegetated treed upland mixed
data.moose.habitat.lc.sub <- data.moose.habitat.lc [BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" & 
                                                    BCLCS_LEVEL_3 == "U" &  BCLCS_LEVEL_4 == "TM",
                                                    .(V_T_U_TM_area_ha = sum (area_ha)), 
                                                    by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lc.sub,
                                        by = "wmu")
rm (data.moose.habitat.lc.sub, data.moose.habitat.lc)
gc ()



### AREA of BEC:
data.moose.habitat.bec <- data.table (data.moose.habitat) [, .(wmu, BEC_ZONE_CODE, BEC_SUBZONE, BEC_VARIANT, area_ha)]
data.moose.habitat.bec [, bec_class := paste0 (BEC_ZONE_CODE, BEC_SUBZONE, BEC_VARIANT)]
unique (data.moose.habitat.bec$bec_class)

# Alpine
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "BAFAunNA" | bec_class == "BAFAunpNA" | bec_class == "CMAunNA" | bec_class == "CMAunpNA" | bec_class == "IMAunpNA" | bec_class == "IMAunNA",
                                                      .(Alpine_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# BG
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "BGxh3" | bec_class == "BGxw2",
                                                      .(BG_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# CWH
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "CWHws2" | bec_class == "CWHms1" | bec_class == "CWHds2",
                                                      .(CWH_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ICHdry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ICHdkNA" | bec_class == "ICHdw3",
                                                      .(ICHdry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ICHmoist
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ICHmk3" | bec_class == "ICHmw3",
                                                      .(ICHmoist_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ICHwetcool
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ICHwk2" | bec_class == "ICHwk4" | bec_class == "ICHwk1",
                                                      .(ICHwetcool_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# IDFdry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "IDFdk4" | bec_class == "IDFdwNA" | bec_class == "IDFdk3",
                                                      .(IDFdry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# IDFverydry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "IDFxmNA" | bec_class == "IDFxwNA",
                                                      .(IDFverydry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# IDFmoistwet
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "IDFwwNA" | bec_class == "IDFmw2",
                                                      .(IDFmoistwet_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# MHmm2
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "MHmm2",
                                                      .(MHmm2_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# MSverydry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "MSxvNA" | bec_class == "MSxk3",
                                                      .(MSverydry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# MSdry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "MSdvNA" | bec_class == "MSdc2",
                                                      .(MSdry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBSdry
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBSdw2" | bec_class == "SBSdw1" | bec_class == "SBSdkNA",
                                                      .(SBSdry_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBSmoistcold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBSmc1" | bec_class == "SBSmc2" | bec_class == "SBSmc3",
                                                      .(SBSmoistcold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBSmoistmildhot
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBSmmNA" | bec_class == "SBSmwNA" | bec_class == "SBSmhNA",
                                                      .(SBSmoistmildhot_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBSwk1
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBSwk1",
                                                      .(SBSwk1_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBPSdryverydrycold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBPSdcNA" | bec_class == "SBPSxcNA",
                                                      .(SBPSdryverydrycold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# SBPSmoistcoolcold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "SBPSmkNA" | bec_class == "SBPSmcNA",
                                                      .(SBPSmoistcoolcold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFmoistmildwarm
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFmwNA" | bec_class == "ESSFmwpNA" | bec_class == "ESSFmmpNA" | bec_class == "ESSFmm1",
                                                      .(ESSFmoistmildwarm_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFmoistcoldverycold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFmv1" | bec_class == "ESSFmvpNA" | bec_class == "ESSFmcNA" | bec_class == "ESSFmcpNA",
                                                      .(ESSFmoistcoldverycold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFverydryverycold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFxv2" | bec_class == "ESSFxvpNA" | bec_class == "ESSFxv1" | bec_class == "ESSFxvwNA",
                                                      .(ESSFverydryverycold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFverydrycold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFxcpNA" | bec_class == "ESSFxcwNA" | bec_class == "ESSFxc3",
                                                      .(ESSFverydrycold_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFdrycoldverycold
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFdvwNA" | bec_class == "ESSFdvpNA" | bec_class == "ESSFdc3",
                                                      .(ESSFdvw_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub)
gc ()

# ESSFwetcoldcool
data.moose.habitat.bec.sub <- data.moose.habitat.bec [bec_class == "ESSFwk1" | bec_class == "ESSFwc3" | bec_class == "ESSFwcwNA" | bec_class == "ESSFwcpNA",
                                                      .(ESSFwk1_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.bec.sub,
                                        by = "wmu")
rm (data.moose.habitat.bec.sub, data.moose.habitat.bec)
gc ()


### Shrub cover by WMU
data.moose.habitat.shrub <- na.omit (data.moose.habitat, 
                                     cols = ("SHRUB_CROWN_CLOSURE"), 
                                     invert = FALSE)
data.moose.habitat.shrub <- data.moose.habitat.shrub [, .(shrub_area_ha = sum (area_ha *     
                                                                              SHRUB_CROWN_CLOSURE)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.shrub,
                                        by = "wmu")
rm (data.moose.habitat.shrub)
gc ()


### Site index by WMU
data.moose.habitat.site.index <- na.omit (data.moose.habitat, 
                                           cols = ("SITE_INDEX"), 
                                           invert = FALSE)

data.moose.habitat.site.index.min <- data.moose.habitat.site.index [, .(site_index_min = min (SITE_INDEX)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.site.index.min,
                                        by = "wmu")
rm (data.moose.habitat.site.index.min)
gc ()

data.moose.habitat.site.index.max <- data.moose.habitat.site.index [, .(site_index_max = max (SITE_INDEX)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.site.index.max,
                                        by = "wmu")
rm (data.moose.habitat.site.index.max)
gc ()

data.moose.habitat.site.index.mean <- data.moose.habitat.site.index [, .(site_index_mean = mean (SITE_INDEX)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.site.index.mean,
                                        by = "wmu")
rm (data.moose.habitat.site.index.mean)
gc ()

data.moose.density$site_index_range <-  data.moose.density$site_index_max - data.moose.density$site_index_min

data.moose.habitat.site.index.sd <- data.moose.habitat.site.index [, .(site_index_sd = sd (SITE_INDEX)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.site.index.sd,
                                        by = "wmu")
rm (data.moose.habitat.site.index.sd, data.moose.habitat.site.index)
gc ()

### Stand height by WMU
data.moose.habitat.height <- na.omit (data.moose.habitat, 
                                           cols = ("PROJ_HEIGHT_1"), 
                                           invert = FALSE)

data.moose.habitat.height.min <- data.moose.habitat.height [, .(height_min = min (PROJ_HEIGHT_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.height.min,
                                        by = "wmu")
rm (data.moose.habitat.height.min)
gc ()

data.moose.habitat.height.max <- data.moose.habitat.height [, .(height_max = max (PROJ_HEIGHT_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.height.max,
                                        by = "wmu")
rm (data.moose.habitat.height.max)
gc ()

data.moose.habitat.height.mean <- data.moose.habitat.height [, .(height_mean = mean (PROJ_HEIGHT_1)),                                                                by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.height.mean,
                                        by = "wmu")
rm (data.moose.habitat.height.mean)
gc ()

data.moose.density$height_range <-  data.moose.density$height_max - data.moose.density$height_min

data.moose.habitat.height.sd <- data.moose.habitat.height [, .(height_sd = sd (PROJ_HEIGHT_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.height.sd,
                                        by = "wmu")
rm (data.moose.habitat.height.sd, data.moose.habitat.height)
gc ()

### Stand age by WMU
data.moose.habitat.age <- na.omit (data.moose.habitat, 
                                           cols = ("PROJ_AGE_1"), 
                                           invert = FALSE)

data.moose.habitat.age.min <- data.moose.habitat.age [, .(age_min = min (PROJ_AGE_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.age.min,
                                        by = "wmu")
rm (data.moose.habitat.age.min)
gc ()

data.moose.habitat.age.max <- data.moose.habitat.age [, .(age_max = max (PROJ_AGE_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.age.max,
                                        by = "wmu")
rm (data.moose.habitat.age.max)
gc ()

data.moose.habitat.age.mean <- data.moose.habitat.age [, .(age_mean = mean (PROJ_AGE_1)),                                                                by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.age.mean,
                                        by = "wmu")
rm (data.moose.habitat.age.mean)
gc ()

data.moose.density$age_range <-  data.moose.density$age_max - data.moose.density$age_min

data.moose.habitat.age.sd <- data.moose.habitat.age [, .(age_sd = sd (PROJ_AGE_1)), 
                                                              by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.age.sd,
                                        by = "wmu")
rm (data.moose.habitat.age.sd, data.moose.habitat.age)
gc ()


### LEADING TREE SPECIES AREA
data.moose.habitat.tree.spp <- data.table (data.moose.habitat) [, .(wmu, SPECIES_CD_1, area_ha)]
unique (data.moose.habitat.tree.spp$SPECIES_CD_1)
# Fir
data.moose.habitat.tree.spp.fir <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "B" | SPECIES_CD_1 == "BL" | SPECIES_CD_1 == "BA",
                                                      .(Fir_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.fir,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.fir)
gc ()

# Cedar
data.moose.habitat.tree.spp.cedar <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "CW" | SPECIES_CD_1 == "YC",
                                                      .(Cedar_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.cedar,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.cedar)
gc ()

# Populus spp.
data.moose.habitat.tree.spp.poplar <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "AC" | SPECIES_CD_1 == "AT" | SPECIES_CD_1 == "ACT",
                                                      .(Populus_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.poplar,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.poplar)
gc ()

# Birch
data.moose.habitat.tree.spp.birch <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "E" | SPECIES_CD_1 == "EP",
                                                      .(Birch_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.birch,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.birch)
gc ()

# Douglas Fir
data.moose.habitat.tree.spp.dougfir <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "FD" | SPECIES_CD_1 == "FDI" | SPECIES_CD_1 == "FDC",
                                                      .(DougFir_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.dougfir,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.dougfir)
gc ()

# Hemlock
data.moose.habitat.tree.spp.hemlock <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "H" | SPECIES_CD_1 == "HW" | SPECIES_CD_1 == "HM",
                                                      .(Hemlock_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.hemlock,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.hemlock)
gc ()

# Larch
data.moose.habitat.tree.spp.larch <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "L" | SPECIES_CD_1 == "LT",
                                                      .(Larch_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.larch,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.larch)
gc ()

# Pine
data.moose.habitat.tree.spp.pine <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "PL" | SPECIES_CD_1 == "PLI" | SPECIES_CD_1 == "PA" | SPECIES_CD_1 == "PY" | SPECIES_CD_1 == "PLC",
                                                      .(Pine_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.pine,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.pine)
gc ()

# Spruce
data.moose.habitat.tree.spp.spruce <- data.moose.habitat.tree.spp [SPECIES_CD_1 == "SS" | SPECIES_CD_1 == "SX" | SPECIES_CD_1 == "SW" | SPECIES_CD_1 == "SB" | SPECIES_CD_1 == "SE" | SPECIES_CD_1 == "SXL",
                                                      .(Spruce_area_ha = sum (area_ha)), 
                                                      by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.tree.spp.spruce,
                                        by = "wmu")
rm (data.moose.habitat.tree.spp.spruce, data.moose.habitat.tree.spp)
gc ()



### Fire - burnt area, by year and WMU
# 2019
data.moose.habitat.fire <- data.table (data.moose.habitat) [, .(wmu, FIRE_YEAR, FIRE_YEAR_1, area_ha)]
sort (unique (data.moose.habitat.fire$FIRE_YEAR_1))

data.moose.habitat.fire.2019 <- data.moose.habitat.fire [FIRE_YEAR == 2019,
                                                         .(Fire_2019_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2019,
                                        by = "wmu")
rm (data.moose.habitat.fire.2019)
gc ()

# 2018
data.moose.habitat.fire.2018 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2018,
                                                         .(Fire_2018_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2018,
                                        by = "wmu")
rm (data.moose.habitat.fire.2018)
gc ()

# 2017
data.moose.habitat.fire.2017 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2017,
                                                         .(Fire_2017_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2017,
                                        by = "wmu")
rm (data.moose.habitat.fire.2017)
gc ()

# 2016
data.moose.habitat.fire.2016 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2016,
                                                         .(Fire_2016_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2016,
                                        by = "wmu")
rm (data.moose.habitat.fire.2016)
gc ()

# 2015
data.moose.habitat.fire.2015 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2015,
                                                         .(Fire_2015_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2015,
                                        by = "wmu")
rm (data.moose.habitat.fire.2015)
gc ()

# 2014
data.moose.habitat.fire.2014 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2014,
                                                         .(Fire_2014_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2014,
                                        by = "wmu")
rm (data.moose.habitat.fire.2014)
gc ()

# 2013
data.moose.habitat.fire.2013 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2013,
                                                         .(Fire_2013_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2013,
                                        by = "wmu")
rm (data.moose.habitat.fire.2013)
gc ()

# 2012
data.moose.habitat.fire.2012 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2012,
                                                         .(Fire_2012_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2012,
                                        by = "wmu")
rm (data.moose.habitat.fire.2012)
gc ()

# 2011
data.moose.habitat.fire.2011 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2011,
                                                         .(Fire_2011_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2011,
                                        by = "wmu")
rm (data.moose.habitat.fire.2011)
gc ()

# 2010
data.moose.habitat.fire.2010 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2010,
                                                         .(Fire_2010_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2010,
                                        by = "wmu")
rm (data.moose.habitat.fire.2010)
gc ()

# 2009
data.moose.habitat.fire.2009 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2009,
                                                         .(Fire_2009_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2009,
                                        by = "wmu")
rm (data.moose.habitat.fire.2009)
gc ()

# 2008
data.moose.habitat.fire.2008 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2008,
                                                         .(Fire_2008_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2008,
                                        by = "wmu")
rm (data.moose.habitat.fire.2008)
gc ()

# 2007
data.moose.habitat.fire.2007 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2007,
                                                         .(Fire_2007_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2007,
                                        by = "wmu")
rm (data.moose.habitat.fire.2007)
gc ()

# 2006
data.moose.habitat.fire.2006 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2006,
                                                         .(Fire_2006_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2006,
                                        by = "wmu")
rm (data.moose.habitat.fire.2006)
gc ()

# 2005
data.moose.habitat.fire.2005 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2005,
                                                         .(Fire_2005_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2005,
                                        by = "wmu")
rm (data.moose.habitat.fire.2005)
gc ()

# 2004
data.moose.habitat.fire.2004 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2004,
                                                         .(Fire_2004_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2004,
                                        by = "wmu")
rm (data.moose.habitat.fire.2004)
gc ()

# 2003
data.moose.habitat.fire.2003 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2003,
                                                         .(Fire_2003_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2003,
                                        by = "wmu")
rm (data.moose.habitat.fire.2003)
gc ()

# 2002
data.moose.habitat.fire.2002 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2002,
                                                         .(Fire_2002_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2002,
                                        by = "wmu")
rm (data.moose.habitat.fire.2002)
gc ()

# 2001
data.moose.habitat.fire.2001 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2001,
                                                         .(Fire_2001_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2001,
                                        by = "wmu")
rm (data.moose.habitat.fire.2001)
gc ()

# 2000
data.moose.habitat.fire.2000 <- data.moose.habitat.fire [FIRE_YEAR_1 == 2000,
                                                         .(Fire_2000_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.2000,
                                        by = "wmu")
rm (data.moose.habitat.fire.2000)
gc ()

# 1999
data.moose.habitat.fire.1999 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1999,
                                                         .(Fire_1999_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1999,
                                        by = "wmu")
rm (data.moose.habitat.fire.1999)
gc ()

# 1998
data.moose.habitat.fire.1998 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1998,
                                                         .(Fire_1998_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1998,
                                        by = "wmu")
rm (data.moose.habitat.fire.1998)
gc ()

# 1997
data.moose.habitat.fire.1997 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1997,
                                                         .(Fire_1997_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1997,
                                        by = "wmu")
rm (data.moose.habitat.fire.1997)
gc ()

# 1996
data.moose.habitat.fire.1996 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1996,
                                                         .(Fire_1996_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1996,
                                        by = "wmu")
rm (data.moose.habitat.fire.1996)
gc ()

# 1995
data.moose.habitat.fire.1995 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1995,
                                                         .(Fire_1995_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1995,
                                        by = "wmu")
rm (data.moose.habitat.fire.1995)
gc ()

# 1994
data.moose.habitat.fire.1994 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1994,
                                                         .(Fire_1994_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1994,
                                        by = "wmu")
rm (data.moose.habitat.fire.1994)
gc ()

# 1993
data.moose.habitat.fire.1993 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1993,
                                                         .(Fire_1993_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1993,
                                        by = "wmu")
rm (data.moose.habitat.fire.1993)
gc ()

# 1992
data.moose.habitat.fire.1992 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1992,
                                                         .(Fire_1992_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1992,
                                        by = "wmu")
rm (data.moose.habitat.fire.1992)
gc ()

# 1991
data.moose.habitat.fire.1991 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1991,
                                                         .(Fire_1991_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1991,
                                        by = "wmu")
rm (data.moose.habitat.fire.1991)
gc ()

# 1990
data.moose.habitat.fire.1990 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1990,
                                                         .(Fire_1990_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1990,
                                        by = "wmu")
rm (data.moose.habitat.fire.1990)
gc ()

# 1989
data.moose.habitat.fire.1989 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1989,
                                                         .(Fire_1989_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1989,
                                        by = "wmu")
rm (data.moose.habitat.fire.1989)
gc ()

# 1988
data.moose.habitat.fire.1988 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1988,
                                                         .(Fire_1988_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1988,
                                        by = "wmu")
rm (data.moose.habitat.fire.1988)
gc ()

# 1987
data.moose.habitat.fire.1987 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1987,
                                                         .(Fire_1987_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1987,
                                        by = "wmu")
rm (data.moose.habitat.fire.1987)
gc ()

# 1986
data.moose.habitat.fire.1986 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1986,
                                                         .(Fire_1986_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1986,
                                        by = "wmu")
rm (data.moose.habitat.fire.1986)
gc ()

# 1985
data.moose.habitat.fire.1985 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1985,
                                                         .(Fire_1985_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1985,
                                        by = "wmu")
rm (data.moose.habitat.fire.1985)
gc ()

# 1984
data.moose.habitat.fire.1984 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1984,
                                                         .(Fire_1984_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1984,
                                        by = "wmu")
rm (data.moose.habitat.fire.1984)
gc ()

# 1983
data.moose.habitat.fire.1983 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1983,
                                                         .(Fire_1983_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1983,
                                        by = "wmu")
rm (data.moose.habitat.fire.1983)
gc ()

# 1982
data.moose.habitat.fire.1982 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1982,
                                                         .(Fire_1982_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1982,
                                        by = "wmu")
rm (data.moose.habitat.fire.1982)
gc ()

# 1981
data.moose.habitat.fire.1981 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1981,
                                                         .(Fire_1981_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1981,
                                        by = "wmu")
rm (data.moose.habitat.fire.1981)
gc ()

# 1980
data.moose.habitat.fire.1980 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1980,
                                                         .(Fire_1980_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1980,
                                        by = "wmu")
rm (data.moose.habitat.fire.1980)
gc ()

# 1979
data.moose.habitat.fire.1979 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1979,
                                                         .(Fire_1979_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1979,
                                        by = "wmu")
rm (data.moose.habitat.fire.1979)
gc ()

# 1978
data.moose.habitat.fire.1978 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1978,
                                                         .(Fire_1978_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1978,
                                        by = "wmu")
rm (data.moose.habitat.fire.1978)
gc ()

# 1977
data.moose.habitat.fire.1977 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1977,
                                                         .(Fire_1977_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1977,
                                        by = "wmu")
rm (data.moose.habitat.fire.1977)
gc ()

# 1976
data.moose.habitat.fire.1976 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1976,
                                                         .(Fire_1976_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1976,
                                        by = "wmu")
rm (data.moose.habitat.fire.1976)
gc ()

# 1975
data.moose.habitat.fire.1975 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1975,
                                                         .(Fire_1975_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1975,
                                        by = "wmu")
rm (data.moose.habitat.fire.1975)
gc ()

# 1974
data.moose.habitat.fire.1974 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1974,
                                                         .(Fire_1974_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1974,
                                        by = "wmu")
rm (data.moose.habitat.fire.1974)
gc ()

# 1973
data.moose.habitat.fire.1973 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1973,
                                                         .(Fire_1973_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1973,
                                        by = "wmu")
rm (data.moose.habitat.fire.1973)
gc ()

# 1972
data.moose.habitat.fire.1972 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1972,
                                                         .(Fire_1972_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1972,
                                        by = "wmu")
rm (data.moose.habitat.fire.1972)
gc ()

# 1971
data.moose.habitat.fire.1971 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1971,
                                                         .(Fire_1971_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1971,
                                        by = "wmu")
rm (data.moose.habitat.fire.1971)
gc ()

# 1970
data.moose.habitat.fire.1970 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1970,
                                                         .(Fire_1970_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1970,
                                        by = "wmu")
rm (data.moose.habitat.fire.1970)
gc ()

# 1969
data.moose.habitat.fire.1969 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1969,
                                                         .(Fire_1969_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1969,
                                        by = "wmu")
rm (data.moose.habitat.fire.1969)
gc ()

# 1968
data.moose.habitat.fire.1968 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1968,
                                                         .(Fire_1968_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1968,
                                        by = "wmu")
rm (data.moose.habitat.fire.1968)
gc ()

# 1967
data.moose.habitat.fire.1967 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1967,
                                                         .(Fire_1967_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1967,
                                        by = "wmu")
rm (data.moose.habitat.fire.1967)
gc ()

# 1966
data.moose.habitat.fire.1966 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1966,
                                                         .(Fire_1966_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1966,
                                        by = "wmu")
rm (data.moose.habitat.fire.1966)
gc ()

# 1965
data.moose.habitat.fire.1965 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1965,
                                                         .(Fire_1965_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1965,
                                        by = "wmu")
rm (data.moose.habitat.fire.1965)
gc ()

# 1964
data.moose.habitat.fire.1964 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1964,
                                                         .(Fire_1964_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1964,
                                        by = "wmu")
rm (data.moose.habitat.fire.1964)
gc ()

# 1963
data.moose.habitat.fire.1963 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1963,
                                                         .(Fire_1963_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1963,
                                        by = "wmu")
rm (data.moose.habitat.fire.1963)
gc ()

# 1962
data.moose.habitat.fire.1962 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1962,
                                                         .(Fire_1962_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1962,
                                        by = "wmu")
rm (data.moose.habitat.fire.1962)
gc ()

# 1961
data.moose.habitat.fire.1961 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1961,
                                                         .(Fire_1961_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1961,
                                        by = "wmu")
rm (data.moose.habitat.fire.1961)
gc ()

# 1960
data.moose.habitat.fire.1960 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1960,
                                                         .(Fire_1960_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1960,
                                        by = "wmu")
rm (data.moose.habitat.fire.1960)
gc ()

# 1959
data.moose.habitat.fire.1959 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1959,
                                                         .(Fire_1959_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1959,
                                        by = "wmu")
rm (data.moose.habitat.fire.1959)
gc ()

# 1958
data.moose.habitat.fire.1958 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1958,
                                                         .(Fire_1958_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1958,
                                        by = "wmu")
rm (data.moose.habitat.fire.1958)
gc ()

# 1957
data.moose.habitat.fire.1957 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1957,
                                                         .(Fire_1957_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1957,
                                        by = "wmu")
rm (data.moose.habitat.fire.1957)
gc ()

# 1956
data.moose.habitat.fire.1956 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1956,
                                                         .(Fire_1956_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1956,
                                        by = "wmu")
rm (data.moose.habitat.fire.1956)
gc ()

# 1955
data.moose.habitat.fire.1955 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1955,
                                                         .(Fire_1955_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1955,
                                        by = "wmu")
rm (data.moose.habitat.fire.1955)
gc ()

# 1954
data.moose.habitat.fire.1954 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1954,
                                                         .(Fire_1954_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1954,
                                        by = "wmu")
rm (data.moose.habitat.fire.1954)
gc ()

# 1953
data.moose.habitat.fire.1953 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1953,
                                                         .(Fire_1953_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1953,
                                        by = "wmu")
rm (data.moose.habitat.fire.1953)
gc ()

# 1952
data.moose.habitat.fire.1952 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1952,
                                                         .(Fire_1952_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1952,
                                        by = "wmu")
rm (data.moose.habitat.fire.1952)
gc ()

# 1951
data.moose.habitat.fire.1951 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1951,
                                                         .(Fire_1951_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1951,
                                        by = "wmu")
rm (data.moose.habitat.fire.1951)
gc ()

# 1950
data.moose.habitat.fire.1950 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1950,
                                                         .(Fire_1950_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1950,
                                        by = "wmu")
rm (data.moose.habitat.fire.1950)
gc ()

# 1949
data.moose.habitat.fire.1949 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1949,
                                                         .(Fire_1949_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1949,
                                        by = "wmu")
rm (data.moose.habitat.fire.1949)
gc ()

# 1948
data.moose.habitat.fire.1948 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1948,
                                                         .(Fire_1948_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1948,
                                        by = "wmu")
rm (data.moose.habitat.fire.1948)
gc ()

# 1947
data.moose.habitat.fire.1947 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1947,
                                                         .(Fire_1947_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1947,
                                        by = "wmu")
rm (data.moose.habitat.fire.1947)
gc ()

# 1946
data.moose.habitat.fire.1946 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1946,
                                                         .(Fire_1946_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1946,
                                        by = "wmu")
rm (data.moose.habitat.fire.1946)
gc ()

# 1945
data.moose.habitat.fire.1945 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1945,
                                                         .(Fire_1945_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1945,
                                        by = "wmu")
rm (data.moose.habitat.fire.1945)
gc ()

# 1944
data.moose.habitat.fire.1944 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1944,
                                                         .(Fire_1944_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1944,
                                        by = "wmu")
rm (data.moose.habitat.fire.1944)
gc ()

# 1943
data.moose.habitat.fire.1943 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1943,
                                                         .(Fire_1943_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1943,
                                        by = "wmu")
rm (data.moose.habitat.fire.1943)
gc ()

# 1942
data.moose.habitat.fire.1942 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1942,
                                                         .(Fire_1942_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1942,
                                        by = "wmu")
rm (data.moose.habitat.fire.1942)
gc ()

# 1941
data.moose.habitat.fire.1941 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1941,
                                                         .(Fire_1941_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1941,
                                        by = "wmu")
rm (data.moose.habitat.fire.1941)
gc ()

# 1940
data.moose.habitat.fire.1940 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1940,
                                                         .(Fire_1940_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1940,
                                        by = "wmu")
rm (data.moose.habitat.fire.1940)
gc ()

# 1939
data.moose.habitat.fire.1939 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1939,
                                                         .(Fire_1939_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1939,
                                        by = "wmu")
rm (data.moose.habitat.fire.1939)
gc ()

# 1938
data.moose.habitat.fire.1938 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1938,
                                                         .(Fire_1938_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1938,
                                        by = "wmu")
rm (data.moose.habitat.fire.1938)
gc ()

# 1937
data.moose.habitat.fire.1937 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1937,
                                                         .(Fire_1937_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1937,
                                        by = "wmu")
rm (data.moose.habitat.fire.1937)
gc ()

# 1936
data.moose.habitat.fire.1936 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1936,
                                                         .(Fire_1936_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1936,
                                        by = "wmu")
rm (data.moose.habitat.fire.1936)
gc ()

# 1935
data.moose.habitat.fire.1935 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1935,
                                                         .(Fire_1935_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1935,
                                        by = "wmu")
rm (data.moose.habitat.fire.1935)
gc ()

# 1934
data.moose.habitat.fire.1934 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1934,
                                                         .(Fire_1934_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1934,
                                        by = "wmu")
rm (data.moose.habitat.fire.1934)
gc ()

# 1933
data.moose.habitat.fire.1933 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1933,
                                                         .(Fire_1933_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1933,
                                        by = "wmu")
rm (data.moose.habitat.fire.1933)
gc ()

# 1932
data.moose.habitat.fire.1932 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1932,
                                                         .(Fire_1932_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1932,
                                        by = "wmu")
rm (data.moose.habitat.fire.1932)
gc ()

# 1931
data.moose.habitat.fire.1931 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1931,
                                                         .(Fire_1931_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1931,
                                        by = "wmu")
rm (data.moose.habitat.fire.1931)
gc ()

# 1930
data.moose.habitat.fire.1930 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1930,
                                                         .(Fire_1930_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1930,
                                        by = "wmu")
rm (data.moose.habitat.fire.1930)
gc ()

# 1929
data.moose.habitat.fire.1929 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1929,
                                                         .(Fire_1929_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1929,
                                        by = "wmu")
rm (data.moose.habitat.fire.1929)
gc ()

# 1928
data.moose.habitat.fire.1928 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1928,
                                                         .(Fire_1928_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1928,
                                        by = "wmu")
rm (data.moose.habitat.fire.1928)
gc ()

# 1927
data.moose.habitat.fire.1927 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1927,
                                                         .(Fire_1927_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1927,
                                        by = "wmu")
rm (data.moose.habitat.fire.1927)
gc ()

# 1926
data.moose.habitat.fire.1926 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1926,
                                                         .(Fire_1926_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1926,
                                        by = "wmu")
rm (data.moose.habitat.fire.1926)
gc ()

# 1925
data.moose.habitat.fire.1925 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1925,
                                                         .(Fire_1925_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1925,
                                        by = "wmu")
rm (data.moose.habitat.fire.1925)
gc ()

# 1924
data.moose.habitat.fire.1924 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1924,
                                                         .(Fire_1924_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1924,
                                        by = "wmu")
rm (data.moose.habitat.fire.1924)
gc ()

# 1923
data.moose.habitat.fire.1923 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1923,
                                                         .(Fire_1923_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1923,
                                        by = "wmu")
rm (data.moose.habitat.fire.1923)
gc ()

# 1922
data.moose.habitat.fire.1922 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1922,
                                                         .(Fire_1922_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1922,
                                        by = "wmu")
rm (data.moose.habitat.fire.1922)
gc ()

# 1921
data.moose.habitat.fire.1921 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1921,
                                                         .(Fire_1921_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1921,
                                        by = "wmu")
rm (data.moose.habitat.fire.1921)
gc ()

# 1920
data.moose.habitat.fire.1920 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1920,
                                                         .(Fire_1920_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1920,
                                        by = "wmu")
rm (data.moose.habitat.fire.1920)
gc ()

# 1919
data.moose.habitat.fire.1919 <- data.moose.habitat.fire [FIRE_YEAR_1 == 1919,
                                                         .(Fire_1919_area_ha = sum (area_ha)), 
                                                         by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.fire.1919,
                                        by = "wmu")
rm (data.moose.habitat.fire.1919, data.moose.habitat.fire)
gc ()



### Cutblocks - area cut, by year and WMU
# 2018
data.moose.habitat.cut <- data.table (data.moose.habitat) [, .(wmu, HARVEST_YEAR, area_ha)]
sort (unique (data.moose.habitat.cut$HARVEST_YEAR))

data.moose.habitat.cut.2018 <- data.moose.habitat.cut [HARVEST_YEAR == 2018,
                                                       .(Cut_2018_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2018,
                                        by = "wmu")
rm (data.moose.habitat.cut.2018)
gc ()

# 2017
data.moose.habitat.cut.2017 <- data.moose.habitat.cut [HARVEST_YEAR == 2017,
                                                       .(Cut_2017_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2017,
                                        by = "wmu")
rm (data.moose.habitat.cut.2017)
gc ()

# 2016
data.moose.habitat.cut.2016 <- data.moose.habitat.cut [HARVEST_YEAR == 2016,
                                                       .(Cut_2016_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2016,
                                        by = "wmu")
rm (data.moose.habitat.cut.2016)
gc ()

# 2015
data.moose.habitat.cut.2015 <- data.moose.habitat.cut [HARVEST_YEAR == 2015,
                                                       .(Cut_2015_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2015,
                                        by = "wmu")
rm (data.moose.habitat.cut.2015)
gc ()

# 2014
data.moose.habitat.cut.2014 <- data.moose.habitat.cut [HARVEST_YEAR == 2014,
                                                       .(Cut_2014_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2014,
                                        by = "wmu")
rm (data.moose.habitat.cut.2014)
gc ()

# 2013
data.moose.habitat.cut.2013 <- data.moose.habitat.cut [HARVEST_YEAR == 2013,
                                                       .(Cut_2013_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2013,
                                        by = "wmu")
rm (data.moose.habitat.cut.2013)
gc ()

# 2012
data.moose.habitat.cut.2012 <- data.moose.habitat.cut [HARVEST_YEAR == 2012,
                                                       .(Cut_2012_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2012,
                                        by = "wmu")
rm (data.moose.habitat.cut.2012)
gc ()

# 2011
data.moose.habitat.cut.2011 <- data.moose.habitat.cut [HARVEST_YEAR == 2011,
                                                       .(Cut_2011_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2011,
                                        by = "wmu")
rm (data.moose.habitat.cut.2011)
gc ()

# 2010
data.moose.habitat.cut.2010 <- data.moose.habitat.cut [HARVEST_YEAR == 2010,
                                                       .(Cut_2010_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2010,
                                        by = "wmu")
rm (data.moose.habitat.cut.2010)
gc ()

# 2009
data.moose.habitat.cut.2009 <- data.moose.habitat.cut [HARVEST_YEAR == 2009,
                                                       .(Cut_2009_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2009,
                                        by = "wmu")
rm (data.moose.habitat.cut.2009)
gc ()

# 2008
data.moose.habitat.cut.2008 <- data.moose.habitat.cut [HARVEST_YEAR == 2008,
                                                       .(Cut_2008_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2008,
                                        by = "wmu")
rm (data.moose.habitat.cut.2008)
gc ()

# 2007
data.moose.habitat.cut.2007 <- data.moose.habitat.cut [HARVEST_YEAR == 2007,
                                                       .(Cut_2007_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2007,
                                        by = "wmu")
rm (data.moose.habitat.cut.2007)
gc ()

# 2006
data.moose.habitat.cut.2006 <- data.moose.habitat.cut [HARVEST_YEAR == 2006,
                                                       .(Cut_2006_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2006,
                                        by = "wmu")
rm (data.moose.habitat.cut.2006)
gc ()

# 2005
data.moose.habitat.cut.2005 <- data.moose.habitat.cut [HARVEST_YEAR == 2005,
                                                       .(Cut_2005_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2005,
                                        by = "wmu")
rm (data.moose.habitat.cut.2005)
gc ()

# 2004
data.moose.habitat.cut.2004 <- data.moose.habitat.cut [HARVEST_YEAR == 2004,
                                                       .(Cut_2004_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2004,
                                        by = "wmu")
rm (data.moose.habitat.cut.2004)
gc ()

# 2003
data.moose.habitat.cut.2003 <- data.moose.habitat.cut [HARVEST_YEAR == 2003,
                                                       .(Cut_2003_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2003,
                                        by = "wmu")
rm (data.moose.habitat.cut.2003)
gc ()

# 2002
data.moose.habitat.cut.2002 <- data.moose.habitat.cut [HARVEST_YEAR == 2002,
                                                       .(Cut_2002_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2002,
                                        by = "wmu")
rm (data.moose.habitat.cut.2002)
gc ()

# 2001
data.moose.habitat.cut.2001 <- data.moose.habitat.cut [HARVEST_YEAR == 2001,
                                                       .(Cut_2001_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2001,
                                        by = "wmu")
rm (data.moose.habitat.cut.2001)
gc ()

# 2000
data.moose.habitat.cut.2000 <- data.moose.habitat.cut [HARVEST_YEAR == 2000,
                                                       .(Cut_2000_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.2000,
                                        by = "wmu")
rm (data.moose.habitat.cut.2000)
gc ()

# 1999
data.moose.habitat.cut.1999 <- data.moose.habitat.cut [HARVEST_YEAR == 1999,
                                                       .(Cut_1999_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1999,
                                        by = "wmu")
rm (data.moose.habitat.cut.1999)
gc ()

# 1998
data.moose.habitat.cut.1998 <- data.moose.habitat.cut [HARVEST_YEAR == 1998,
                                                       .(Cut_1998_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1998,
                                        by = "wmu")
rm (data.moose.habitat.cut.1998)
gc ()

# 1997
data.moose.habitat.cut.1997 <- data.moose.habitat.cut [HARVEST_YEAR == 1997,
                                                       .(Cut_1997_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1997,
                                        by = "wmu")
rm (data.moose.habitat.cut.1997)
gc ()

# 1996
data.moose.habitat.cut.1996 <- data.moose.habitat.cut [HARVEST_YEAR == 1996,
                                                       .(Cut_1996_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1996,
                                        by = "wmu")
rm (data.moose.habitat.cut.1996)
gc ()

# 1995
data.moose.habitat.cut.1995 <- data.moose.habitat.cut [HARVEST_YEAR == 1995,
                                                       .(Cut_1995_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1995,
                                        by = "wmu")
rm (data.moose.habitat.cut.1995)
gc ()

# 1994
data.moose.habitat.cut.1994 <- data.moose.habitat.cut [HARVEST_YEAR == 1994,
                                                       .(Cut_1994_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1994,
                                        by = "wmu")
rm (data.moose.habitat.cut.1994)
gc ()

# 1993
data.moose.habitat.cut.1993 <- data.moose.habitat.cut [HARVEST_YEAR == 1993,
                                                       .(Cut_1993_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1993,
                                        by = "wmu")
rm (data.moose.habitat.cut.1993)
gc ()

# 1992
data.moose.habitat.cut.1992 <- data.moose.habitat.cut [HARVEST_YEAR == 1992,
                                                       .(Cut_1992_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1992,
                                        by = "wmu")
rm (data.moose.habitat.cut.1992)
gc ()

# 1991
data.moose.habitat.cut.1991 <- data.moose.habitat.cut [HARVEST_YEAR == 1991,
                                                       .(Cut_1991_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1991,
                                        by = "wmu")
rm (data.moose.habitat.cut.1991)
gc ()

# 1990
data.moose.habitat.cut.1990 <- data.moose.habitat.cut [HARVEST_YEAR == 1990,
                                                       .(Cut_1990_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1990,
                                        by = "wmu")
rm (data.moose.habitat.cut.1990)
gc ()

# 1989
data.moose.habitat.cut.1989 <- data.moose.habitat.cut [HARVEST_YEAR == 1989,
                                                       .(Cut_1989_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1989,
                                        by = "wmu")
rm (data.moose.habitat.cut.1989)
gc ()

# 1988
data.moose.habitat.cut.1988 <- data.moose.habitat.cut [HARVEST_YEAR == 1988,
                                                       .(Cut_1988_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1988,
                                        by = "wmu")
rm (data.moose.habitat.cut.1988)
gc ()

# 1987
data.moose.habitat.cut.1987 <- data.moose.habitat.cut [HARVEST_YEAR == 1987,
                                                       .(Cut_1987_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1987,
                                        by = "wmu")
rm (data.moose.habitat.cut.1987)
gc ()

# 1986
data.moose.habitat.cut.1986 <- data.moose.habitat.cut [HARVEST_YEAR == 1986,
                                                       .(Cut_1986_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1986,
                                        by = "wmu")
rm (data.moose.habitat.cut.1986)
gc ()

# 1985
data.moose.habitat.cut.1985 <- data.moose.habitat.cut [HARVEST_YEAR == 1985,
                                                       .(Cut_1985_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1985,
                                        by = "wmu")
rm (data.moose.habitat.cut.1985)
gc ()

# 1984
data.moose.habitat.cut.1984 <- data.moose.habitat.cut [HARVEST_YEAR == 1984,
                                                       .(Cut_1984_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1984,
                                        by = "wmu")
rm (data.moose.habitat.cut.1984)
gc ()

# 1983
data.moose.habitat.cut.1983 <- data.moose.habitat.cut [HARVEST_YEAR == 1983,
                                                       .(Cut_1983_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1983,
                                        by = "wmu")
rm (data.moose.habitat.cut.1983)
gc ()

# 1982
data.moose.habitat.cut.1982 <- data.moose.habitat.cut [HARVEST_YEAR == 1982,
                                                       .(Cut_1982_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1982,
                                        by = "wmu")
rm (data.moose.habitat.cut.1982)
gc ()

# 1981
data.moose.habitat.cut.1981 <- data.moose.habitat.cut [HARVEST_YEAR == 1981,
                                                       .(Cut_1981_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1981,
                                        by = "wmu")
rm (data.moose.habitat.cut.1981)
gc ()

# 1980
data.moose.habitat.cut.1980 <- data.moose.habitat.cut [HARVEST_YEAR == 1980,
                                                       .(Cut_1980_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1980,
                                        by = "wmu")
rm (data.moose.habitat.cut.1980)
gc ()

# 1979
data.moose.habitat.cut.1979 <- data.moose.habitat.cut [HARVEST_YEAR == 1979,
                                                       .(Cut_1979_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1979,
                                        by = "wmu")
rm (data.moose.habitat.cut.1979)
gc ()

# 1978
data.moose.habitat.cut.1978 <- data.moose.habitat.cut [HARVEST_YEAR == 1978,
                                                       .(Cut_1978_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1978,
                                        by = "wmu")
rm (data.moose.habitat.cut.1978)
gc ()

# 1977
data.moose.habitat.cut.1977 <- data.moose.habitat.cut [HARVEST_YEAR == 1977,
                                                       .(Cut_1977_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1977,
                                        by = "wmu")
rm (data.moose.habitat.cut.1977)
gc ()

# 1976
data.moose.habitat.cut.1976 <- data.moose.habitat.cut [HARVEST_YEAR == 1976,
                                                       .(Cut_1976_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1976,
                                        by = "wmu")
rm (data.moose.habitat.cut.1976)
gc ()

# 1975
data.moose.habitat.cut.1975 <- data.moose.habitat.cut [HARVEST_YEAR == 1975,
                                                       .(Cut_1975_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1975,
                                        by = "wmu")
rm (data.moose.habitat.cut.1975)
gc ()

# 1974
data.moose.habitat.cut.1974 <- data.moose.habitat.cut [HARVEST_YEAR == 1974,
                                                       .(Cut_1974_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1974,
                                        by = "wmu")
rm (data.moose.habitat.cut.1974)
gc ()

# 1973
data.moose.habitat.cut.1973 <- data.moose.habitat.cut [HARVEST_YEAR == 1973,
                                                       .(Cut_1973_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1973,
                                        by = "wmu")
rm (data.moose.habitat.cut.1973)
gc ()

# 1972
data.moose.habitat.cut.1972 <- data.moose.habitat.cut [HARVEST_YEAR == 1972,
                                                       .(Cut_1972_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1972,
                                        by = "wmu")
rm (data.moose.habitat.cut.1972)
gc ()

# 1971
data.moose.habitat.cut.1971 <- data.moose.habitat.cut [HARVEST_YEAR == 1971,
                                                       .(Cut_1971_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1971,
                                        by = "wmu")
rm (data.moose.habitat.cut.1971)
gc ()

# 1970
data.moose.habitat.cut.1970 <- data.moose.habitat.cut [HARVEST_YEAR == 1970,
                                                       .(Cut_1970_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1970,
                                        by = "wmu")
rm (data.moose.habitat.cut.1970)
gc ()

# 1969
data.moose.habitat.cut.1969 <- data.moose.habitat.cut [HARVEST_YEAR == 1969,
                                                       .(Cut_1969_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1969,
                                        by = "wmu")
rm (data.moose.habitat.cut.1969)
gc ()

# 1968
data.moose.habitat.cut.1968 <- data.moose.habitat.cut [HARVEST_YEAR == 1968,
                                                       .(Cut_1968_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1968,
                                        by = "wmu")
rm (data.moose.habitat.cut.1968)
gc ()

# 1967
data.moose.habitat.cut.1967 <- data.moose.habitat.cut [HARVEST_YEAR == 1967,
                                                       .(Cut_1967_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1967,
                                        by = "wmu")
rm (data.moose.habitat.cut.1967)
gc ()

# 1966
data.moose.habitat.cut.1966 <- data.moose.habitat.cut [HARVEST_YEAR == 1966,
                                                       .(Cut_1966_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1966,
                                        by = "wmu")
rm (data.moose.habitat.cut.1966)
gc ()

# 1965
data.moose.habitat.cut.1965 <- data.moose.habitat.cut [HARVEST_YEAR == 1965,
                                                       .(Cut_1965_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1965,
                                        by = "wmu")
rm (data.moose.habitat.cut.1965)
gc ()

# 1964
data.moose.habitat.cut.1964 <- data.moose.habitat.cut [HARVEST_YEAR == 1964,
                                                       .(Cut_1964_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1964,
                                        by = "wmu")
rm (data.moose.habitat.cut.1964)
gc ()

# 1963
data.moose.habitat.cut.1963 <- data.moose.habitat.cut [HARVEST_YEAR == 1963,
                                                       .(Cut_1963_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1963,
                                        by = "wmu")
rm (data.moose.habitat.cut.1963)
gc ()

# 1962
data.moose.habitat.cut.1962 <- data.moose.habitat.cut [HARVEST_YEAR == 1962,
                                                       .(Cut_1962_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1962,
                                        by = "wmu")
rm (data.moose.habitat.cut.1962)
gc ()

# 1961
data.moose.habitat.cut.1961 <- data.moose.habitat.cut [HARVEST_YEAR == 1961,
                                                       .(Cut_1961_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1961,
                                        by = "wmu")
rm (data.moose.habitat.cut.1961)
gc ()

# 1960
data.moose.habitat.cut.1960 <- data.moose.habitat.cut [HARVEST_YEAR == 1960,
                                                       .(Cut_1960_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1960,
                                        by = "wmu")
rm (data.moose.habitat.cut.1960)
gc ()

# 1959
data.moose.habitat.cut.1959 <- data.moose.habitat.cut [HARVEST_YEAR == 1959,
                                                       .(Cut_1959_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1959,
                                        by = "wmu")
rm (data.moose.habitat.cut.1959)
gc ()

# 1958
data.moose.habitat.cut.1958 <- data.moose.habitat.cut [HARVEST_YEAR == 1958,
                                                       .(Cut_1958_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1958,
                                        by = "wmu")
rm (data.moose.habitat.cut.1958)
gc ()

# 1957
data.moose.habitat.cut.1957 <- data.moose.habitat.cut [HARVEST_YEAR == 1957,
                                                       .(Cut_1957_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1957,
                                        by = "wmu")
rm (data.moose.habitat.cut.1957)
gc ()

# 1956
data.moose.habitat.cut.1956 <- data.moose.habitat.cut [HARVEST_YEAR == 1956,
                                                       .(Cut_1956_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1956,
                                        by = "wmu")
rm (data.moose.habitat.cut.1956)
gc ()

# 1955
data.moose.habitat.cut.1955 <- data.moose.habitat.cut [HARVEST_YEAR == 1955,
                                                       .(Cut_1955_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1955,
                                        by = "wmu")
rm (data.moose.habitat.cut.1955)
gc ()

# 1954
data.moose.habitat.cut.1954 <- data.moose.habitat.cut [HARVEST_YEAR == 1954,
                                                       .(Cut_1954_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1954,
                                        by = "wmu")
rm (data.moose.habitat.cut.1954)
gc ()

# 1953
data.moose.habitat.cut.1953 <- data.moose.habitat.cut [HARVEST_YEAR == 1953,
                                                       .(Cut_1953_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1953,
                                        by = "wmu")
rm (data.moose.habitat.cut.1953)
gc ()

# 1952
data.moose.habitat.cut.1952 <- data.moose.habitat.cut [HARVEST_YEAR == 1952,
                                                       .(Cut_1952_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1952,
                                        by = "wmu")
rm (data.moose.habitat.cut.1952)
gc ()

# 1949
data.moose.habitat.cut.1949 <- data.moose.habitat.cut [HARVEST_YEAR == 1949,
                                                       .(Cut_1949_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1949,
                                        by = "wmu")
rm (data.moose.habitat.cut.1949)
gc ()

# 1948
data.moose.habitat.cut.1948 <- data.moose.habitat.cut [HARVEST_YEAR == 1948,
                                                       .(Cut_1948_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1948,
                                        by = "wmu")
rm (data.moose.habitat.cut.1948)
gc ()

# 1946
data.moose.habitat.cut.1946 <- data.moose.habitat.cut [HARVEST_YEAR == 1946,
                                                       .(Cut_1946_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1946,
                                        by = "wmu")
rm (data.moose.habitat.cut.1946)
gc ()

# 1945
data.moose.habitat.cut.1945 <- data.moose.habitat.cut [HARVEST_YEAR == 1945,
                                                       .(Cut_1945_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1945,
                                        by = "wmu")
rm (data.moose.habitat.cut.1945)
gc ()

# 1944
data.moose.habitat.cut.1944 <- data.moose.habitat.cut [HARVEST_YEAR == 1944,
                                                       .(Cut_1944_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1944,
                                        by = "wmu")
rm (data.moose.habitat.cut.1944)
gc ()

# 1943
data.moose.habitat.cut.1943 <- data.moose.habitat.cut [HARVEST_YEAR == 1943,
                                                       .(Cut_1943_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1943,
                                        by = "wmu")
rm (data.moose.habitat.cut.1943)
gc ()

# 1942
data.moose.habitat.cut.1942 <- data.moose.habitat.cut [HARVEST_YEAR == 1942,
                                                       .(Cut_1942_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1942,
                                        by = "wmu")
rm (data.moose.habitat.cut.1942)
gc ()

# 1940
data.moose.habitat.cut.1940 <- data.moose.habitat.cut [HARVEST_YEAR == 1940,
                                                       .(Cut_1940_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1940,
                                        by = "wmu")
rm (data.moose.habitat.cut.1940)
gc ()

# 1937
data.moose.habitat.cut.1937 <- data.moose.habitat.cut [HARVEST_YEAR == 1937,
                                                       .(Cut_1937_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1937,
                                        by = "wmu")
rm (data.moose.habitat.cut.1937)
gc ()

# 1936
data.moose.habitat.cut.1936 <- data.moose.habitat.cut [HARVEST_YEAR == 1936,
                                                       .(Cut_1936_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1936,
                                        by = "wmu")
rm (data.moose.habitat.cut.1936)
gc ()

# 1935
data.moose.habitat.cut.1935 <- data.moose.habitat.cut [HARVEST_YEAR == 1935,
                                                       .(Cut_1935_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1935,
                                        by = "wmu")
rm (data.moose.habitat.cut.1935)
gc ()

# 1932
data.moose.habitat.cut.1932 <- data.moose.habitat.cut [HARVEST_YEAR == 1932,
                                                       .(Cut_1932_area_ha = sum (area_ha)), 
                                                       by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.cut.1932,
                                        by = "wmu")
rm (data.moose.habitat.cut.1932, data.moose.habitat.cut)
gc ()

colnames (data.moose.density)

data.moose.density <- data.table (data.moose.density)
data.moose.density [is.na (data.moose.density)] <- 0

### Summarize fire and cut into 10 years intervals
sort (unique (data.moose.density$survey_year))

# Cuts 1 to 5 years old
data.moose.density [survey_year == 2019, Cut_1_5_area_ha := Cut_2018_area_ha + Cut_2017_area_ha + Cut_2016_area_ha + Cut_2015_area_ha + Cut_2014_area_ha] 
data.moose.density [survey_year == 2018, Cut_1_5_area_ha := Cut_2017_area_ha + Cut_2016_area_ha + Cut_2015_area_ha + Cut_2014_area_ha + Cut_2013_area_ha] 
data.moose.density [survey_year == 2017, Cut_1_5_area_ha := Cut_2016_area_ha + Cut_2015_area_ha + Cut_2014_area_ha + Cut_2013_area_ha + Cut_2012_area_ha] 
data.moose.density [survey_year == 2015, Cut_1_5_area_ha := Cut_2014_area_ha + Cut_2013_area_ha + Cut_2012_area_ha + Cut_2011_area_ha + Cut_2010_area_ha] 
data.moose.density [survey_year == 2014, Cut_1_5_area_ha := Cut_2013_area_ha + Cut_2012_area_ha + Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha] 
data.moose.density [survey_year == 2013, Cut_1_5_area_ha := Cut_2012_area_ha + Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha + Cut_2008_area_ha] 
data.moose.density [survey_year == 2012, Cut_1_5_area_ha := Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha + Cut_2008_area_ha + Cut_2007_area_ha] 
data.moose.density [survey_year == 2011, Cut_1_5_area_ha := Cut_2010_area_ha + Cut_2009_area_ha + Cut_2008_area_ha + Cut_2007_area_ha + Cut_2006_area_ha] 
data.moose.density [survey_year == 2008, Cut_1_5_area_ha := Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha] 
data.moose.density [survey_year == 2006, Cut_1_5_area_ha := Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha] 
data.moose.density [survey_year == 2005, Cut_1_5_area_ha := Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha] 
data.moose.density [survey_year == 2004, Cut_1_5_area_ha := Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha] 
data.moose.density [survey_year == 2003, Cut_1_5_area_ha := Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha] 
data.moose.density [survey_year == 2002, Cut_1_5_area_ha := Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha] 
data.moose.density [survey_year == 2001, Cut_1_5_area_ha := Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha] 
data.moose.density [survey_year == 2000, Cut_1_5_area_ha := Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha] 
data.moose.density [survey_year == 1999, Cut_1_5_area_ha := Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha] 
data.moose.density [survey_year == 1998, Cut_1_5_area_ha := Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha]
data.moose.density [survey_year == 1997, Cut_1_5_area_ha := Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha]
data.moose.density [survey_year == 1996, Cut_1_5_area_ha := Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha]
data.moose.density [survey_year == 1995, Cut_1_5_area_ha := Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha]
data.moose.density [survey_year == 1994, Cut_1_5_area_ha := Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha]

# Cuts 6 to 10 years old
data.moose.density [survey_year == 2019, Cut_6_10_area_ha := Cut_2013_area_ha + Cut_2012_area_ha + Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha] 
data.moose.density [survey_year == 2018, Cut_6_10_area_ha := Cut_2012_area_ha + Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha + Cut_2008_area_ha] 
data.moose.density [survey_year == 2017, Cut_6_10_area_ha := Cut_2011_area_ha + Cut_2010_area_ha + Cut_2009_area_ha + Cut_2008_area_ha + Cut_2007_area_ha] 
data.moose.density [survey_year == 2015, Cut_6_10_area_ha := Cut_2009_area_ha + Cut_2008_area_ha + Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha] 
data.moose.density [survey_year == 2014, Cut_6_10_area_ha := Cut_2008_area_ha + Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha] 
data.moose.density [survey_year == 2013, Cut_6_10_area_ha := Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha] 
data.moose.density [survey_year == 2012, Cut_6_10_area_ha := Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha] 
data.moose.density [survey_year == 2011, Cut_6_10_area_ha := Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha] 
data.moose.density [survey_year == 2008, Cut_6_10_area_ha := Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha] 
data.moose.density [survey_year == 2006, Cut_6_10_area_ha := Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha] 
data.moose.density [survey_year == 2005, Cut_6_10_area_ha := Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha] 
data.moose.density [survey_year == 2004, Cut_6_10_area_ha := Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha] 
data.moose.density [survey_year == 2003, Cut_6_10_area_ha := Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha] 
data.moose.density [survey_year == 2002, Cut_6_10_area_ha := Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha] 
data.moose.density [survey_year == 2001, Cut_6_10_area_ha := Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha] 
data.moose.density [survey_year == 2000, Cut_6_10_area_ha := Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha] 
data.moose.density [survey_year == 1999, Cut_6_10_area_ha := Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha] 
data.moose.density [survey_year == 1998, Cut_6_10_area_ha := Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha]
data.moose.density [survey_year == 1997, Cut_6_10_area_ha := Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha]
data.moose.density [survey_year == 1996, Cut_6_10_area_ha := Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha]
data.moose.density [survey_year == 1995, Cut_6_10_area_ha := Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha]
data.moose.density [survey_year == 1994, Cut_6_10_area_ha := Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha]

# Cuts 11 to 15 years old
data.moose.density [survey_year == 2019, Cut_11_15_area_ha := Cut_2008_area_ha + Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha] 
data.moose.density [survey_year == 2018, Cut_11_15_area_ha := Cut_2007_area_ha + Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha] 
data.moose.density [survey_year == 2017, Cut_11_15_area_ha := Cut_2006_area_ha + Cut_2005_area_ha + Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha] 
data.moose.density [survey_year == 2015, Cut_11_15_area_ha := Cut_2004_area_ha + Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha] 
data.moose.density [survey_year == 2014, Cut_11_15_area_ha := Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha] 
data.moose.density [survey_year == 2013, Cut_11_15_area_ha := Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha] 
data.moose.density [survey_year == 2012, Cut_11_15_area_ha := Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha] 
data.moose.density [survey_year == 2011, Cut_11_15_area_ha := Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha]
data.moose.density [survey_year == 2008, Cut_11_15_area_ha := Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha] 
data.moose.density [survey_year == 2006, Cut_11_15_area_ha := Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha] 
data.moose.density [survey_year == 2005, Cut_11_15_area_ha := Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha] 
data.moose.density [survey_year == 2004, Cut_11_15_area_ha := Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha] 
data.moose.density [survey_year == 2003, Cut_11_15_area_ha := Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha] 
data.moose.density [survey_year == 2002, Cut_11_15_area_ha := Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha] 
data.moose.density [survey_year == 2001, Cut_11_15_area_ha := Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha] 
data.moose.density [survey_year == 2000, Cut_11_15_area_ha := Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha]  
data.moose.density [survey_year == 1999, Cut_11_15_area_ha := Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha] 
data.moose.density [survey_year == 1998, Cut_11_15_area_ha := Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha]
data.moose.density [survey_year == 1997, Cut_11_15_area_ha := Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha]
data.moose.density [survey_year == 1996, Cut_11_15_area_ha := Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha]
data.moose.density [survey_year == 1995, Cut_11_15_area_ha := Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha]
data.moose.density [survey_year == 1994, Cut_11_15_area_ha := Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha]

# Cuts 16 to 20 years old
data.moose.density [survey_year == 2019, Cut_16_20_area_ha := Cut_2003_area_ha + Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha] 
data.moose.density [survey_year == 2018, Cut_16_20_area_ha := Cut_2002_area_ha + Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha] 
data.moose.density [survey_year == 2017, Cut_16_20_area_ha := Cut_2001_area_ha + Cut_2000_area_ha + Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha] 
data.moose.density [survey_year == 2015, Cut_16_20_area_ha := Cut_1999_area_ha + Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha] 
data.moose.density [survey_year == 2014, Cut_16_20_area_ha := Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha] 
data.moose.density [survey_year == 2013, Cut_16_20_area_ha := Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha] 
data.moose.density [survey_year == 2012, Cut_16_20_area_ha := Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha] 
data.moose.density [survey_year == 2011, Cut_16_20_area_ha := Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha]
data.moose.density [survey_year == 2008, Cut_16_20_area_ha := Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha] 
data.moose.density [survey_year == 2006, Cut_16_20_area_ha := Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha] 
data.moose.density [survey_year == 2005, Cut_16_20_area_ha := Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha] 
data.moose.density [survey_year == 2004, Cut_16_20_area_ha := Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha] 
data.moose.density [survey_year == 2003, Cut_16_20_area_ha := Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha] 
data.moose.density [survey_year == 2002, Cut_16_20_area_ha := Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha] 
data.moose.density [survey_year == 2001, Cut_16_20_area_ha := Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha] 
data.moose.density [survey_year == 2000, Cut_16_20_area_ha := Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha]  
data.moose.density [survey_year == 1999, Cut_16_20_area_ha := Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha] 
data.moose.density [survey_year == 1998, Cut_16_20_area_ha := Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha]
data.moose.density [survey_year == 1997, Cut_16_20_area_ha := Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha]
data.moose.density [survey_year == 1996, Cut_16_20_area_ha := Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha]
data.moose.density [survey_year == 1995, Cut_16_20_area_ha := Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha]
data.moose.density [survey_year == 1994, Cut_16_20_area_ha := Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha]

# Cuts 21 to 25 years old
data.moose.density [survey_year == 2019, Cut_21_25_area_ha := Cut_1998_area_ha + Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha] 
data.moose.density [survey_year == 2018, Cut_21_25_area_ha := Cut_1997_area_ha + Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha] 
data.moose.density [survey_year == 2017, Cut_21_25_area_ha := Cut_1996_area_ha + Cut_1995_area_ha + Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha] 
data.moose.density [survey_year == 2015, Cut_21_25_area_ha := Cut_1994_area_ha + Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha] 
data.moose.density [survey_year == 2014, Cut_21_25_area_ha := Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha] 
data.moose.density [survey_year == 2013, Cut_21_25_area_ha := Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha] 
data.moose.density [survey_year == 2012, Cut_21_25_area_ha := Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha] 
data.moose.density [survey_year == 2011, Cut_21_25_area_ha := Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha]
data.moose.density [survey_year == 2008, Cut_21_25_area_ha := Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha] 
data.moose.density [survey_year == 2006, Cut_21_25_area_ha := Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha] 
data.moose.density [survey_year == 2005, Cut_21_25_area_ha := Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha] 
data.moose.density [survey_year == 2004, Cut_21_25_area_ha := Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha] 
data.moose.density [survey_year == 2003, Cut_21_25_area_ha := Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha] 
data.moose.density [survey_year == 2002, Cut_21_25_area_ha := Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha] 
data.moose.density [survey_year == 2001, Cut_21_25_area_ha := Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha] 
data.moose.density [survey_year == 2000, Cut_21_25_area_ha := Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha]  
data.moose.density [survey_year == 1999, Cut_21_25_area_ha := Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha] 
data.moose.density [survey_year == 1998, Cut_21_25_area_ha := Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha]
data.moose.density [survey_year == 1997, Cut_21_25_area_ha := Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha]
data.moose.density [survey_year == 1996, Cut_21_25_area_ha := Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha]
data.moose.density [survey_year == 1995, Cut_21_25_area_ha := Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha + Cut_1970_area_ha]
data.moose.density [survey_year == 1994, Cut_21_25_area_ha := Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha + Cut_1970_area_ha + Cut_1969_area_ha]

# Cuts 26 to 30 years old
data.moose.density [survey_year == 2019, Cut_26_30_area_ha := Cut_1993_area_ha + Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha] 
data.moose.density [survey_year == 2018, Cut_26_30_area_ha := Cut_1992_area_ha + Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha] 
data.moose.density [survey_year == 2017, Cut_26_30_area_ha := Cut_1991_area_ha + Cut_1990_area_ha + Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha] 
data.moose.density [survey_year == 2015, Cut_26_30_area_ha := Cut_1989_area_ha + Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha] 
data.moose.density [survey_year == 2014, Cut_26_30_area_ha := Cut_1988_area_ha + Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha]
data.moose.density [survey_year == 2013, Cut_26_30_area_ha := Cut_1987_area_ha + Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha] 
data.moose.density [survey_year == 2012, Cut_26_30_area_ha := Cut_1986_area_ha + Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha] 
data.moose.density [survey_year == 2011, Cut_26_30_area_ha := Cut_1985_area_ha + Cut_1984_area_ha + Cut_1983_area_ha + Cut_1982_area_ha + Cut_1981_area_ha]
data.moose.density [survey_year == 2008, Cut_26_30_area_ha := Cut_1982_area_ha + Cut_1981_area_ha + Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha] 
data.moose.density [survey_year == 2006, Cut_26_30_area_ha := Cut_1980_area_ha + Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha] 
data.moose.density [survey_year == 2005, Cut_26_30_area_ha := Cut_1979_area_ha + Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha] 
data.moose.density [survey_year == 2004, Cut_26_30_area_ha := Cut_1978_area_ha + Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha] 
data.moose.density [survey_year == 2003, Cut_26_30_area_ha := Cut_1977_area_ha + Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha] 
data.moose.density [survey_year == 2002, Cut_26_30_area_ha := Cut_1976_area_ha + Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha] 
data.moose.density [survey_year == 2001, Cut_26_30_area_ha := Cut_1975_area_ha + Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha] 
data.moose.density [survey_year == 2000, Cut_26_30_area_ha := Cut_1974_area_ha + Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha + Cut_1970_area_ha]  
data.moose.density [survey_year == 1999, Cut_26_30_area_ha := Cut_1973_area_ha + Cut_1972_area_ha + Cut_1971_area_ha + Cut_1970_area_ha + Cut_1969_area_ha] 
data.moose.density [survey_year == 1998, Cut_26_30_area_ha := Cut_1972_area_ha + Cut_1971_area_ha + Cut_1970_area_ha + Cut_1969_area_ha + Cut_1968_area_ha]
data.moose.density [survey_year == 1997, Cut_26_30_area_ha := Cut_1971_area_ha + Cut_1970_area_ha + Cut_1969_area_ha + Cut_1968_area_ha + Cut_1967_area_ha]
data.moose.density [survey_year == 1996, Cut_26_30_area_ha := Cut_1970_area_ha + Cut_1969_area_ha + Cut_1968_area_ha + Cut_1967_area_ha + Cut_1966_area_ha]
data.moose.density [survey_year == 1995, Cut_26_30_area_ha := Cut_1969_area_ha + Cut_1968_area_ha + Cut_1967_area_ha + Cut_1966_area_ha + Cut_1965_area_ha]
data.moose.density [survey_year == 1994, Cut_26_30_area_ha := Cut_1968_area_ha + Cut_1967_area_ha + Cut_1966_area_ha + Cut_1965_area_ha + Cut_1964_area_ha]


# Fires 1 to 5 years old
data.moose.density [survey_year == 2019, Fire_1_5_area_ha := Fire_2018_area_ha + Fire_2017_area_ha + Fire_2016_area_ha + Fire_2015_area_ha + Fire_2014_area_ha] 
data.moose.density [survey_year == 2018, Fire_1_5_area_ha := Fire_2017_area_ha + Fire_2016_area_ha + Fire_2015_area_ha + Fire_2014_area_ha + Fire_2013_area_ha] 
data.moose.density [survey_year == 2017, Fire_1_5_area_ha := Fire_2016_area_ha + Fire_2015_area_ha + Fire_2014_area_ha + Fire_2013_area_ha + Fire_2012_area_ha] 
data.moose.density [survey_year == 2015, Fire_1_5_area_ha := Fire_2014_area_ha + Fire_2013_area_ha + Fire_2012_area_ha + Fire_2011_area_ha + Fire_2010_area_ha] 
data.moose.density [survey_year == 2014, Fire_1_5_area_ha := Fire_2013_area_ha + Fire_2012_area_ha + Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha] 
data.moose.density [survey_year == 2013, Fire_1_5_area_ha := Fire_2012_area_ha + Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha + Fire_2008_area_ha] 
data.moose.density [survey_year == 2012, Fire_1_5_area_ha := Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha + Fire_2008_area_ha + Fire_2007_area_ha] 
data.moose.density [survey_year == 2011, Fire_1_5_area_ha := Fire_2010_area_ha + Fire_2009_area_ha + Fire_2008_area_ha + Fire_2007_area_ha + Fire_2006_area_ha] 
data.moose.density [survey_year == 2008, Fire_1_5_area_ha := Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha] 
data.moose.density [survey_year == 2006, Fire_1_5_area_ha := Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha] 
data.moose.density [survey_year == 2005, Fire_1_5_area_ha := Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha] 
data.moose.density [survey_year == 2004, Fire_1_5_area_ha := Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha] 
data.moose.density [survey_year == 2003, Fire_1_5_area_ha := Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha] 
data.moose.density [survey_year == 2002, Fire_1_5_area_ha := Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha] 
data.moose.density [survey_year == 2001, Fire_1_5_area_ha := Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha] 
data.moose.density [survey_year == 2000, Fire_1_5_area_ha := Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha] 
data.moose.density [survey_year == 1999, Fire_1_5_area_ha := Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha] 
data.moose.density [survey_year == 1998, Fire_1_5_area_ha := Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha]
data.moose.density [survey_year == 1997, Fire_1_5_area_ha := Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha]
data.moose.density [survey_year == 1996, Fire_1_5_area_ha := Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha]
data.moose.density [survey_year == 1995, Fire_1_5_area_ha := Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha]
data.moose.density [survey_year == 1994, Fire_1_5_area_ha := Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha]

# Fires 6 to 10 years old
data.moose.density [survey_year == 2019, Fire_6_10_area_ha := Fire_2013_area_ha + Fire_2012_area_ha + Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha] 
data.moose.density [survey_year == 2018, Fire_6_10_area_ha := Fire_2012_area_ha + Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha + Fire_2008_area_ha] 
data.moose.density [survey_year == 2017, Fire_6_10_area_ha := Fire_2011_area_ha + Fire_2010_area_ha + Fire_2009_area_ha + Fire_2008_area_ha + Fire_2007_area_ha] 
data.moose.density [survey_year == 2015, Fire_6_10_area_ha := Fire_2009_area_ha + Fire_2008_area_ha + Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha] 
data.moose.density [survey_year == 2014, Fire_6_10_area_ha := Fire_2008_area_ha + Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha] 
data.moose.density [survey_year == 2013, Fire_6_10_area_ha := Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha] 
data.moose.density [survey_year == 2012, Fire_6_10_area_ha := Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha] 
data.moose.density [survey_year == 2011, Fire_6_10_area_ha := Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha] 
data.moose.density [survey_year == 2008, Fire_6_10_area_ha := Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha] 
data.moose.density [survey_year == 2006, Fire_6_10_area_ha := Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha] 
data.moose.density [survey_year == 2005, Fire_6_10_area_ha := Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha] 
data.moose.density [survey_year == 2004, Fire_6_10_area_ha := Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha] 
data.moose.density [survey_year == 2003, Fire_6_10_area_ha := Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha] 
data.moose.density [survey_year == 2002, Fire_6_10_area_ha := Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha] 
data.moose.density [survey_year == 2001, Fire_6_10_area_ha := Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha] 
data.moose.density [survey_year == 2000, Fire_6_10_area_ha := Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha] 
data.moose.density [survey_year == 1999, Fire_6_10_area_ha := Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha] 
data.moose.density [survey_year == 1998, Fire_6_10_area_ha := Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha]
data.moose.density [survey_year == 1997, Fire_6_10_area_ha := Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha]
data.moose.density [survey_year == 1996, Fire_6_10_area_ha := Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha]
data.moose.density [survey_year == 1995, Fire_6_10_area_ha := Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha]
data.moose.density [survey_year == 1994, Fire_6_10_area_ha := Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha]

# Fires 11 to 15 years old
data.moose.density [survey_year == 2019, Fire_11_15_area_ha := Fire_2008_area_ha + Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha] 
data.moose.density [survey_year == 2018, Fire_11_15_area_ha := Fire_2007_area_ha + Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha] 
data.moose.density [survey_year == 2017, Fire_11_15_area_ha := Fire_2006_area_ha + Fire_2005_area_ha + Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha] 
data.moose.density [survey_year == 2015, Fire_11_15_area_ha := Fire_2004_area_ha + Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha] 
data.moose.density [survey_year == 2014, Fire_11_15_area_ha := Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha] 
data.moose.density [survey_year == 2013, Fire_11_15_area_ha := Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha] 
data.moose.density [survey_year == 2012, Fire_11_15_area_ha := Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha] 
data.moose.density [survey_year == 2011, Fire_11_15_area_ha := Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha]
data.moose.density [survey_year == 2008, Fire_11_15_area_ha := Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha] 
data.moose.density [survey_year == 2006, Fire_11_15_area_ha := Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha] 
data.moose.density [survey_year == 2005, Fire_11_15_area_ha := Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha] 
data.moose.density [survey_year == 2004, Fire_11_15_area_ha := Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha] 
data.moose.density [survey_year == 2003, Fire_11_15_area_ha := Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha] 
data.moose.density [survey_year == 2002, Fire_11_15_area_ha := Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha] 
data.moose.density [survey_year == 2001, Fire_11_15_area_ha := Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha] 
data.moose.density [survey_year == 2000, Fire_11_15_area_ha := Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha]  
data.moose.density [survey_year == 1999, Fire_11_15_area_ha := Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha] 
data.moose.density [survey_year == 1998, Fire_11_15_area_ha := Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha]
data.moose.density [survey_year == 1997, Fire_11_15_area_ha := Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha]
data.moose.density [survey_year == 1996, Fire_11_15_area_ha := Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha]
data.moose.density [survey_year == 1995, Fire_11_15_area_ha := Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha]
data.moose.density [survey_year == 1994, Fire_11_15_area_ha := Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha]

# Fires 16 to 20 years old
data.moose.density [survey_year == 2019, Fire_16_20_area_ha := Fire_2003_area_ha + Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha] 
data.moose.density [survey_year == 2018, Fire_16_20_area_ha := Fire_2002_area_ha + Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha] 
data.moose.density [survey_year == 2017, Fire_16_20_area_ha := Fire_2001_area_ha + Fire_2000_area_ha + Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha] 
data.moose.density [survey_year == 2015, Fire_16_20_area_ha := Fire_1999_area_ha + Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha] 
data.moose.density [survey_year == 2014, Fire_16_20_area_ha := Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha] 
data.moose.density [survey_year == 2013, Fire_16_20_area_ha := Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha] 
data.moose.density [survey_year == 2012, Fire_16_20_area_ha := Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha] 
data.moose.density [survey_year == 2011, Fire_16_20_area_ha := Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha]
data.moose.density [survey_year == 2008, Fire_16_20_area_ha := Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha] 
data.moose.density [survey_year == 2006, Fire_16_20_area_ha := Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha] 
data.moose.density [survey_year == 2005, Fire_16_20_area_ha := Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha] 
data.moose.density [survey_year == 2004, Fire_16_20_area_ha := Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha] 
data.moose.density [survey_year == 2003, Fire_16_20_area_ha := Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha] 
data.moose.density [survey_year == 2002, Fire_16_20_area_ha := Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha] 
data.moose.density [survey_year == 2001, Fire_16_20_area_ha := Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha] 
data.moose.density [survey_year == 2000, Fire_16_20_area_ha := Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha]  
data.moose.density [survey_year == 1999, Fire_16_20_area_ha := Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha] 
data.moose.density [survey_year == 1998, Fire_16_20_area_ha := Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha]
data.moose.density [survey_year == 1997, Fire_16_20_area_ha := Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha]
data.moose.density [survey_year == 1996, Fire_16_20_area_ha := Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha]
data.moose.density [survey_year == 1995, Fire_16_20_area_ha := Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha]
data.moose.density [survey_year == 1994, Fire_16_20_area_ha := Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha]

# Fires 21 to 25 years old
data.moose.density [survey_year == 2019, Fire_21_25_area_ha := Fire_1998_area_ha + Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha] 
data.moose.density [survey_year == 2018, Fire_21_25_area_ha := Fire_1997_area_ha + Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha] 
data.moose.density [survey_year == 2017, Fire_21_25_area_ha := Fire_1996_area_ha + Fire_1995_area_ha + Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha] 
data.moose.density [survey_year == 2015, Fire_21_25_area_ha := Fire_1994_area_ha + Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha] 
data.moose.density [survey_year == 2014, Fire_21_25_area_ha := Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha] 
data.moose.density [survey_year == 2013, Fire_21_25_area_ha := Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha] 
data.moose.density [survey_year == 2012, Fire_21_25_area_ha := Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha] 
data.moose.density [survey_year == 2011, Fire_21_25_area_ha := Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha]
data.moose.density [survey_year == 2008, Fire_21_25_area_ha := Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha] 
data.moose.density [survey_year == 2006, Fire_21_25_area_ha := Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha] 
data.moose.density [survey_year == 2005, Fire_21_25_area_ha := Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha] 
data.moose.density [survey_year == 2004, Fire_21_25_area_ha := Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha] 
data.moose.density [survey_year == 2003, Fire_21_25_area_ha := Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha] 
data.moose.density [survey_year == 2002, Fire_21_25_area_ha := Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha] 
data.moose.density [survey_year == 2001, Fire_21_25_area_ha := Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha] 
data.moose.density [survey_year == 2000, Fire_21_25_area_ha := Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha]  
data.moose.density [survey_year == 1999, Fire_21_25_area_ha := Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha] 
data.moose.density [survey_year == 1998, Fire_21_25_area_ha := Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha]
data.moose.density [survey_year == 1997, Fire_21_25_area_ha := Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha]
data.moose.density [survey_year == 1996, Fire_21_25_area_ha := Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha]
data.moose.density [survey_year == 1995, Fire_21_25_area_ha := Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha + Fire_1970_area_ha]
data.moose.density [survey_year == 1994, Fire_21_25_area_ha := Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha + Fire_1970_area_ha + Fire_1969_area_ha]

# Fires 26 to 30 years old
data.moose.density [survey_year == 2019, Fire_26_30_area_ha := Fire_1993_area_ha + Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha] 
data.moose.density [survey_year == 2018, Fire_26_30_area_ha := Fire_1992_area_ha + Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha] 
data.moose.density [survey_year == 2017, Fire_26_30_area_ha := Fire_1991_area_ha + Fire_1990_area_ha + Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha] 
data.moose.density [survey_year == 2015, Fire_26_30_area_ha := Fire_1989_area_ha + Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha] 
data.moose.density [survey_year == 2014, Fire_26_30_area_ha := Fire_1988_area_ha + Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha]
data.moose.density [survey_year == 2013, Fire_26_30_area_ha := Fire_1987_area_ha + Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha] 
data.moose.density [survey_year == 2012, Fire_26_30_area_ha := Fire_1986_area_ha + Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha] 
data.moose.density [survey_year == 2011, Fire_26_30_area_ha := Fire_1985_area_ha + Fire_1984_area_ha + Fire_1983_area_ha + Fire_1982_area_ha + Fire_1981_area_ha]
data.moose.density [survey_year == 2008, Fire_26_30_area_ha := Fire_1982_area_ha + Fire_1981_area_ha + Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha] 
data.moose.density [survey_year == 2006, Fire_26_30_area_ha := Fire_1980_area_ha + Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha] 
data.moose.density [survey_year == 2005, Fire_26_30_area_ha := Fire_1979_area_ha + Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha] 
data.moose.density [survey_year == 2004, Fire_26_30_area_ha := Fire_1978_area_ha + Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha] 
data.moose.density [survey_year == 2003, Fire_26_30_area_ha := Fire_1977_area_ha + Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha] 
data.moose.density [survey_year == 2002, Fire_26_30_area_ha := Fire_1976_area_ha + Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha] 
data.moose.density [survey_year == 2001, Fire_26_30_area_ha := Fire_1975_area_ha + Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha] 
data.moose.density [survey_year == 2000, Fire_26_30_area_ha := Fire_1974_area_ha + Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha + Fire_1970_area_ha]  
data.moose.density [survey_year == 1999, Fire_26_30_area_ha := Fire_1973_area_ha + Fire_1972_area_ha + Fire_1971_area_ha + Fire_1970_area_ha + Fire_1969_area_ha] 
data.moose.density [survey_year == 1998, Fire_26_30_area_ha := Fire_1972_area_ha + Fire_1971_area_ha + Fire_1970_area_ha + Fire_1969_area_ha + Fire_1968_area_ha]
data.moose.density [survey_year == 1997, Fire_26_30_area_ha := Fire_1971_area_ha + Fire_1970_area_ha + Fire_1969_area_ha + Fire_1968_area_ha + Fire_1967_area_ha]
data.moose.density [survey_year == 1996, Fire_26_30_area_ha := Fire_1970_area_ha + Fire_1969_area_ha + Fire_1968_area_ha + Fire_1967_area_ha + Fire_1966_area_ha]
data.moose.density [survey_year == 1995, Fire_26_30_area_ha := Fire_1969_area_ha + Fire_1968_area_ha + Fire_1967_area_ha + Fire_1966_area_ha + Fire_1965_area_ha]
data.moose.density [survey_year == 1994, Fire_26_30_area_ha := Fire_1968_area_ha + Fire_1967_area_ha + Fire_1966_area_ha + Fire_1965_area_ha + Fire_1964_area_ha]


### AREA OF WETLANDS, LAKES ADN WATERCOURSES BY WMU: 
data.moose.habitat.water <- data.table (data.moose.habitat) [, .(wmu, WATERBODY_TYPE, WATERBODY_TYPE_1, FEATURE_TYPE, area_ha)]
data.moose.habitat.water <-  data.table (data.moose.habitat.water) [wmu != "5-12-A"]

# area of wetland
data.moose.habitat.wetland <- data.moose.habitat.water [WATERBODY_TYPE == "W",
                                                        .(wetland_area_ha = sum (area_ha)), 
                                                        by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.wetland,
                                        by = "wmu")
rm (data.moose.habitat.wetland)
gc ()

# area of lakes
data.moose.habitat.lake <- data.moose.habitat.water [WATERBODY_TYPE_1 == "L",
                                                        .(lake_area_ha = sum (area_ha)), 
                                                        by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.lake,
                                        by = "wmu")
rm (data.moose.habitat.lake)
gc ()

# area of rivers
data.moose.habitat.river <- data.moose.habitat.water [FEATURE_TYPE == "river",
                                                     .(river_area_ha = sum (area_ha)), 
                                                     by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.habitat.river,
                                        by = "wmu")
rm (data.moose.habitat.river, data.moose.habitat.water)
gc ()


data.moose.density <- data.table(data.moose.density) [1:49]




### LENGTH OF ROADS BY WMU ###
data.moose.roads [, road_type := c (paste (FEATURE_TYPE, ROAD_SURFACE, sep="_"))] 
unique (data.moose.roads$road_type)

# Loose roads
data.moose.road.loose <- data.moose.roads [road_type == "Road_loose" ,
                                           .(road_loose_km = sum (length_km)), 
                                           by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.road.loose,
                                        by = "wmu")
rm (data.moose.road.loose)
gc ()

# Paved roads
data.moose.road.paved <- data.moose.roads [road_type == "Road_paved" ,
                                           .(road_paved_km = sum (length_km)), 
                                           by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.road.paved,
                                        by = "wmu")
rm (data.moose.road.paved)
gc ()

# Rough roads
data.moose.road.rough <- data.moose.roads [road_type == "Road_rough" ,
                                           .(road_rough_km = sum (length_km)), 
                                           by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.road.rough,
                                        by = "wmu")
rm (data.moose.road.rough)
gc ()

# Overgrown roads
data.moose.road.over <- data.moose.roads [road_type == "Road_overgrown" ,
                                           .(road_overgrown_km = sum (length_km)), 
                                           by = .(wmu)] 
data.moose.density <- dplyr::full_join (data.moose.density, data.moose.road.over,
                                        by = "wmu")
rm (data.moose.road.over)
gc ()

data.moose.density [is.na (data.moose.density)] <- 0

```





### Spearman correlation between covariates  
  
```{r, correlation}
require (ggcorrplot)

# Elevation and water
corr.elev <- data.moose.density [, c(4:8, 318:320)]
corr.elev <- round (cor (corr.elev, method = "spearman"), 3)
ggcorrplot (corr.elev, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Elevation Covariate Correlation")
rm (corr.elev)
gc ()
# keep mean and sdev

# Mean Annual Temp
corr.mat <- data.moose.density [, c(9:17)]
corr.mat <- round (cor (corr.mat, method = "spearman"), 3)
ggcorrplot (corr.mat, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Mean Annual Temp Covariate Correlation")
rm (corr.mat)
gc ()
# keep mean and sdev

# Annual Precipitation as Snow
corr.pas <- data.moose.density [, c(18:26)]
corr.pas <- round (cor (corr.pas, method = "spearman"), 3)
ggcorrplot (corr.pas, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Annual Precipitation as Snow Covariate Correlation")
rm (corr.pas)
gc ()
# keep mean 

# Winter Precipitation as Snow
corr.pas <- data.moose.density [, c(27:35)]
corr.pas <- round (cor (corr.pas, method = "spearman"), 3)
ggcorrplot (corr.pas, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Winter Precipitation as Snow Covariate Correlation")
rm (corr.pas)
gc ()
# keep mean 

# Summer Precipitation
corr.ppt <- data.moose.density [, c(36:44)]
corr.ppt <- round (cor (corr.ppt, method = "spearman"), 3)
ggcorrplot (corr.ppt, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Summer Precipitation Correlation")
rm (corr.ppt)
gc ()
# keep mean and sdev

# Summer Average Temperature
corr.st <- data.moose.density [, c(45:53)]
corr.st <- round (cor (corr.st, method = "spearman"), 3)
ggcorrplot (corr.st, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Summer Mean Temperature Correlation")
rm (corr.st)
gc ()
# keep mean and sdev

# Winter Average Temperature
corr.wt <- data.moose.density [, c(54:62)]
corr.wt <- round (cor (corr.wt, method = "spearman"), 3)
ggcorrplot (corr.wt, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Winter Mean Temperature Correlation")
rm (corr.wt)
gc ()
# keep mean and sdev

# Landcover
corr.lc <- data.moose.density [, c(63:76)]
corr.lc <- round (cor (corr.lc, method = "spearman"), 3)
ggcorrplot (corr.lc, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Landcover Type Area Correlation")
rm (corr.wt)
gc ()
# keep N_W_area_ha, N_L_area_ha, V_NT_A_ST_area_ha, V_NT_A_SL_area_ha, V_NT_U_ST_area_ha, V_NT_W_SL_area_ha, V_T_W_TC_area_ha, V_T_W_TB_area_ha, V_T_W_TM_area_ha, V_T_U_TC_area_ha, V_T_U_TB_area_ha

# BEC1
corr.bec1 <- data.moose.density [, c(77:88)]
corr.bec1 <- round (cor (corr.bec1, method = "spearman"), 3)
ggcorrplot (corr.bec1, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "BEC Area Correlation")
rm (corr.bec1)
gc ()

# BEC2
corr.bec2 <- data.moose.density [, c(89:100)]
corr.bec2 <- round (cor (corr.bec2, method = "spearman"), 3)
ggcorrplot (corr.bec2, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "BEC Area Correlation")
rm (corr.bec2)
gc ()

# BEC3
corr.bec3 <- data.moose.density [, c(77, 80, 82:83, 85:87, 89:96, 98:100)]
corr.bec3 <- round (cor (corr.bec3, method = "spearman"), 3)
ggcorrplot (corr.bec3, type = "lower", lab = TRUE, tl.cex = 8,  lab_size = 2,
            title = "BEC Area Correlation")
rm (corr.bec3)
gc ()
# drop CWH, BG, MSdry,  ESSFverydryverycold,  ESSFwk1, ESSFmoistmildwarm, MSverydry

# Forest characteristics
corr.forest <- data.moose.density [, c(101:116)]
corr.forest <- round (cor (corr.forest, method = "spearman"), 3)
ggcorrplot (corr.forest, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Forest Characteristics Correlation")
rm (corr.forest)
gc ()
# keep shrub area, mean site index, sdev site index, age mean, age sdev

# Cut and Fire
corr.cut.fire <- data.moose.density [, c(306:317)]
corr.cut.fire <- data.frame (corr.cut.fire [!50])
corr.cut.fire <- round (cor (corr.cut.fire, method = "spearman"), 3)
ggcorrplot (corr.cut.fire, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Cutblock and Fire Age Correlation")
rm (corr.cut.fire)
gc ()

# Leading tree species
corr.tree <- data.moose.density [, c(117:126)]
corr.tree <- round (cor (corr.tree, method = "spearman"), 3)
ggcorrplot (corr.tree, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Leading Tree Species Area Correlation")
rm (corr.tree)
gc ()

# Elevation and Climate 
corr.elev.clim <- data.moose.density [, c(7:8, 12:13, 21:22, 30:31, 39:40, 48:49, 57:58)]
corr.elev.clim <- round (cor (corr.elev.clim, method = "spearman"), 3)
ggcorrplot (corr.elev.clim, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Elevation and Climate Covariate Correlation")
rm (corr.elev)
gc ()
# keep only mat_mean and pas_ann_mean

# Roads 
corr.roads <- data.moose.density [, c(326:329)]
corr.roads <- round (cor (corr.roads, method = "spearman"), 3)
ggcorrplot (corr.roads, type = "lower", lab = TRUE, tl.cex = 10,  lab_size = 3,
            title = "Road Covariate Correlation")
rm (corr.roads)
gc ()
# keep all

# Roads,. elevation, cublocks 
corr.roads <- data.moose.density [, c(4:8, 318:320, 306:317, 326:329)]
corr.roads <- round (cor (corr.roads, method = "spearman"), 3)
ggcorrplot (corr.roads, type = "lower", lab = TRUE, tl.cex = 8,  lab_size = 2,
            title = "Road Covariate Correlation")
rm (corr.roads)
gc ()
# paved roads correalted with elevation


#### subset the data
data.moose.density [, ICHwetmoist_area_ha := ICHmoist_area_ha + ICHwetcool_area_ha]
data.moose.density [, IDFdryverydry_area_ha := IDFdry_area_ha + IDFverydry_area_ha]
# combined some types that were correlated

# combine cutblocks age 11-20 and 21-30
data.moose.density [, Cut_11_20_area_ha := Cut_11_15_area_ha + Cut_16_20_area_ha]
data.moose.density [, Cut_21_30_area_ha := Cut_21_25_area_ha + Cut_26_30_area_ha]

# combine cedar and hemlock
data.moose.density [, Cedar_Hemlock_area_ha := Cedar_area_ha + Hemlock_area_ha]
data.moose.density <- data.table (data.moose.density)
data.lme <- data.moose.density [, .(adj_density_est_km2, wmu, survey_year,
                                    mat_mean, pas_ann_mean, 
                                    wetland_area_ha, lake_area_ha, river_area_ha,
                                    N_W_area_ha, N_L_area_ha, V_NT_A_ST_area_ha, V_NT_A_SL_area_ha,
                                    V_NT_U_ST_area_ha, V_NT_W_SL_area_ha, V_T_W_TC_area_ha, 
                                    V_T_W_TB_area_ha,
                                    V_T_W_TM_area_ha, V_T_U_TC_area_ha, V_T_U_TB_area_ha,
                                    Alpine_area_ha, ICHdry_area_ha,
                                    IDFmoistwet_area_ha, 
                                    MHmm2_area_ha, 
                                    SBSdry_area_ha, SBSmoistcold_area_ha, SBSmoistmildhot_area_ha, 
                                    SBSwk1_area_ha, SBPSdryverydrycold_area_ha, 
                                    SBPSmoistcoolcold_area_ha, 
                                    ESSFmoistcoldverycold_area_ha, ESSFverydrycold_area_ha, 
                                    ESSFdvw_area_ha, 
                                    ICHwetmoist_area_ha, IDFdryverydry_area_ha,
                                    shrub_area_ha, site_index_mean, site_index_sd, age_mean, age_sd,
                                    Cut_1_5_area_ha, Cut_6_10_area_ha, Cut_11_20_area_ha, 
                                    Cut_21_30_area_ha,
                                    Fire_1_5_area_ha, Fire_6_10_area_ha, Fire_11_15_area_ha, 
                                    Fire_16_20_area_ha, Fire_21_25_area_ha, Fire_26_30_area_ha,
                                    Fir_area_ha, Populus_area_ha, Birch_area_ha, DougFir_area_ha, 
                                    Larch_area_ha, Pine_area_ha, Spruce_area_ha, 
                                    Cedar_Hemlock_area_ha,
                                    road_loose_km, road_paved_km, road_rough_km, 
                                    road_overgrown_km
                                 )]
```
  
  
  
  
### Outliers....

```{r, outliers}

# Cleveland dotcharts
dotchart (data.lme$adj_density_est_km2) # two potential outliers - surveys of 5-02-B and 5-02-D in 1994
dotchart (data.lme$mat_mean)
dotchart (data.lme$pas_ann_mean) # wmu 5-06 a bit of an outlier; only surveyed once, very high snowfall area
dotchart (data.lme$wetland_area_ha)
dotchart (data.lme$lake_area_ha)
dotchart (data.lme$river_area_ha) # wmu 5-02D has double river area than other units
dotchart (data.lme$N_W_area_ha)
dotchart (data.lme$N_L_area_ha) # problematic; lots of zeros
dotchart (data.lme$V_NT_A_ST_area_ha) # problematic; lots of zeros
dotchart (data.lme$V_NT_A_SL_area_ha) # could be problematic; a fair amount of zeros
dotchart (data.lme$V_NT_U_ST_area_ha)
dotchart (data.lme$V_NT_W_SL_area_ha)
dotchart (data.lme$V_T_W_TC_area_ha) # 5-10 a bit of an outlier
dotchart (data.lme$V_T_W_TB_area_ha) # problematic; lots of zeros and 5-02C are outliers
dotchart (data.lme$V_T_W_TM_area_ha)
dotchart (data.lme$V_T_U_TC_area_ha) # 5-04 had a lot more upland conifer
dotchart (data.lme$V_T_U_TB_area_ha) # 5-02D had a lot more broadleaf
dotchart (data.lme$Alpine_area_ha) # problematic; lots of zeros
dotchart (data.lme$ICHdry_area_ha) # problematic; lots of zeros
dotchart (data.lme$IDFmoistwet_area_ha) # problematic; lots of zeros
dotchart (data.lme$MHmm2_area_ha) # problematic; lots of zeros
dotchart (data.lme$SBSdry_area_ha) 
dotchart (data.lme$SBSmoistcold_area_ha) 
dotchart (data.lme$SBSmoistmildhot_area_ha) # 5-02D had a lot more of this
dotchart (data.lme$SBSwk1_area_ha) # problematic; lots of zeros
dotchart (data.lme$SBPSdryverydrycold_area_ha)
dotchart (data.lme$SBPSmoistcoolcold_area_ha)
dotchart (data.lme$ESSFmoistcoldverycold_area_ha) # problematic; lots of zeros
dotchart (data.lme$ESSFverydrycold_area_ha) # problematic; lots of zeros
dotchart (data.lme$ESSFdvw_area_ha) # problematic; lots of zeros
dotchart (data.lme$ICHwetmoist_area_ha) # a few zero's.....
dotchart (data.lme$IDFdryverydry_area_ha)
dotchart (data.lme$shrub_area_ha) # 5-13C had significantly more shrubs
dotchart (data.lme$site_index_mean)
dotchart (data.lme$site_index_sd)
dotchart (data.lme$age_mean)
dotchart (data.lme$age_sd)
dotchart (data.lme$Cut_1_5_area_ha)
dotchart (data.lme$Cut_6_10_area_ha)
dotchart (data.lme$Cut_11_20_area_ha)
dotchart (data.lme$Cut_21_30_area_ha)
dotchart (data.lme$Fire_1_5_area_ha)
dotchart (data.lme$Fire_6_10_area_ha)
dotchart (data.lme$Fire_11_15_area_ha)
dotchart (data.lme$Fire_16_20_area_ha)
dotchart (data.lme$Fire_21_25_area_ha)
dotchart (data.lme$Fire_26_30_area_ha)
dotchart (data.lme$Fir_area_ha)
dotchart (data.lme$Populus_area_ha)
dotchart (data.lme$Birch_area_ha) # a few zero's.....
dotchart (data.lme$DougFir_area_ha)
dotchart (data.lme$Larch_area_ha) # problematic; lots of zeros
dotchart (data.lme$Pine_area_ha)
dotchart (data.lme$Spruce_area_ha)
dotchart (data.lme$Cedar_Hemlock_area_ha) # a few zero's.....
dotchart (data.lme$road_loose_km)                          
dotchart (data.lme$road_paved_km)                          
dotchart (data.lme$road_overgrown_km)    # lots of zero's                      
dotchart (data.lme$road_rough_km)                          

# thinking about dropping the landcover covairates - most are problematic
# drop bec covariates; soem problematic, correalted with cliamte anyway



# start with:
# mat_mean, pas_ann_mean, wetland_area_ha, lake_area_ha, river_area_ha, shrub_area_ha,
# site_index_mean, site_index_sd, age_mean, age_sd, Cut_1_5_area_ha, Cut_6_10_area_ha,
# Cut_11_20_area_ha, Cut_21_30_area_ha, Fire_1_5_area_ha, Fire_6_10_area_ha, Fire_11_15_area_ha,
# Fire_16_20_area_ha, Fire_21_25_area_ha, Fire_26_30_area_ha, Populus_area_ha, Pine_area_ha, 
# Spruce_area_ha, DougFir_area_ha, road_loose_km, road_paved_km, road_rough_km

# 5-06 and 5-02D appear to be 'outlier' units; 5-06 high elevation and snowy; 5-02D lots of broadleaf, riparian, hot; keep for now

```


              
### CHeck VIFs for correlation 
          
```{r, simple GLM model, with VIF}
glm.moose.density <- glm (adj_density_est_km2 ~ mat_mean + pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + shrub_area_ha +
                                                site_index_mean + site_index_sd + age_mean + 
                                                age_sd + Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + Pine_area_ha + Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
summary (glm.moose.density)
car::vif (glm.moose.density) # many covaraites iwth VIF >10; removed highest first iteratively until all <10

glm.moose.density <- glm (adj_density_est_km2 ~ mat_mean + 
                                                pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + 
                                                # shrub_area_ha +
                                                site_index_mean + site_index_sd + age_mean + 
                                                age_sd + Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + Pine_area_ha + Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
car::vif (glm.moose.density)

glm.moose.density <- glm (adj_density_est_km2 ~ # mat_mean + 
                                                pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + 
                                                # shrub_area_ha +
                                                site_index_mean + site_index_sd + age_mean + 
                                                age_sd + 
                                                Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + Pine_area_ha + Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
car::vif (glm.moose.density)

glm.moose.density <- glm (adj_density_est_km2 ~ # mat_mean + 
                                                pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + 
                                                # shrub_area_ha +
                                                # site_index_mean + 
                                                site_index_sd + age_mean + 
                                                age_sd + 
                                                Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + Pine_area_ha + Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
car::vif (glm.moose.density)

glm.moose.density <- glm (adj_density_est_km2 ~ # mat_mean + 
                                                pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + 
                                                # shrub_area_ha +
                                                # site_index_mean + 
                                                site_index_sd + 
                                                # age_mean + 
                                                # age_sd + 
                                                Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + 
                                                Pine_area_ha + 
                                                Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
car::vif (glm.moose.density)

glm.moose.density <- glm (adj_density_est_km2 ~ # mat_mean + 
                                                pas_ann_mean + wetland_area_ha + 
                                                lake_area_ha + river_area_ha + 
                                                # shrub_area_ha +
                                                # site_index_mean + 
                                                site_index_sd + 
                                                # age_mean + 
                                                # age_sd + 
                                                Cut_1_5_area_ha + Cut_6_10_area_ha +
                                                Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                Populus_area_ha + 
                                                # Pine_area_ha + 
                                                Spruce_area_ha +
                                                DougFir_area_ha + road_loose_km +road_paved_km +
                                                road_rough_km, 
                            data = data.lme,
                            family = gaussian (link = 'identity'))
car::vif (glm.moose.density) # this model is ok

```
          

### Check Model Fit: Heterogeneity, Normailty and Independence of Residuals 

```{r, random effects model; check for heterogeneity, normality and independence fo residuals }
require (lme4)
require (ggplot2)
require (lattice)

# Fit the LME model
lme.moose.density <- glmer (adj_density_est_km2 ~ pas_ann_mean + wetland_area_ha + 
                                                 lake_area_ha + river_area_ha + 
                                                 site_index_sd + Cut_1_5_area_ha + 
                                                 Cut_6_10_area_ha + Cut_11_20_area_ha + 
                                                 Cut_21_30_area_ha +
                                                 Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                 Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                 Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                 Populus_area_ha + Spruce_area_ha +
                                                 DougFir_area_ha + road_loose_km +road_paved_km +
                                                 road_rough_km +
                                                 (1 | wmu), 
                            data = data.lme,
                            family = gaussian (link = 'identity'),
                            verbose = T)
summary (lme.moose.density)

data.lme$lme.predicted <- predict (lme.moose.density)   # Save the predicted values
data.lme$lme.residuals <- residuals (lme.moose.density) # Save the residual values

ggplot (data.lme, aes (x = lme.predicted, y = adj_density_est_km2)) + # predicted vs. actual values
        geom_point() +
        scale_x_continuous (breaks = seq(0, 1.6, 0.2)) +
        scale_y_continuous (breaks = seq(0, 1.6, 0.2)) +
        geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # 5-02B in 1994 is an outlier; removed this data point from analysis

data.lme.final <- data.lme [!12]

lme.moose.density <- glmer (adj_density_est_km2 ~ pas_ann_mean + wetland_area_ha + 
                                                 lake_area_ha + river_area_ha + 
                                                 site_index_sd + Cut_1_5_area_ha + 
                                                 Cut_6_10_area_ha + Cut_11_20_area_ha + 
                                                 Cut_21_30_area_ha +
                                                 Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                 Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                 Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                 Populus_area_ha + Spruce_area_ha +
                                                 DougFir_area_ha + road_loose_km +road_paved_km +
                                                 road_rough_km +
                                                 (1 | wmu), 
                            data = data.lme.final,
                            family = gaussian (link = 'identity'),
                            verbose = T)
summary (lme.moose.density)

data.lme.final$lme.predicted <- predict (lme.moose.density)   # Save the predicted values
data.lme.final$lme.residuals <- residuals (lme.moose.density) # Save the residual values

ggplot (data.lme.final, aes (x = lme.predicted, y = adj_density_est_km2)) + # predicted vs. actual values
        geom_point() +
        scale_x_continuous (breaks = seq(0, 1.6, 0.2)) +
        scale_y_continuous (breaks = seq(0, 1.6, 0.2)) +
        geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3)

ggplot (data.lme.final, aes (x = lme.predicted, y = lme.residuals)) + # fitted vs. residual values
        geom_point () +
        geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 1, vjust = 0, 
                   check_overlap = T,
                   size = 3) # these look ok; few obs at high predicted densities, but residuals are
                             # not overly large there

ggplot (data.lme.final, aes(lme.residuals)) + # normality of residuals
        geom_histogram (binwidth = 0.05) # there is some skewness here, but not terrible

qqnorm (residuals (lme.moose.density)) # some deviation, but this seems ok too
qqline (residuals (lme.moose.density)) 

# compare fit to x variables
ggplot (data.lme.final, aes(x = pas_ann_mean, y = adj_density_est_km2)) + # ppt. as snow
  geom_segment (aes (xend = pas_ann_mean, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # WMU 5-02-D 1994 likely high leverage, but model fits it

ggplot (data.lme.final, aes(x = wetland_area_ha, y = adj_density_est_km2)) + # wetland_area_ha
  geom_segment (aes (xend = wetland_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # wetlands have a weak effect, remove from model?

ggplot (data.lme.final, aes(x = lake_area_ha, y = adj_density_est_km2)) + # lake_area_ha 
  geom_segment (aes (xend = lake_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # lakes have a weak effect, remove from model?

ggplot (data.lme.final, aes(x = river_area_ha, y = adj_density_est_km2)) + # river_area_ha  
  geom_segment (aes (xend = river_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # really driven by wmu 5-02-D; is this a real effect?

ggplot (data.lme.final, aes(x = shrub_area_ha, y = adj_density_est_km2)) + # shrub_area_ha  
  geom_segment (aes (xend = shrub_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = site_index_sd, y = adj_density_est_km2)) + # site_index_sd  
  geom_segment (aes (xend = site_index_sd, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # weak effect.....

ggplot (data.lme.final, aes(x = Cut_1_5_area_ha, y = adj_density_est_km2)) + # Cut_1_5_area_ha  
  geom_segment (aes (xend = Cut_1_5_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # wmu 5-02-D could be driving this a bit; combine with cut 6 to 10

ggplot (data.lme.final, aes(x = Cut_6_10_area_ha, y = adj_density_est_km2)) + # Cut_6_10_area_ha  
  geom_segment (aes (xend = Cut_6_10_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm)

ggplot (data.lme.final, aes(x = Cut_11_20_area_ha, y = adj_density_est_km2)) + # Cut_11_20_area_ha  
  geom_segment (aes (xend = Cut_11_20_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm)

ggplot (data.lme.final, aes(x = Cut_21_30_area_ha, y = adj_density_est_km2)) + # Cut_21_30_area_ha  
  geom_segment (aes (xend = Cut_21_30_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm)

ggplot (data.lme.final, aes(x = Fire_1_5_area_ha, y = adj_density_est_km2)) + # Fire_1_5_area_ha  
  geom_segment (aes (xend = Fire_1_5_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # lot of zeros, although doesn't appear to be a huge problem with residuals (above)

ggplot (data.lme.final, aes(x = Fire_6_10_area_ha, y = adj_density_est_km2)) + # Fire_6_10_area_ha  
  geom_segment (aes (xend = Fire_6_10_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) #l ot of zeros, although doesn't appear to be a huge problem with residuals (above)

ggplot (data.lme.final, aes(x = Fire_11_15_area_ha, y = adj_density_est_km2)) + # Fire_11_15_area_ha  
  geom_segment (aes (xend = Fire_11_15_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # lot of zeros, although doesn't appear to be a huge problem with residuals (above)

ggplot (data.lme.final, aes(x = Fire_16_20_area_ha, y = adj_density_est_km2)) + # Fire_16_20_area_ha  
  geom_segment (aes (xend = Fire_16_20_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_21_25_area_ha, y = adj_density_est_km2)) + # Fire_21_25_area_ha  
  geom_segment (aes (xend = Fire_21_25_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_26_30_area_ha, y = adj_density_est_km2)) + # Fire_26_30_area_ha  
  geom_segment (aes (xend = Fire_26_30_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Populus_area_ha, y = adj_density_est_km2)) + # Populus_area_ha  
  geom_segment (aes (xend = Populus_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # nice fit here

ggplot (data.lme.final, aes(x = Spruce_area_ha, y = adj_density_est_km2)) + # Spruce_area_ha  
  geom_segment (aes (xend = Spruce_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = DougFir_area_ha, y = adj_density_est_km2)) + # DougFir_area_ha  
  geom_segment (aes (xend = DougFir_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # weak effect

# compare residuals to x variables
ggplot (data.lme.final, aes(x = pas_ann_mean, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = wetland_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = lake_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = river_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = shrub_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = site_index_sd, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = Cut_1_5_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = Cut_6_10_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = Cut_11_20_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3)  # higher deviation at lower cut area

ggplot (data.lme.final, aes(x = Cut_21_30_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # higher deviation at lower cut area

ggplot (data.lme.final, aes(x = Fire_1_5_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # high deviation around low burnt area

ggplot (data.lme.final, aes(x = Fire_6_10_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # high deviation around low burnt area

ggplot (data.lme.final, aes(x = Fire_11_15_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # high deviation around low burnt area

ggplot (data.lme.final, aes(x = Fire_16_20_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # high deviation around low burnt area

ggplot (data.lme.final, aes(x = Fire_21_25_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = Fire_26_30_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks fine

ggplot (data.lme.final, aes(x = Populus_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

ggplot (data.lme.final, aes(x = Spruce_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

ggplot (data.lme.final, aes(x = DougFir_area_ha, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

ggplot (data.lme.final, aes(x = road_loose_km, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

ggplot (data.lme.final, aes(x = road_paved_km, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

ggplot (data.lme.final, aes(x = road_rough_km, y = lme.residuals)) +
  geom_point () +
  geom_point (aes (y = lme.residuals), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) # looks good

```



### Model Selection based on R-squared and AIC weights
The top-ranked model had an AIC weight (AIC~w~) of 0.486, and included covariates for area of *Populus* spp., area of rivers, area of wetlands, length of roads area burnt and area cut, and had an *R^2^* value of 0.798 (Table xx). The second ranked-model (AIC~w~ = 0.239; *R^2^* = 0.800) included these same covariates and area of lakes. All other models had an AIC~w~ < 0.09.


```{r, model selection}
require (lme4)
require (MuMIn)
require (cAIC4)

### Compare models using AIC and R-sq ###
table.model.compare <- data.frame (matrix (ncol = 4, nrow = 0))
colnames (table.model.compare) <- c ("Fixed Effects Covariates", "R-squared", "AICc", "AICcw")

## GLOBAL MODEL ##
lme.moose.density.global <- glmer (adj_density_est_km2 ~ pas_ann_mean + wetland_area_ha + 
                                                         lake_area_ha + river_area_ha + 
                                                         site_index_sd + Cut_1_5_area_ha + 
                                                         Cut_6_10_area_ha + Cut_11_20_area_ha + 
                                                         Cut_21_30_area_ha +
                                                         Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                         Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                         Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                         Populus_area_ha + Spruce_area_ha +
                                                         DougFir_area_ha + road_loose_km + 
                                                         road_paved_km +
                                                         road_rough_km +
                                                       (1 | wmu), 
                                  data = data.lme.final,
                                  family = gaussian (link = 'identity'),
                                  REML = FALSE,
                                  verbose = T)
table.model.compare [1, 1] <- "Mean Ppt as Snow, Wetland Area, Lake Area, River Area, S.Dev.Site Index, Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old,  Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., Area Spruce Spp., Area Douglas Fir, Loose Roads, Paved Roads, Rough Roads"
table.model.compare [1, 2] <- r.squaredGLMM (lme.moose.density.global)
table.model.compare [1, 3] <- cAIC (lme.moose.density.global)$caic

## Snow ##
lme.moose.density.snow <- glmer (adj_density_est_km2 ~ pas_ann_mean +
                                                       (1 | wmu), 
                                  data = data.lme.final,
                                  family = gaussian (link = 'identity'),
                                  REML = FALSE,
                                 verbose = T)
table.model.compare [2, 1] <- "Mean Ppt as Snow"
table.model.compare [2, 2] <- r.squaredGLMM (lme.moose.density.snow)
table.model.compare [2, 3] <-  cAIC (lme.moose.density.snow)$caic

## Wetlands ##
lme.moose.density.wetland <- glmer (adj_density_est_km2 ~ wetland_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [3, 1] <- "Wetland Area"
table.model.compare [3, 2] <- r.squaredGLMM (lme.moose.density.wetland)
table.model.compare [3, 3] <-  cAIC (lme.moose.density.wetland)$caic

## Lakes ##
lme.moose.density.lake <- glmer (adj_density_est_km2 ~ lake_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [4, 1] <- "Lake Area"
table.model.compare [4, 2] <- r.squaredGLMM (lme.moose.density.lake)
table.model.compare [4, 3] <-  cAIC (lme.moose.density.lake)$caic

## Rivers ##
lme.moose.density.river <- glmer (adj_density_est_km2 ~ river_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [5, 1] <- "River Area"
table.model.compare [5, 2] <- r.squaredGLMM (lme.moose.density.river)
table.model.compare [5, 3] <-  cAIC (lme.moose.density.river)$caic

## Roads ##
lme.moose.density.roads <- glmer (adj_density_est_km2 ~  road_loose_km + 
                                                         road_paved_km +
                                                         road_rough_km +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [6, 1] <- "Loose Roads, Paved Roads, Rough Roads"
table.model.compare [6, 2] <- r.squaredGLMM (lme.moose.density.roads)
table.model.compare [6, 3] <-  cAIC (lme.moose.density.roads)$caic

## Site Index ##
lme.moose.density.si <- glmer (adj_density_est_km2 ~ site_index_sd +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [7, 1] <- "S.Dev.Site Index"
table.model.compare [7, 2] <- r.squaredGLMM (lme.moose.density.si)
table.model.compare [7, 3] <-  cAIC (lme.moose.density.si)$caic

## Area Cut ##
lme.moose.density.cut <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + Cut_6_10_area_ha + 
                                                      Cut_11_20_area_ha + Cut_21_30_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [8, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old,  
Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old"
table.model.compare [8, 2] <- r.squaredGLMM (lme.moose.density.cut)
table.model.compare [8, 3] <-  cAIC (lme.moose.density.cut)$caic

## Area Burned ##
lme.moose.density.fire <- glmer (adj_density_est_km2 ~ Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                      Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                      Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [9, 1] <- "Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, 
Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old"
table.model.compare [9, 2] <- r.squaredGLMM (lme.moose.density.fire)
table.model.compare [9, 3] <-  cAIC (lme.moose.density.fire)$caic

## Poplar spp. ##
lme.moose.density.poplar <- glmer (adj_density_est_km2 ~ Populus_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [10, 1] <- "Area Populus Spp."
table.model.compare [10, 2] <- r.squaredGLMM (lme.moose.density.poplar)
table.model.compare [10, 3] <-  cAIC (lme.moose.density.poplar)$caic

## Spruce spp. ##
lme.moose.density.spruce <- glmer (adj_density_est_km2 ~ Spruce_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [11, 1] <- "Area Spruce Spp."
table.model.compare [11, 2] <- r.squaredGLMM (lme.moose.density.spruce)
table.model.compare [11, 3] <-  cAIC (lme.moose.density.spruce)$caic

## Douglas Fir spp. ##
lme.moose.density.fir <- glmer (adj_density_est_km2 ~ DougFir_area_ha +
                                                       (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [11, 1] <- "Area Douglas Fir"
table.model.compare [11, 2] <- r.squaredGLMM (lme.moose.density.fir)
table.model.compare [11, 3] <-  cAIC (lme.moose.density.fir)$caic


### COMBINED LOWEST AIC MODELS SEQUNTIALLY ####
## Area Burned and Area Cut ##
lme.moose.density.cut.burn <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                           Cut_6_10_area_ha + Cut_11_20_area_ha + 
                                                           Cut_21_30_area_ha +
                                                           Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                           Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                           Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                           (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [12, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old"
table.model.compare [12, 2] <- r.squaredGLMM (lme.moose.density.cut.burn)
table.model.compare [12, 3] <-  cAIC (lme.moose.density.cut.burn)$caic

## Area Burned and Area Cut and Area Poplar ##
lme.moose.density.cut.burn.poplar <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                           Cut_6_10_area_ha + Cut_11_20_area_ha + 
                                                           Cut_21_30_area_ha +
                                                           Fire_1_5_area_ha + Fire_6_10_area_ha +
                                                           Fire_11_15_area_ha + Fire_16_20_area_ha +
                                                           Fire_21_25_area_ha + Fire_26_30_area_ha +
                                                           Populus_area_ha + 
                                                           (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [13, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp."
table.model.compare [13, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar)
table.model.compare [13, 3] <-  cAIC (lme.moose.density.cut.burn.poplar)$caic

## Area Burned and Area Cut and Area Poplar and AREA RIVER ##
lme.moose.density.cut.burn.poplar.riv <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                               Cut_6_10_area_ha + 
                                                               Cut_11_20_area_ha + 
                                                               Cut_21_30_area_ha +
                                                               Fire_1_5_area_ha + 
                                                               Fire_6_10_area_ha +
                                                               Fire_11_15_area_ha + 
                                                               Fire_16_20_area_ha +
                                                               Fire_21_25_area_ha + 
                                                               Fire_26_30_area_ha +
                                                               Populus_area_ha +
                                                               river_area_ha +
                                                               (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [14, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area"
table.model.compare [14, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv)
table.model.compare [14, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv)$caic

## Area Burned, Cut, Poplar, RIVER, wetland ##
lme.moose.density.cut.burn.poplar.riv.wet <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                               Cut_6_10_area_ha + 
                                                               Cut_11_20_area_ha + 
                                                               Cut_21_30_area_ha +
                                                               Fire_1_5_area_ha + 
                                                               Fire_6_10_area_ha +
                                                               Fire_11_15_area_ha + 
                                                               Fire_16_20_area_ha +
                                                               Fire_21_25_area_ha + 
                                                               Fire_26_30_area_ha +
                                                               Populus_area_ha +
                                                               river_area_ha +
                                                               wetland_area_ha +
                                                               (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [15, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area, Wetland Area"
table.model.compare [15, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv.wet)
table.model.compare [15, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv.wet)$caic

## Area Burned, Cut, Poplar, RIVER, wetland, Fir ##
lme.moose.density.cut.burn.poplar.riv.wet.fir <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                               Cut_6_10_area_ha + 
                                                               Cut_11_20_area_ha + 
                                                               Cut_21_30_area_ha +
                                                               Fire_1_5_area_ha + 
                                                               Fire_6_10_area_ha +
                                                               Fire_11_15_area_ha + 
                                                               Fire_16_20_area_ha +
                                                               Fire_21_25_area_ha + 
                                                               Fire_26_30_area_ha +
                                                               Populus_area_ha +
                                                               river_area_ha +
                                                               wetland_area_ha +
                                                               DougFir_area_ha +
                                                              (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)

table.model.compare [16, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area, Wetland Area, Area Douglas Fir"
table.model.compare [16, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv.wet.fir)
table.model.compare [16, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv.wet.fir)$caic

## Area Burned, Cut, Poplar, RIVER, wetland, Fir, Roads ##
lme.moose.density.cut.burn.poplar.riv.wet.fir.rds <- glmer (adj_density_est_km2 ~ Cut_1_5_area_ha + 
                                                               Cut_6_10_area_ha + 
                                                               Cut_11_20_area_ha + 
                                                               Cut_21_30_area_ha +
                                                               Fire_1_5_area_ha + 
                                                               Fire_6_10_area_ha +
                                                               Fire_11_15_area_ha + 
                                                               Fire_16_20_area_ha +
                                                               Fire_21_25_area_ha + 
                                                               Fire_26_30_area_ha +
                                                               Populus_area_ha +
                                                               river_area_ha +
                                                               wetland_area_ha +
                                                               DougFir_area_ha +
                                                               road_loose_km + 
                                                               road_paved_km +
                                                               road_rough_km +
                                                               (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)

table.model.compare [17, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area, Wetland Area, Area Douglas Fir, Loose Roads, Paved Roads, Rough Roads"
table.model.compare [17, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds)
table.model.compare [17, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds)$caic

## Area Burned, Cut, Poplar, RIVER, wetland, Fir, Roads, Lake ##
lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk <- glmer (adj_density_est_km2 ~ 
                                                                 Cut_1_5_area_ha + 
                                                                 Cut_6_10_area_ha + 
                                                                 Cut_11_20_area_ha + 
                                                                 Cut_21_30_area_ha +
                                                                 Fire_1_5_area_ha + 
                                                                 Fire_6_10_area_ha +
                                                                 Fire_11_15_area_ha + 
                                                                 Fire_16_20_area_ha +
                                                                 Fire_21_25_area_ha + 
                                                                 Fire_26_30_area_ha +
                                                                 Populus_area_ha +
                                                                 river_area_ha +
                                                                 wetland_area_ha +
                                                                 DougFir_area_ha +
                                                                 road_loose_km + 
                                                                 road_paved_km +
                                                                 road_rough_km +
                                                                 lake_area_ha +
                                                                  (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)

table.model.compare [18, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area, Wetland Area, Area Douglas Fir, Loose Roads, Paved Roads, Rough Roads, Lake Area"
table.model.compare [18, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk)
table.model.compare [18, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk)$caic

## Area Burned, Cut, Poplar, RIVER, wetland, Fir, Roads, Lake, PPt as Snow ##
lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk.pas <- glmer (adj_density_est_km2 ~ 
                                                                 Cut_1_5_area_ha + 
                                                                 Cut_6_10_area_ha + 
                                                                 Cut_11_20_area_ha + 
                                                                 Cut_21_30_area_ha +
                                                                 Fire_1_5_area_ha + 
                                                                 Fire_6_10_area_ha +
                                                                 Fire_11_15_area_ha + 
                                                                 Fire_16_20_area_ha +
                                                                 Fire_21_25_area_ha + 
                                                                 Fire_26_30_area_ha +
                                                                 Populus_area_ha +
                                                                 river_area_ha +
                                                                 wetland_area_ha +
                                                                 DougFir_area_ha +
                                                                 road_loose_km + 
                                                                 road_paved_km +
                                                                 road_rough_km +
                                                                 lake_area_ha +
                                                                 pas_ann_mean +
                                                                 (1 | wmu), 
                                    data = data.lme.final,
                                    family = gaussian (link = 'identity'),
                                    REML = FALSE,
                                    verbose = T)
table.model.compare [19, 1] <- "Area Cutblocks 1 to 5 years old, Area Cutblocks 6 to 10 years old, Area Cutblocks 11 to 20 years old, Area Cutblocks 21 to 30 years old, Area Burnt 1 to 5 years old, Area Burnt 6 to 10 years old, Area Burnt 11 to 15 years old, Area Burnt 16 to 20 years old, Area Burnt 21 to 25 years old, Area Burnt 26 to 30 years old, Area Populus Spp., River Area, Wetland Area, Area Douglas Fir, Loose Roads, Paved Roads, Rough Roads, Lake Area, Mean Ppt as Snow"
table.model.compare [19, 2] <- r.squaredGLMM (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk.pas)
table.model.compare [19, 3] <-  cAIC (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk.pas)$caic

# Calc AIC weights #
table.model.compare$AICc <- as.numeric (table.model.compare$AICc)
list.aic.like <- c ((exp (-0.5 * (table.model.compare [1, 3] - min (table.model.compare [c (1:19), 3])))), 
                    (exp (-0.5 * (table.model.compare [2, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [3, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [4, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [5, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [6, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [7, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [8, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [9, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [10, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [11, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [12, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [13, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [14, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [15, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [16, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [17, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [18, 3] - min (table.model.compare [c (1:19), 3])))),
                    (exp (-0.5 * (table.model.compare [19, 3] - min (table.model.compare [c (1:19), 3])))))

table.model.compare [1, 4] <- round ((exp (-0.5 * (table.model.compare [1, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [2, 4] <- round ((exp (-0.5 * (table.model.compare [2, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [3, 4] <- round ((exp (-0.5 * (table.model.compare [3, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [4, 4] <- round ((exp (-0.5 * (table.model.compare [4, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [5, 4] <- round ((exp (-0.5 * (table.model.compare [5, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [6, 4] <- round ((exp (-0.5 * (table.model.compare [6, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [7, 4] <- round ((exp (-0.5 * (table.model.compare [7, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [8, 4] <- round ((exp (-0.5 * (table.model.compare [8, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [9, 4] <- round ((exp (-0.5 * (table.model.compare [9, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [10, 4] <- round ((exp (-0.5 * (table.model.compare [10, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [11, 4] <- round ((exp (-0.5 * (table.model.compare [11, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [12, 4] <- round ((exp (-0.5 * (table.model.compare [12, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [13, 4] <- round ((exp (-0.5 * (table.model.compare [13, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [14, 4] <- round ((exp (-0.5 * (table.model.compare [14, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [15, 4] <- round ((exp (-0.5 * (table.model.compare [15, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [16, 4] <- round ((exp (-0.5 * (table.model.compare [16, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [17, 4] <- round ((exp (-0.5 * (table.model.compare [17, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [18, 4] <- round ((exp (-0.5 * (table.model.compare [18, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)
table.model.compare [19, 4] <- round ((exp (-0.5 * (table.model.compare [19, 3] - min (table.model.compare [c (1:19), 3])))) / sum (list.aic.like), 3)

kable (table.model.compare)
```


averaged top-three model coefficients


```{r, model averaged coefficients}

table.fixef.top <- data.frame (names (fixef(lme.moose.density.cut.burn.poplar.riv.wet.fir.rds)))
table.fixef.top [, 2] <- data.frame ((0.486 * fixef (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds)))
names (table.fixef.top)[1] <- "Coefficient Name"
names (table.fixef.top)[2] <- "Coefficient Value Top"

table.fixef.second <- data.frame (names (fixef(lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk)))
table.fixef.second [, 2] <- data.frame ((0.239 * fixef (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds.lk)))
names (table.fixef.second)[1] <- "Coefficient Name"
names (table.fixef.second)[2] <- "Coefficient Value Second"

table.avg.coeffs <- dplyr::full_join (table.fixef.top, table.fixef.second, by = "Coefficient Name")

table.avg.coeffs [is.na (table.avg.coeffs)] <- 0

table.avg.coeffs [, 4] <- table.avg.coeffs[, 2] + table.avg.coeffs[, 3] 
names (table.avg.coeffs)[4] <- "Average Coefficient Value"
round (table.avg.coeffs [, 4], 10)

kable (table.avg.coeffs [, c(1,4)], digits = 10)

```


### Double-check some of the diagnostics of the top model

```{r, diagnostics of top model}

data.lme.final$lme.predicted <- predict (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds)   
data.lme.final$lme.residuals <- residuals (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds) 

ggplot (data.lme.final, aes (x = lme.predicted, y = adj_density_est_km2)) + # predicted vs. actual values
        geom_point() +
        scale_x_continuous (breaks = seq(0, 1.6, 0.2)) +
        scale_y_continuous (breaks = seq(0, 1.6, 0.2)) +
        geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3)

ggplot (data.lme.final, aes (x = lme.predicted, y = lme.residuals)) + # fitted vs. residual values
        geom_point () +
        geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 1, vjust = 0, 
                   check_overlap = T,
                   size = 3) # these look ok; few obs at high predicted densities, but residuals are
                             # not overly large there; 5-12-B a bit of an outlier

ggplot (data.lme.final, aes(lme.residuals)) + # normality of residuals
        geom_histogram (binwidth = 0.1) 
plot (density (data.lme.final$lme.residuals)) # there is some skewness here, but not terrible
shapiro.test(data.lme.final$lme.residuals) # p-value = 0.6149, so is normal statistically

qqnorm (residuals (lme.moose.density)) # some deviation, but this seems ok too
qqline (residuals (lme.moose.density)) 

# compare fit to x variables
ggplot (data.lme.final, aes(x = Cut_1_5_area_ha, y = adj_density_est_km2)) + # ppt. as snow
  geom_segment (aes (xend = Cut_1_5_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # WMU 5-02-D 1994 might be high leverage; effect might be more positive without it?

ggplot (data.lme.final, aes(x = Cut_6_10_area_ha, y = adj_density_est_km2)) + # ppt. as snow
  geom_segment (aes (xend = Cut_6_10_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # WMU 5-02-D 1994 might be high leverage; effect might be more positive without it?

ggplot (data.lme.final, aes(x = Cut_11_20_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Cut_11_20_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Cut_21_30_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Cut_21_30_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_1_5_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_1_5_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_6_10_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_6_10_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_11_15_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_11_15_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_16_20_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_16_20_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_21_25_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_21_25_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Fire_26_30_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Fire_26_30_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = Populus_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = Populus_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = river_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = river_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = wetland_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = wetland_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) # WMU 5-02-D 1994 might be high leverage; effect might be positive without it?

ggplot (data.lme.final, aes(x = DougFir_area_ha, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = DougFir_area_ha, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = road_loose_km, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = road_loose_km, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = road_paved_km, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = road_paved_km, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

ggplot (data.lme.final, aes(x = road_rough_km, y = adj_density_est_km2)) + 
  geom_segment (aes (xend = road_rough_km, yend = lme.predicted)) +
  geom_point () +
  geom_point (aes (y = lme.predicted), shape = 1) +
  geom_text (aes (label = paste (wmu, survey_year, sep = "_")), hjust = 0, vjust = 0, 
                   check_overlap = T,
                   size = 3) +
  geom_smooth (method = lm) 

```

## How Does Forestry Relate to Moose and Wolf Desnity?

```{r, calculate moose and wolf density as a function of cutblock area, by year}

table.moose.density.pred <- data.frame (matrix (ncol = 18, nrow = 10))
colnames (table.moose.density.pred) <- c ("Cut_1_5_area_ha", "Cut_6_10_area_ha",  "Cut_11_20_area_ha",  "Cut_21_30_area_ha", "Fire_1_5_area_ha", "Fire_6_10_area_ha", "Fire_11_15_area_ha", "Fire_16_20_area_ha", "Fire_21_25_area_ha", "Fire_26_30_area_ha", "Populus_area_ha", "river_area_ha", "wetland_area_ha", "DougFir_area_ha", "road_loose_km", "road_paved_km", "road_rough_km", "group")
                                     
table.moose.density.pred [1:11, 1] <- seq (from = 0, to = 30000, by = 3000) 
table.moose.density.pred [1:11, 2] <- mean (data.lme.final$Cut_6_10_area_ha)         
table.moose.density.pred [1:11, 3] <- mean (data.lme.final$Cut_11_20_area_ha)         
table.moose.density.pred [1:11, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [1:11, 5] <- mean (data.lme.final$Fire_1_5_area_ha)         
table.moose.density.pred [1:11, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [1:11, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [1:11, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [1:11, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [1:11, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [1:11, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [1:11, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [1:11, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [1:11, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [1:11, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [1:11, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [1:11, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [1:11, 18] <- 1

table.moose.density.pred [12:22, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [12:22, 2] <- seq (from = 0, to = 45000, by = 4500)         
table.moose.density.pred [12:22, 3] <- mean (data.lme.final$Cut_11_20_area_ha)         
table.moose.density.pred [12:22, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [12:22, 5] <- mean (data.lme.final$Fire_1_5_area_ha)         
table.moose.density.pred [12:22, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [12:22, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [12:22, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [12:22, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [12:22, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [12:22, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [12:22, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [12:22, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [12:22, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [12:22, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [12:22, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [12:22, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [12:22, 18] <- 2

table.moose.density.pred [23:33, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [23:33, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [23:33, 3] <- seq (from = 0, to = 65000, by = 6500)          
table.moose.density.pred [23:33, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [23:33, 5] <- mean (data.lme.final$Fire_1_5_area_ha)         
table.moose.density.pred [23:33, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [23:33, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [23:33, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [23:33, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [23:33, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [23:33, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [23:33, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [23:33, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [23:33, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [23:33, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [23:33, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [23:33, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [23:33, 18] <- 3

table.moose.density.pred [34:44, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [34:44, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [34:44, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [34:44, 4] <- seq (from = 0, to = 50000, by = 5000)         
table.moose.density.pred [34:44, 5] <- mean (data.lme.final$Fire_1_5_area_ha)         
table.moose.density.pred [34:44, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [34:44, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [34:44, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [34:44, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [34:44, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [34:44, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [34:44, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [34:44, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [34:44, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [34:44, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [34:44, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [34:44, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [34:44, 18] <- 4

table.moose.density.pred [45:55, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [45:55, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [45:55, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [45:55, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [45:55, 5] <- c (0, 5000, 10000, 15000, 20000, 30000, 50000, 70000, 100000, 150000, 250000)      
table.moose.density.pred [45:55, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [45:55, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [45:55, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [45:55, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [45:55, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [45:55, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [45:55, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [45:55, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [45:55, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [45:55, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [45:55, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [45:55, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [45:55, 18] <- 5

table.moose.density.pred [56:66, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [56:66, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [56:66, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [56:66, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [56:66, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [56:66, 6] <- seq (from = 0, to = 60000, by = 6000)         
table.moose.density.pred [56:66, 7] <- mean (data.lme.final$Fire_11_15_area_ha)         
table.moose.density.pred [56:66, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [56:66, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [56:66, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [56:66, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [56:66, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [56:66, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [56:66, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [56:66, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [56:66, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [56:66, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [56:66, 18] <- 6

table.moose.density.pred [67:77, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [67:77, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [67:77, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [67:77, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [67:77, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [67:77, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [67:77, 7] <- seq (from = 0, to = 27500, by = 2750)          
table.moose.density.pred [67:77, 8] <- mean (data.lme.final$Fire_16_20_area_ha)         
table.moose.density.pred [67:77, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [67:77, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [67:77, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [67:77, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [67:77, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [67:77, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [67:77, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [67:77, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [67:77, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [67:77, 18] <- 7

table.moose.density.pred [78:88, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [78:88, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [78:88, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [78:88, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [78:88, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [78:88, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [78:88, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [78:88, 8] <- seq (from = 0, to = 3500, by = 350)       
table.moose.density.pred [78:88, 9] <- mean (data.lme.final$Fire_21_25_area_ha)         
table.moose.density.pred [78:88, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [78:88, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [78:88, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [78:88, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [78:88, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [78:88, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [78:88, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [78:88, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [78:88, 18] <- 8

table.moose.density.pred [89:99, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [89:99, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [89:99, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [89:99, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [89:99, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [89:99, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [89:99, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [89:99, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [89:99, 9] <- seq (from = 0, to = 7500, by = 750)           
table.moose.density.pred [89:99, 10] <- mean (data.lme.final$Fire_26_30_area_ha)         
table.moose.density.pred [89:99, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [89:99, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [89:99, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [89:99, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [89:99, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [89:99, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [89:99, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [89:99, 18] <- 9

table.moose.density.pred [100:110, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [100:110, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [100:110, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [100:110, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [100:110, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [100:110, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [100:110, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [100:110, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [100:110, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [100:110, 10] <- seq (from = 0, to = 7500, by = 750)          
table.moose.density.pred [100:110, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [100:110, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [100:110, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [100:110, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [100:110, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [100:110, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [100:110, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [100:110, 18] <- 10

table.moose.density.pred [111:121, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [111:121, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [111:121, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [111:121, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [111:121, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [111:121, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [111:121, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [111:121, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [111:121, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [111:121, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [111:121, 11] <- seq (from = 0, to = 47500, by = 4750)
table.moose.density.pred [111:121, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [111:121, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [111:121, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [111:121, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [111:121, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [111:121, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [111:121, 18] <- 11

table.moose.density.pred [122:132, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [122:132, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [122:132, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [122:132, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [122:132, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [122:132, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [122:132, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [122:132, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [122:132, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [122:132, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [122:132, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [122:132, 12] <- seq (from = 0, to = 5500, by = 550)
table.moose.density.pred [122:132, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [122:132, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [122:132, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [122:132, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [122:132, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [122:132, 18] <- 12

table.moose.density.pred [133:143, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [133:143, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [133:143, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [133:143, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [133:143, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [133:143, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [133:143, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [133:143, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [133:143, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [133:143, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [133:143, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [133:143, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [133:143, 13] <- seq (from = 0, to = 30000, by = 3000)
table.moose.density.pred [133:143, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [133:143, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [133:143, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [133:143, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [133:143, 18] <- 13

table.moose.density.pred [144:154, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [144:154, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [144:154, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [144:154, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [144:154, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [144:154, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [144:154, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [144:154, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [144:154, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [144:154, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [144:154, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [144:154, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [144:154, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [144:154, 14] <- seq (from = 0, to = 275000, by = 27500)
table.moose.density.pred [144:154, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [144:154, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [144:154, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [144:154, 18] <- 14

table.moose.density.pred [155:165, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [155:165, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [155:165, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [155:165, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [155:165, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [155:165, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [155:165, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [155:165, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [155:165, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [155:165, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [155:165, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [155:165, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [155:165, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [155:165, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [155:165, 15] <- seq (from = 0, to = 250, by = 25)
table.moose.density.pred [155:165, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [155:165, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [155:165, 18] <- 15

table.moose.density.pred [166:176, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [166:176, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [166:176, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [166:176, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [166:176, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [166:176, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [166:176, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [166:176, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [166:176, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [166:176, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [166:176, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [166:176, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [166:176, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [166:176, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [166:176, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [166:176, 16] <- seq (from = 0, to = 70, by = 7)
table.moose.density.pred [166:176, 17] <- mean (data.lme.final$road_rough_km)
table.moose.density.pred [166:176, 18] <- 16

table.moose.density.pred [177:187, 1] <- mean (data.lme.final$Cut_1_5_area_ha)  
table.moose.density.pred [177:187, 2] <- mean (data.lme.final$Cut_6_10_area_ha)          
table.moose.density.pred [177:187, 3] <- mean (data.lme.final$Cut_11_20_area_ha)          
table.moose.density.pred [177:187, 4] <- mean (data.lme.final$Cut_21_30_area_ha)         
table.moose.density.pred [177:187, 5] <- mean (data.lme.final$Fire_1_5_area_ha)       
table.moose.density.pred [177:187, 6] <- mean (data.lme.final$Fire_6_10_area_ha)         
table.moose.density.pred [177:187, 7] <- mean (data.lme.final$Fire_11_15_area_ha)          
table.moose.density.pred [177:187, 8] <- mean (data.lme.final$Fire_16_20_area_ha)       
table.moose.density.pred [177:187, 9] <- mean (data.lme.final$Fire_21_25_area_ha)           
table.moose.density.pred [177:187, 10] <- mean (data.lme.final$Fire_26_30_area_ha)          
table.moose.density.pred [177:187, 11] <- mean (data.lme.final$Populus_area_ha)
table.moose.density.pred [177:187, 12] <- mean (data.lme.final$river_area_ha)
table.moose.density.pred [177:187, 13] <- mean (data.lme.final$wetland_area_ha)
table.moose.density.pred [177:187, 14] <- mean (data.lme.final$DougFir_area_ha)
table.moose.density.pred [177:187, 15] <- mean (data.lme.final$road_loose_km)
table.moose.density.pred [177:187, 16] <- mean (data.lme.final$road_paved_km)
table.moose.density.pred [177:187, 17] <- seq (from = 0, to = 60, by = 6)
table.moose.density.pred [177:187, 18] <- 17

table.moose.density.pred$pred.moose.density <- predict (lme.moose.density.cut.burn.poplar.riv.wet.fir.rds,
                                               newdata = table.moose.density.pred,
                                               allow.new.levels = T,
                                               re.form = NA)


### Fuller et al. 2003 ungulate biomass equation; function to calculate ungulate biomass from density
table.moose.density.pred$moose.biomass.km2 <- table.moose.density.pred$pred.moose.density * 6

# Fuller et al. 2003 wolf density equation; function to calculate wolf density from ungulate biomass index
table.moose.density.pred$wolf.dens.fuller <- 3.5 + (table.moose.density.pred$moose.biomass.km2 * 3.3)

# Kuzyk and Hatter 2014 wolf density equation; function to calculate wolf density from ungulate biomass index
table.moose.density.pred$wolf.dens.kuzyk <- (table.moose.density.pred$moose.biomass.km2 * 5.4) - (table.moose.density.pred$moose.biomass.km2^2 * 0.166)

# Messier 1994 wolf density equation; function to calculate wolf density from moose density
table.moose.density.pred$wolf.dens.messier <- (58.7 * (table.moose.density.pred$pred.moose.density - 0.03))/(0.76 + table.moose.density.pred$pred.moose.density)

### Plots of relationships ###
## Cutblocks 1 to 5 years old ##
table.moose.density.pred.cut.1.5 <- table.moose.density.pred %>%
                                        slice (1:11) %>%
                                        select (Cut_1_5_area_ha, pred.moose.density)
table.moose.density.pred.cut.1.5$pred.moose.density <- table.moose.density.pred.cut.1.5$pred.moose.density * 100
names (table.moose.density.pred.cut.1.5)[2] <- "Predicted_Density"
table.moose.density.pred.cut.1.5$type <- "Moose per 100km2 - Muhly"

table.fuller.wolf.density.pred.cut.1.5 <- table.moose.density.pred %>%
                                     slice (1:11) %>%
                                     select (Cut_1_5_area_ha, wolf.dens.fuller)
names (table.fuller.wolf.density.pred.cut.1.5)[2] <- "Predicted_Density"
table.fuller.wolf.density.pred.cut.1.5$type <- "Wolves per 1000km2 - Fuller"

table.density.pred.cut.1.5 <- bind_rows (table.moose.density.pred.cut.1.5, table.fuller.wolf.density.pred.cut.1.5)

table.kuzyk.wolf.density.pred.cut.1.5 <- table.moose.density.pred %>%
                                           slice (1:11) %>%
                                           select (Cut_1_5_area_ha, wolf.dens.kuzyk)
names (table.kuzyk.wolf.density.pred.cut.1.5)[2] <- "Predicted_Density"
table.kuzyk.wolf.density.pred.cut.1.5$type <- "Wolves per 1000km2 - Kuzyk"

table.density.pred.cut.1.5 <- bind_rows (table.density.pred.cut.1.5, table.kuzyk.wolf.density.pred.cut.1.5)

rm (table.moose.density.pred.cut.1.5, table.fuller.wolf.density.pred.cut.1.5, table.kuzyk.wolf.density.pred.cut.1.5)
gc ()


ggplot (table.density.pred.cut.1.5, aes (x = Cut_1_5_area_ha, y = Predicted_Density)) +
  geom_line (aes (linetype = type, color = type)) +
  labs (x = "Area of 1 to 5 year old cutblocks", 
        y = expression ("Estimated Density per 100 (moose) or 1,000 (wolf)"~km^2)) +
  scale_x_continuous (breaks = seq (0, 30000, 5000)) +
  scale_y_continuous (breaks = seq (10, 40, 2)) +
  theme_classic () +
  theme (legend.title = element_blank()) +
  theme (legend.position = c(0.8, 0.3))
  
  










```


