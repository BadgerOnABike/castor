# Copyright 2018 Province of British Columbia
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and limitations under the License.

---
title: "Caribou habitat model telemetry data preparation"
author: "Tyler Muhly"
date: "September 12, 2018"
output: word_document
#  Script Name: 04_caribou_habitat_model_telemetry_data_prep_doc.Rmd
#  Script Version: 1.0
#  Script Purpose: Prep telemtery data for habitat model analysis. 
---

```{r setup, include = FALSE}
knitr::opts_chunk$set (echo = TRUE)
require (sf)
require (lubridate)
require (RPostgreSQL)
require (dplyr)
require (kableExtra)
# require (adehabitatHR)
# require (sp) 
# require (raster) 
# require (rgeos) 
# require (rgdal) 
# require (maptools)
# require (spatstat)
```

## Introduction

Here I document the process to generate the point location sample used to build a criobu reseoruce selction fucntion model. This includes documentation fo how telmetry data were filtered for use int eh model as the 'used' sample (i.e., the '1' dependent values in the binary logistic regression model), how data were catergozied by biological characteristics (e.g., herd) adn time of year (e.g., season). Also includes docuemntaion of how the 'available' sample (i.e., the '0' dependent values in the binary logistic regression model) was generated, by creatign saesonal annual hoem ranges for ach anaimal and generatign randon poitns within them

For review of source telemetry data, see 01_caribou_habtiat_download...  


## Methods
telemetry data compiled  from SPI (non-public version), BCOGRIS, and from regional biologists, nto yet entered into these db's. colelcted under provicnail permist amd follwoign provincial animal care protocols. data was from a wide varaiety of indivuals (males adn females of differnet ages), telemetry collar types (VHF, GPS and ARGOS, form differetn brands, such as Lotek and ATS) adn fix rates. Type of animal colalred adn colalr type not always documented; rarely had capture information. used 'as is', with ptoential for biases in some data due to differetn fix rates (e.g., fix rates may vary by colalr type and ). Older data, prior to 2008, were nto used in the analysis, as some landscape features (particualrly lienar features such as roads, pieplines and sesimic lines) do not typically have an accurate time asscoaited with their developmebnt. We did nto use data older than 10 years because there is a higher likelyhood that these animals may have been usign areas that were less distrubed by human footprint than what coudl be measured usign teh available data.   


```{r telemetry data summary, warning = F, include = F, message = F}
# connKyle <- dbConnect(drv = dbDriver ("PostgreSQL"), 
#                      host = "DC052586", # Kyle's computer name
#                      user = "Tyler",
#                      dbname = "clus",
#                      password = "tyler",
#                      port = "5432")
conn <- dbConnect (dbDriver ("PostgreSQL"), 
                   host = "",
                   user = "postgres",
                   dbname = "postgres",
                   password = "postgres",
                   port = "5432")
locs.caribou <- sf::st_read  (dsn = conn, # connKyle
                              query = "SELECT * FROM caribou.telemetry_caribou_all")
dbDisconnect (conn) # connKyle

# filter data before 2008
locs.caribou.new <-  dplyr::filter (locs.caribou, year > 2007)
locs.caribou.new$animal_id <- as.factor (locs.caribou.new$animal_id)

# Building a summary table of telemetry data
loc.year <- data.frame (table (locs.caribou.new$year)) # table of locations per year
names (loc.year) [1] <- "Year" 
loc.year$Year <- as.factor (loc.year$Year)
names (loc.year) [2] <- "Number of Locations" 
animal.year <- aggregate (data = locs.caribou.new, # number animals/year
                          animal_id ~ year, 
                          function(x) length(unique(x)))
names (animal.year) [2] <- "Number of Animals" 
names (animal.year) [1] <- "Year" 
animal.year$Year <- as.factor (animal.year$Year)
table.data.summary <- full_join (animal.year, loc.year, by = c ("Year", "Year"))
rm (loc.year, animal.year)
gc ()
knitr::kable (table.data.summary, 
              caption = "Table 1. Number of caribou collared and telemetry lcoations collected per year.", 
              align = 'c', format.args = list (big.mark   = ","))  
```


Data were split into 3 seasons, based on lit. review (see caariobu seasosn spreadsheet):
 calving/summer/fall	(summer) = 15-May to 31-Oct 
early winter =	01-Nov	to 15-Jan
late winter	= 16-Jan to 14-May

```{r telemetry data seasonal summary, warning = F, include = F, message = F}
#=================================
#  Subset the data by season
#=================================
# identified based on lit. review; a decent amount of variability there, but settled on:
# calving/summer/fall	(summer) = 15-May to 31-Oct 
# early winter =	01-Nov	to 15-Jan
# late winter	= 16-Jan to 14-May
# note that I tried a seperate calving season, but estimating calving season home ranges was 
# difficult in the boreal because of apparent variability in calving dates and associated movements
# resulting in highly variable home range sizes depending if and when the animal moved to calve
# also, on further reflection I don't know if an animal was male or female, and habitat use
# of each is obviously different, so I went with a more broader seasonal definition  
locs.caribou.summer <- subset (locs.caribou.new, 
                                   locs.caribou.new$month == 5 & 
                                   locs.caribou.new$day >= 15 |
                                   locs.caribou.new$month >= 6 &
                                   locs.caribou.new$month < 11)
locs.caribou.summer$season <- "Summer"
locs.caribou.early.winter <- subset (locs.caribou.new, 
                                     locs.caribou.new$month > 10 |
                                     locs.caribou.new$month == 1 &
                                     locs.caribou.new$day < 16)
locs.caribou.early.winter$season <- "Early Winter"
locs.caribou.late.winter <- subset (locs.caribou.new, 
                                    locs.caribou.new$month == 1 & 
                                    locs.caribou.new$day > 15 |
                                    locs.caribou.new$month == 5 &
                                    locs.caribou.new$day < 15 |
                                    locs.caribou.new$month > 1 &
                                    locs.caribou.new$month < 5)
locs.caribou.late.winter$season <- "Late Winter"

# recombine data
locs.caribou.new <- rbind (locs.caribou.summer, locs.caribou.early.winter, locs.caribou.late.winter)
locs.caribou.new$season <- as.factor (locs.caribou.new$season)
locs.caribou.new$year <- as.factor (locs.caribou.new$year)

# Seasonal summary table of telemetry data
loc.year.season <- data.frame (locs.caribou.new %>%
                                  group_by (year, season) %>%
                                  summarise (count = n ()))
loc.year.season <- loc.year.season [, c(1:3)]
names (loc.year.season) [1] <- "Year" 
names (loc.year.season) [2] <- "Season" 
names (loc.year.season) [3] <- "Number of Locations" 
animal.year.season <- aggregate (data = locs.caribou.new, # number animals/year and season
                                 animal_id ~ year + season, 
                                 function(x) length(unique(x)))
names (animal.year.season) [1] <- "Year" 
names (animal.year.season) [2] <- "Season" 
names (animal.year.season) [3] <- "Number of Animals" 
table.data.summary.year.season <- full_join (animal.year.season, loc.year.season, 
                                             by = c ("Year", "Year"))
rm (animal.year.season, loc.year.season)
gc ()
knitr::kable (table.data.summary.year.season, 
              caption = "Table 2. Number of caribou collared and telemetry lcoations collected per year and season.", 
              align = 'c', format.args = list (big.mark   = ","))  

```


data were clipped ot the province
data were assigned to each ecotype adn herd by intersectign with the location data


```{r assign ecotype to telemetry locations, warning = F, include = F, message = F}
#==============================================================
# Load caribou range boundaries to identify ranges and Ecotypes 
#=============================================================
caribou.range <- st_read (dsn = "C:\\Work\\caribou\\clus_data\\caribou\\caribou_herd\\GCPB_CARIBOU_POPULATION_SP\\GCBP_CARIB_polygon.shp", stringsAsFactors = T)
# remove Haida Gwaii
caribou.range <- caribou.range [caribou.range$OBJECTID != 138, ]
 # NOTE: the polygon ID was obtained using ArcGIS; not sure how to get that using R 
# clip data outside province
prov.bnd <- st_read ( dsn = "C:\\Work\\caribou\\clus_data\\admin_boundaries\\province\\gpr_000b11a_e.shp", stringsAsFactors = T)
prov.bnd <- st_transform (prov.bnd, 3005)
prov.bnd <- prov.bnd [prov.bnd$PRENAME == "British Columbia", ]  
locs.caribou.bc <- locs.caribou.new [prov.bnd, ] # clip locations to BC

# saved data, because clip process took awhile
conn <- dbConnect (dbDriver ("PostgreSQL"), 
                   host = "",
                   user = "postgres",
                   dbname = "postgres",
                   password = "postgres",
                   port = "5432")
st_write (obj = locs.caribou.bc, 
          dsn = conn, 
          layer = c ("caribou", "telemetry_caribou_bc"))
dbDisconnect (conn)

# Select fields to intersect with points 
caribou.ecotype.herd <- caribou.range %>% 
                          select (HERD_NAME, ECOTYPE)
locs.caribou.ecotype.herd <- st_intersection (locs.caribou, caribou.ecotype.herd)

# saved data, because intersect process took awhile 
conn <- dbConnect (dbDriver ("PostgreSQL"), 
                   host = "",
                   user = "postgres",
                   dbname = "postgres",
                   password = "postgres",
                   port = "5432")
st_write (obj = locs.caribou.ecotype.herd, 
          dsn = conn, 
          layer = c ("caribou", "telemetry_caribou_bc_ecotype_herd"))
dbDisconnect (conn)

# some locations occur outside of the herd boundaries; here I am assigning appropriate 
# values to those NA values

# subset of locations with no herd name values
locs.caribou.ecotype.herd.na <- locs.caribou.ecotype.herd [is.na (locs.caribou.ecotype.herd$HERD_NAME), ]

# animals with NA values for herd/ecotype
table.animal.id.na <- data.frame (unique (locs.caribou.ecotype.herd.na$animal_id))

# subset the data to see where these anaiamls are from
# e.g., 
locs.caribou.ecotype.herd.c234c <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id == "C234C", ] # only three locations total, delete from data
locs.caribou.ecotype.herd.C310T <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id == "C310T", ] # no locations in herd ranges; closest to Chase (looked at map) so assigned there 

# assigned herd and ecotype
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C310T"] <- "Chase"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C310T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C307T"] <- "Finlay"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C307T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C306T"] <- "Frog"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C306T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C305T"] <- "Frog"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C305T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C303T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C303T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C302T"] <- "Chase"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C302T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C301T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C301T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C296T"] <- "Chase"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C296T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C295T"] <- "Chase"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C295T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C298T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C298T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C297T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C297T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C294T"] <- "Frog"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C294T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C293T"] <- "Frog"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C293T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "40"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "40"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "39"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "39"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "37"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "37"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "49"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "49"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "46"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "46"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "42"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "42"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS1"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS1"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS3"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS3"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS7"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS7"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "34"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "34"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS4"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS4"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS5"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS5"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "81"] <- "Wells Gray"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "81"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SS 1"] <- "South Selkirks"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SS 1"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SS 4"] <- "South Selkirks"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SS 4"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SL26"] <- "Swan Lake"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SL26"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "HSCEK077"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "HSCEK077"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK002"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK002"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK003"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK003"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK007"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK007"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK007b"] <- "Muskwa"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK007b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK009"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK009"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK009b"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK009b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK026"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK026"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK044"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK044"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK050"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK050"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK066b"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK066b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK079"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK079"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK133"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK133"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK136"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK136"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK136b"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK136b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK143"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK143"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK161"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK161"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK161b"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK161b"] <- "Boreal"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK143"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK161"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK161"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK161b"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK161b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK163"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK163"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK166"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK166"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK167"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK167"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK168"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK168"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK169"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK169"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK170"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK170"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK170b"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK170b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK172"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK172"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK181"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK181"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK194"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK194"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK196"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK196"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK217"] <- "Prophet"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK217"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK219"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK219"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK225"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK225"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK237"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK237"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "NX05"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "NX05"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car119"] <- "Kennedy Siding"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car119"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car158"] <- "Quintette"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car158"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car190"] <- "Quintette"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car190"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car194"] <- "Quintette"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car194"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car077"] <- "Quintette"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car077"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "GC21"] <- "Graham"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "GC21"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "CS8"] <- "Nakusp"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "CS8"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SL10"] <- "Swan Lake"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SL10"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK014"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK014"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK016"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK016"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK016b"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK016b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK175"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK175"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK177"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK177"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK178"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK178"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK179"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK179"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK191"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK191"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK201"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK201"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK214"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK214"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK215"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK215"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK216"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK216"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "NX15"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "NX15"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car116"] <- "Moberly"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car116"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "car169"] <- "Scott"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "car169"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C304T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C304T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C300T"] <- "Spatsizi"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C300T"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "3"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "3"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "48"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "48"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C24A"] <- "Hart Ranges"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C24A"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "41"] <- "Itcha-Ilgachuz"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "41"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "187"] <- "Frisby-Boulder"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "187"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C125W"] <- "Wolverine"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C125W"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "C050A"] <- "Chase"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "C050A"] <- "Northern"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SS 2"] <- "South Selkirks"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SS 2"] <- "Mountain"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "HSCEK063"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "HSCEK063"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK014b"] <- "Parker"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK014b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK111"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK111"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK126b"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK126b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK139"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK139"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK142"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK142"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK146b"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK146b"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK165"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK165"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK180"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK180"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK183"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK183"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK189"] <- "Chinchaga"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK189"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK193"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK193"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK210"] <- "Maxhamish"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK210"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "SCEK239"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "SCEK239"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "NX16"] <- "Calendar"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "NX16"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "NX06"] <- "Calendar" 
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "NX06"] <- "Boreal"
locs.caribou.ecotype.herd$HERD_NAME [locs.caribou.ecotype.herd$animal_id == "NX17"] <- "Snake-Sahtaneh"
locs.caribou.ecotype.herd$ECOTYPE [locs.caribou.ecotype.herd$animal_id == "NX17"] <- "Boreal"

# deleted data
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "C234C", ]
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "162", ]
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "C299T", ]
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "C309T", ]
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "C308T", ]
locs.caribou.ecotype.herd <- locs.caribou.ecotype.herd [locs.caribou.ecotype.herd$animal_id != "C284C", ]



prov.locs.all.used@data <- mutate (prov.locs.all.used@data, 
                                   uniqueID = paste (prov.locs.all.used@data$ANIMAL_ID,
                                                     prov.locs.all.used@data$HERD_NAME,
                                                     prov.locs.all.used@data$ecotype,
                                                     prov.locs.all.used@data$season,
                                                     prov.locs.all.used@data$OBSERVATION_YEAR,
                                                     sep = "_")) 
prov.locs.all.used <- prov.locs.all.used [prov.locs.all.used$uniqueID %in% 
                                            names (table (prov.locs.all.used$uniqueID)) [table (prov.locs.all.used$uniqueID) >= 50] , ]
writeOGR (prov.locs.all.used, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\caribou_telemetry_final\\locs_all_used.shp", 
          layer = "locs_all_used", driver = "ESRI Shapefile")
# remove animals with <50 locations


```


















# remove animals with <50 locations  
# Seaman, D. E., Millspaugh, J. J., Kernohan, B. J., Brundige, G. C., Raedeke, K. J., & Gitzen, R. A. (1999). Effects of sample size on kernel home range estimates. The journal of wildlife management, 739-747.
# Kernohan, B. J., R. A. Gitzen, and J. J. Millspaugh. 2001. Analysis of animal space use and movements. Pages 125–166 in J. J. Millspaugh and J. M. Marzluff, editors. Radio tracking and animal populations. Academic Press, San Diego, CA, USA
prov.locs.summer.boreal <- prov.locs.summer.boreal [prov.locs.summer.boreal$ANIMAL_ID %in% 
                                                      names (table (prov.locs.summer.boreal$ANIMAL_ID)) [table (prov.locs.summer.boreal$ANIMAL_ID) >= 50] , ]
prov.locs.summer.mount <- prov.locs.summer.mount [prov.locs.summer.mount$ANIMAL_ID %in% 
                                                    names (table (prov.locs.summer.mount$ANIMAL_ID)) [table (prov.locs.summer.mount$ANIMAL_ID) >= 50] , ]
prov.locs.summer.north <- prov.locs.summer.north [prov.locs.summer.north$ANIMAL_ID %in% 
                                                    names (table (prov.locs.summer.north$ANIMAL_ID)) [table (prov.locs.summer.north$ANIMAL_ID) >= 50] , ]
prov.locs.early.winter.boreal <- prov.locs.early.winter.boreal [prov.locs.early.winter.boreal$ANIMAL_ID %in% 
                                                                  names (table (prov.locs.early.winter.boreal$ANIMAL_ID)) [table (prov.locs.early.winter.boreal$ANIMAL_ID) >= 50] , ]
prov.locs.early.winter.mount <- prov.locs.early.winter.mount [prov.locs.early.winter.mount$ANIMAL_ID %in% 
                                                                names (table (prov.locs.early.winter.mount$ANIMAL_ID)) [table (prov.locs.early.winter.mount$ANIMAL_ID) >= 50] , ]
prov.locs.early.winter.north <- prov.locs.early.winter.north [prov.locs.early.winter.north$ANIMAL_ID %in% 
                                                                names (table (prov.locs.early.winter.north$ANIMAL_ID)) [table (prov.locs.early.winter.north$ANIMAL_ID) >= 50] , ]
prov.locs.late.winter.boreal <- prov.locs.late.winter.boreal [prov.locs.late.winter.boreal$ANIMAL_ID %in% 
                                                                names (table (prov.locs.late.winter.boreal$ANIMAL_ID)) [table (prov.locs.late.winter.boreal$ANIMAL_ID) >= 50] , ]
prov.locs.late.winter.mount <- prov.locs.late.winter.mount [prov.locs.late.winter.mount$ANIMAL_ID %in% 
                                                              names (table (prov.locs.late.winter.mount$ANIMAL_ID)) [table (prov.locs.late.winter.mount$ANIMAL_ID) >= 50] , ]
prov.locs.late.winter.north <- prov.locs.late.winter.north [prov.locs.late.winter.north$ANIMAL_ID %in% 
                                                              names (table (prov.locs.late.winter.north$ANIMAL_ID)) [table (prov.locs.late.winter.north$ANIMAL_ID) >= 50] , ]
# bind the points together
prov.locs.all.used <- rbind (rbind (rbind (rbind (rbind (rbind (rbind (rbind (prov.locs.summer.boreal, 
                                                                              prov.locs.early.winter.boreal), prov.locs.late.winter.boreal), prov.locs.summer.mount),
                                                         prov.locs.early.winter.mount), prov.locs.late.winter.mount),
                                           prov.locs.summer.north), prov.locs.early.winter.north),
                             prov.locs.late.winter.north) # also, see: sf::st_union?
prov.locs.all.used@data$ecotype <- as.factor (prov.locs.all.used@data$ecotype)
prov.locs.all.used@data$season <- as.factor (prov.locs.all.used@data$season)

# Assign new indivudal ID's based on ANIMAL_ID and range
# looking at HR's in QGIS, clearly there are duplicate animals; 
# need to re-assign identifiers based on ranges, year and season
# prov.locs.all.used.herd <- sf::st_join (prov.locs.all.used, # alternative option using sf?
#                                         caribou.range, 
#                                         join = st_intersects)
prov.locs.all.used.herd <- sp::over (prov.locs.all.used, caribou.range[3]) # column 3 is herd name
prov.locs.all.used.herd$joinID <- 1:469998 # create a joinID to join data on; I did some visual inspection in GIS to see where points fell relative to caribou range and confirmed that the point order is equivalent to ID
prov.locs.all.used@data$joinID <- 1:469998 
prov.locs.all.used@data <- dplyr::full_join (prov.locs.all.used@data, prov.locs.all.used.herd, 
                                             by = c ("joinID" = "joinID")) 




  

# rm (prov.locs.calving.boreal, prov.locs.summ.fall.boreal, prov.locs.early.winter.boreal,
#    prov.locs.late.winter.boreal, prov.locs.calving.mount, prov.locs.summ.fall.mount,
#    prov.locs.early.winter.mount, prov.locs.late.winter.mount, prov.locs.calving.north,
#    prov.locs.summ.fall.north, prov.locs.late.winter.north)

#===============================================================
# "Kernel home range Utiliation Distribution Using adehabitatHR
#==============================================================
# https://cran.r-project.org/web/packages/adehabitatHR/vignettes/adehabitatHR.pdf
#  bivariate normal kernel
# variable h size and interpret visually
# a subjective visual choice for the smoothing parameter, based on successive trials (Calenge et al. 2011)
# Hemson, G., Johnson, P., South, A., Kenward, R., Ripley, R., & MACDONALD, D. (2005). Are kernels the mustard? Data from global positioning system (GPS) collars suggests problems for kernel home‐range analyses with least‐squares cross‐validation. Journal of Animal Ecology, 74(3), 455-463.
# too big to procees all data together, so break into smaller chunks again 
prov.locs.summer.boreal <- subset (prov.locs.all.used, 
                                   prov.locs.all.used@data$ecotype == "Boreal" & 
                                     prov.locs.all.used@data$season == "Summer")
prov.locs.summer.mount <- subset (prov.locs.all.used, 
                                  prov.locs.all.used@data$ecotype == "Mountain" & 
                                    prov.locs.all.used@data$season == "Summer")
prov.locs.summer.north <- subset (prov.locs.all.used, 
                                  prov.locs.all.used@data$ecotype == "Northern" & 
                                    prov.locs.all.used@data$season == "Summer")
prov.locs.early.winter.boreal <- subset (prov.locs.all.used, 
                                         prov.locs.all.used@data$ecotype == "Boreal" & 
                                           prov.locs.all.used@data$season == "Early Winter")
prov.locs.early.winter.mount <- subset (prov.locs.all.used, 
                                        prov.locs.all.used@data$ecotype == "Mountain" & 
                                          prov.locs.all.used@data$season == "Early Winter")
prov.locs.early.winter.north <- subset (prov.locs.all.used, 
                                        prov.locs.all.used@data$ecotype == "Northern" & 
                                          prov.locs.all.used@data$season == "Early Winter")
prov.locs.late.winter.boreal <- subset (prov.locs.all.used, 
                                        prov.locs.all.used@data$ecotype == "Boreal" & 
                                          prov.locs.all.used@data$season == "Late Winter")
prov.locs.late.winter.mount <- subset (prov.locs.all.used, 
                                       prov.locs.all.used@data$ecotype == "Mountain" & 
                                         prov.locs.all.used@data$season == "Late Winter")
prov.locs.late.winter.north <- subset (prov.locs.all.used, 
                                       prov.locs.all.used@data$ecotype == "Northern" & 
                                         prov.locs.all.used@data$season == "Late Winter")

# create factors without 0 records
prov.locs.summer.boreal@data$uniqueID <- factor (prov.locs.summer.boreal@data$uniqueID) # drop animals with no locations
prov.locs.summer.mount@data$uniqueID <- factor (prov.locs.summer.mount@data$uniqueID) # drop animals with no locations
prov.locs.summer.north@data$uniqueID <- factor (prov.locs.summer.north@data$uniqueID) # drop animals with no locations
prov.locs.early.winter.boreal@data$uniqueID <- factor (prov.locs.early.winter.boreal@data$uniqueID) # drop animals with no locations
prov.locs.early.winter.mount@data$uniqueID <- factor (prov.locs.early.winter.mount@data$uniqueID) # drop animals with no locations
prov.locs.early.winter.north@data$uniqueID <- factor (prov.locs.early.winter.north@data$uniqueID) # drop animals with no locations
prov.locs.late.winter.boreal@data$uniqueID <- factor (prov.locs.late.winter.boreal@data$uniqueID) # drop animals with no locations
prov.locs.late.winter.mount@data$uniqueID <- factor (prov.locs.late.winter.mount@data$uniqueID) # drop animals with no locations
prov.locs.late.winter.north@data$uniqueID <- factor (prov.locs.late.winter.north@data$uniqueID) # drop animals with no locations
# freq.animals.test <- data.frame(table (prov.locs.summer.boreal@data$uniqueID))

# ======================================
# Calculate UDs by season and ecotype
#======================================
###########
# BOREAL #
#########
# SUMMER
khr.summer.boreal.h1000 <- kernelUD (prov.locs.summer.boreal [, 45], # new unique animal ID
                                     h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                     grid = 1000, # grid 1km x 1km
                                     extent = 2)  # extent is 2x the 'normal' size
homerange.summer.boreal.h1000 <- getverticeshr (khr.summer.boreal.h1000, percent = 95)
writeOGR (homerange.summer.boreal.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_summer_h1000.shp", 
          layer = "hr_boreal_summer_h1000", driver = "ESRI Shapefile")
khr.summer.boreal.h5000 <- kernelUD (prov.locs.summer.boreal [, 45], # new unique animal ID
                                     h = 5000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 5000, 50000)
                                     grid = 1000, # grid 1km x 1km
                                     extent = 10)  
homerange.summer.boreal.h5000 <- getverticeshr (khr.summer.boreal.h5000, percent = 95)
writeOGR (homerange.summer.boreal.h5000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_summer_h5000.shp", 
          layer = "hr_boreal_summer_h5000", driver = "ESRI Shapefile")
khr.summer.boreal.h500 <- kernelUD (prov.locs.summer.boreal [, 45], # new unique animal ID
                                    h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                    grid = 1000, # grid 1km x 1km
                                    extent = 2)  
homerange.summer.boreal.h500 <- getverticeshr (khr.summer.boreal.h500, percent = 95)
writeOGR (homerange.summer.boreal.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_summer_h500.shp", 
          layer = "hr_boreal_summer_h500", driver = "ESRI Shapefile")
khr.summer.boreal.h750 <- kernelUD (prov.locs.summer.boreal [, 45], # new unique animal ID
                                    h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                    grid = 1000, # grid 1km x 1km
                                    extent = 2)  
homerange.summer.boreal.h750 <- getverticeshr (khr.summer.boreal.h750, percent = 95)
writeOGR (homerange.summer.boreal.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_summer_h750.shp", 
          layer = "hr_boreal_summer_h750", driver = "ESRI Shapefile")

rm (khr.summer.boreal.h1000, khr.summer.boreal.h5000, khr.summer.boreal.h500, khr.summer.boreal.h750)

# EARLY WINTER
khr.early.winter.boreal.h1000 <- kernelUD (prov.locs.early.winter.boreal [, 45], # new unique animal ID
                                           h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                           grid = 1000, # grid 1km x 1km
                                           extent = 2)  # extent is 2x the 'normal' size
homerange.early.winter.boreal.h1000 <- getverticeshr (khr.early.winter.boreal.h1000, percent = 95)
writeOGR (homerange.early.winter.boreal.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_early.winter_h1000.shp", 
          layer = "hr_boreal_early.winter_h1000", driver = "ESRI Shapefile")
khr.early.winter.boreal.h500 <- kernelUD (prov.locs.early.winter.boreal [, 45], # new unique animal ID
                                          h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 2)  
homerange.early.winter.boreal.h500 <- getverticeshr (khr.early.winter.boreal.h500, percent = 95)
writeOGR (homerange.early.winter.boreal.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_early.winter_h500.shp", 
          layer = "hr_boreal_early.winter_h500", driver = "ESRI Shapefile")
khr.early.winter.boreal.h750 <- kernelUD (prov.locs.early.winter.boreal [, 45], # new unique animal ID
                                          h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 2)  
homerange.early.winter.boreal.h750 <- getverticeshr (khr.early.winter.boreal.h750, percent = 95)
writeOGR (homerange.early.winter.boreal.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_early.winter_h750.shp", 
          layer = "hr_boreal_early.winter_h750", driver = "ESRI Shapefile")

rm (khr.early.winter.boreal.h1000, khr.early.winter.boreal.h500, khr.early.winter.boreal.h750)

# LATE WINTER
khr.late.winter.boreal.h1000 <- kernelUD (prov.locs.late.winter.boreal [, 45], # new unique animal ID
                                          h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 2)  # extent is 2x the 'normal' size
homerange.late.winter.boreal.h1000 <- getverticeshr (khr.late.winter.boreal.h1000, percent = 95)
writeOGR (homerange.late.winter.boreal.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_late.winter_h1000.shp", 
          layer = "hr_boreal_late.winter_h1000", driver = "ESRI Shapefile")
khr.late.winter.boreal.h500 <- kernelUD (prov.locs.late.winter.boreal [, 45], # new unique animal ID
                                         h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 2)  
homerange.late.winter.boreal.h500 <- getverticeshr (khr.late.winter.boreal.h500, percent = 95)
writeOGR (homerange.late.winter.boreal.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_late.winter_h500.shp", 
          layer = "hr_boreal_late.winter_h500", driver = "ESRI Shapefile")
khr.late.winter.boreal.h750 <- kernelUD (prov.locs.late.winter.boreal [, 45], # new unique animal ID
                                         h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 2)  
homerange.late.winter.boreal.h750 <- getverticeshr (khr.late.winter.boreal.h750, percent = 95)
writeOGR (homerange.late.winter.boreal.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_late.winter_h750.shp", 
          layer = "hr_boreal_late.winter_h750", driver = "ESRI Shapefile")

rm (khr.late.winter.boreal.h1000, khr.late.winter.boreal.h500, khr.late.winter.boreal.h750)
# 5000 very large areas; boundaries extend ~10km beyond points; too big
# 1000 reasonable, but on the larger side
# 750 also slightly large
# 500 had more islands and holes in data, but 'tighter' to points 
# went with h = 500 as 'best' representation

#############
# MOUNTAIN #
###########
# SUMMER
khr.summer.mount.h1000 <- kernelUD (prov.locs.summer.mount [, 45], # new unique animal ID
                                    h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                    grid = 1000, # grid 1km x 1km
                                    extent = 5)  # extent is 2x the 'normal' size
homerange.summer.mount.h1000 <- getverticeshr (khr.summer.mount.h1000, percent = 95)
writeOGR (homerange.summer.mount.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_summer_h1000.shp", 
          layer = "hr_mount_summer_h1000", driver = "ESRI Shapefile")
khr.summer.mount.h500 <- kernelUD (prov.locs.summer.mount [, 45], # new unique animal ID
                                   h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                   grid = 1000, # grid 1km x 1km
                                   extent = 5)  
homerange.summer.mount.h500 <- getverticeshr (khr.summer.mount.h500, percent = 95)
writeOGR (homerange.summer.mount.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_summer_h500.shp", 
          layer = "hr_mount_summer_h500", driver = "ESRI Shapefile")
khr.summer.mount.h750 <- kernelUD (prov.locs.summer.mount [, 45], # new unique animal ID
                                   h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                   grid = 1000, # grid 1km x 1km
                                   extent = 5)  
homerange.summer.mount.h750 <- getverticeshr (khr.summer.mount.h750, percent = 95)
writeOGR (homerange.summer.mount.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_summer_h750.shp", 
          layer = "hr_mount_summer_h750", driver = "ESRI Shapefile")

rm (khr.summer.mount.h1000, khr.summer.mount.h500, khr.summer.mount.h750)

# EARLY WINTER
khr.early.winter.mount.h1000 <- kernelUD (prov.locs.early.winter.mount [, 45], # new unique animal ID
                                          h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 5)  # extent is 2x the 'normal' size
homerange.early.winter.mount.h1000 <- getverticeshr (khr.early.winter.mount.h1000, percent = 95)
writeOGR (homerange.early.winter.mount.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_early.winter_h1000.shp", 
          layer = "hr_mount_early.winter_h1000", driver = "ESRI Shapefile")
khr.early.winter.mount.h500 <- kernelUD (prov.locs.early.winter.mount [, 45], # new unique animal ID
                                         h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 5)  
homerange.early.winter.mount.h500 <- getverticeshr (khr.early.winter.mount.h500, percent = 95)
writeOGR (homerange.early.winter.mount.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_early.winter_h500.shp", 
          layer = "hr_mount_early.winter_h500", driver = "ESRI Shapefile")
khr.early.winter.mount.h750 <- kernelUD (prov.locs.early.winter.mount [, 45], # new unique animal ID
                                         h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 5)  
homerange.early.winter.mount.h750 <- getverticeshr (khr.early.winter.mount.h750, percent = 95)
writeOGR (homerange.early.winter.mount.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_early.winter_h750.shp", 
          layer = "hr_mount_early.winter_h750", driver = "ESRI Shapefile")

rm (khr.early.winter.mount.h1000, khr.early.winter.mount.h500, khr.early.winter.mount.h750)

# LATE WINTER
khr.late.winter.mount.h1000 <- kernelUD (prov.locs.late.winter.mount [, 45], # new unique animal ID
                                         h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 5)  # extent is 2x the 'normal' size
homerange.late.winter.mount.h1000 <- getverticeshr (khr.late.winter.mount.h1000, percent = 95)
writeOGR (homerange.late.winter.mount.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_late.winter_h1000.shp", 
          layer = "hr_mount_late.winter_h1000", driver = "ESRI Shapefile")
khr.late.winter.mount.h500 <- kernelUD (prov.locs.late.winter.mount [, 45], # new unique animal ID
                                        h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                        grid = 1000, # grid 1km x 1km
                                        extent = 5)  
homerange.late.winter.mount.h500 <- getverticeshr (khr.late.winter.mount.h500, percent = 95)
writeOGR (homerange.late.winter.mount.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_late.winter_h500.shp", 
          layer = "hr_mount_late.winter_h500", driver = "ESRI Shapefile")
khr.late.winter.mount.h750 <- kernelUD (prov.locs.late.winter.mount [, 45], # new unique animal ID
                                        h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                        grid = 1000, # grid 1km x 1km
                                        extent = 5)  
homerange.late.winter.mount.h750 <- getverticeshr (khr.late.winter.mount.h750, percent = 95)
writeOGR (homerange.late.winter.mount.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_late.winter_h750.shp", 
          layer = "hr_mount_late.winter_h750", driver = "ESRI Shapefile")

rm (khr.late.winter.mount.h1000, khr.late.winter.mount.h500, khr.late.winter.mount.h750)

# 1000 reasonable, but on the larger side
# 750 also slightly large
# 500 had more islands and holes in data, but 'tighter' to points 
# went with h = 500 as 'best' representation

#############
# NORTHERN #
###########
# SUMMER
# split the data to make it easier to handle
# summer.north.ids <- list (unique (prov.locs.summer.north@data$uniqueID))
prov.locs.summer.north.top <-  prov.locs.summer.north [prov.locs.summer.north@data$uniqueID == "C02a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C03_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C04a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C05a_Graham_Northern_Summer_2001" |  
                                                         prov.locs.summer.north@data$uniqueID == "C07_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C09a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C10a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C01a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C06a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C11_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C12a_Graham_Northern_Summer_2001" |
                                                         prov.locs.summer.north@data$uniqueID == "C04b_Graham_Northern_Summer_2002" |             
                                                         prov.locs.summer.north@data$uniqueID == "C06b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C10b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C02b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C09b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C05b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C12b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C01b_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C14_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C15_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C16_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C17_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C13_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C18_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C20_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C22_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "C21_Graham_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "148.559_Telkwa_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "148.559_Telkwa_Northern_Summer_2003" |
                                                         prov.locs.summer.north@data$uniqueID == "148.669_Telkwa_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "148.669_Telkwa_Northern_Summer_2003" |
                                                         prov.locs.summer.north@data$uniqueID == "148.59_Telkwa_Northern_Summer_2002" |
                                                         prov.locs.summer.north@data$uniqueID == "148.59_Telkwa_Northern_Summer_2003" |
                                                         prov.locs.summer.north@data$uniqueID == "C1_Atlin_Northern_Summer_2000" |
                                                         prov.locs.summer.north@data$uniqueID == "C2_Atlin_Northern_Summer_2000" |
                                                         prov.locs.summer.north@data$uniqueID == "C3_Atlin_Northern_Summer_2000" |
                                                         prov.locs.summer.north@data$uniqueID == "C4_Atlin_Northern_Summer_2000" |
                                                         prov.locs.summer.north@data$uniqueID == "SL06_Swan Lake_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "SL02_Swan Lake_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "SL06_Swan Lake_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "SL06_Swan Lake_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "SL28_Swan Lake_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "SL15_Swan Lake_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "SL15_Swan Lake_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car055_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car056_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car056_Narraway_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car077_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car056_Narraway_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID ==  "car077_Quintette_Northern_Summer_2009" |
                                                         prov.locs.summer.north@data$uniqueID == "car032_Kennedy Siding_Northern_Summer_2004" |
                                                         prov.locs.summer.north@data$uniqueID == "car078_Narraway_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car043_Kennedy Siding_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "car044_Kennedy Siding_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "car025_Kennedy Siding_Northern_Summer_2004" |
                                                         prov.locs.summer.north@data$uniqueID == "car044_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car047_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car047_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car048_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car049_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car048_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car050_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car049_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car050_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car051_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car053_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car051_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car053_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car010_Moberly_Northern_Summer_2004" |
                                                         prov.locs.summer.north@data$uniqueID == "car061_Kennedy Siding_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car020_Moberly_Northern_Summer_2004" |
                                                         prov.locs.summer.north@data$uniqueID == "car052_Moberly_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car052_Moberly_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car052_Kennedy Siding_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car066_Moberly_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car067_Moberly_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car067_Moberly_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car066_Moberly_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car079_Moberly_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car079_Scott_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car102_Moberly_Northern_Summer_2009" |
                                                         prov.locs.summer.north@data$uniqueID == "car080_Moberly_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car012_Quintette_Northern_Summer_2004" |
                                                         prov.locs.summer.north@data$uniqueID == "car014_Quintette_Northern_Summer_2003" |
                                                         prov.locs.summer.north@data$uniqueID == "car040_Quintette_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car040_Quintette_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "car042_Quintette_Northern_Summer_2005" |
                                                         prov.locs.summer.north@data$uniqueID == "car042_Quintette_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car045_Quintette_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car057_Narraway_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car057_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car046_Quintette_Northern_Summer_2006" |
                                                         prov.locs.summer.north@data$uniqueID == "car057_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car057_Narraway_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car058_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car059_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car058_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car059_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car068_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car069_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car068_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car069_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car070_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car070_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car071_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car071_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car074_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car074_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car075_Quintette_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "car075_Quintette_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "car109_Quintette_Northern_Summer_2009" |
                                                         prov.locs.summer.north@data$uniqueID == "car112_Quintette_Northern_Summer_2009" |
                                                         prov.locs.summer.north@data$uniqueID == "car105_Quintette_Northern_Summer_2009" |
                                                         prov.locs.summer.north@data$uniqueID == "C069W_Wolverine_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C029W_Wolverine_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C041W_Wolverine_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C043W_Wolverine_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C042W_Wolverine_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C059C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C060C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C058C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C067C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C056C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C047A_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C066C_Chase_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C093A_Finlay_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C094A_Finlay_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "C094A_Pink Mountain_Northern_Summer_1999" |
                                                         prov.locs.summer.north@data$uniqueID == "148.990b_Tweedsmuir_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "148.960b_Tweedsmuir_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "148.890_Tweedsmuir_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "148.870_Tweedsmuir_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "148.870_Tweedsmuir_Northern_Summer_2008" |
                                                         prov.locs.summer.north@data$uniqueID == "149.581b_Tweedsmuir_Northern_Summer_2007"| 
                                                         prov.locs.summer.north@data$uniqueID == "149.551b_Tweedsmuir_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "148.840b_Tweedsmuir_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "149.530_Tweedsmuir_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "148.850_Tweedsmuir_Northern_Summer_2007" |
                                                         prov.locs.summer.north@data$uniqueID == "148.850_Tweedsmuir_Northern_Summer_2008", ]

prov.locs.summer.north.bottom <-  prov.locs.summer.north [prov.locs.summer.north@data$uniqueID == "149.431b_Tweedsmuir_Northern_Summer_2006" |
                                                            prov.locs.summer.north@data$uniqueID == "148.830b_Tweedsmuir_Northern_Summer_2007" |
                                                            prov.locs.summer.north@data$uniqueID == "149.450b_Tweedsmuir_Northern_Summer_2006" |
                                                            prov.locs.summer.north@data$uniqueID == "149.581a_Tweedsmuir_Northern_Summer_2002" | # was having trouble fitting the kernel HR with these animals; I think becuase covered a very large area, so removed from analysis
                                                            prov.locs.summer.north@data$uniqueID == "149.490a_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.450a_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.531_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.110b_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.190b_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.120b_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.090b_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.098_Tweedsmuir_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "149.200a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.160a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.190a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.110a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.150a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.120a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.090a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "149.080a_Tweedsmuir_Northern_Summer_2000" |
                                                            prov.locs.summer.north@data$uniqueID == "C307T_Finlay_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "C307T_Finlay_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "C306T_Frog_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "C306T_Frog_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "C303T_Spatsizi_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "C303T_Spatsizi_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "C303T_Spatsizi_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "C296T_Chase_Northern_Summer_2012" |
                                                            # prov.locs.summer.north@data$uniqueID == "C297T_Spatsizi_Northern_Summer_2013" | # locations all within 50m of each other; so, removed from analysis
                                                            prov.locs.summer.north@data$uniqueID == "C294T_Frog_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "C293T_Frog_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "C293T_Frog_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "149.421_Level Kawdy_Northern_Summer_2003" |
                                                            prov.locs.summer.north@data$uniqueID == "149.421_Little Rancheria_Northern_Summer_2003" |
                                                            prov.locs.summer.north@data$uniqueID == "149.498_Edziza_Northern_Summer_2003" |
                                                            prov.locs.summer.north@data$uniqueID == "149.441_Edziza_Northern_Summer_2003" |
                                                            prov.locs.summer.north@data$uniqueID == "car132_Narraway_Northern_Summer_2010" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1002_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1002_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1003_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1003_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1004_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1006_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1007_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1001_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1001_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1005_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1005_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1008_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1012_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1012_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1009_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1009_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1017_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1017_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1014_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1014_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1011_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1016_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1016_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1015_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1015_Tweedsmuir_Northern_Summer_2015" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1028_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1027_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1029_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "TWC1030_Tweedsmuir_Northern_Summer_2016" |
                                                            prov.locs.summer.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "3_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "4_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "56_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "56_Rainbows_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "54_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "54_Rainbows_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "53_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "52_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "52_Rainbows_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "51_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "40_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "40_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "39_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "39_Rainbows_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "39_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "39_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "38_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "38_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "38_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "37_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "36_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "35_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "34_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "34_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "33_Charlotte Alplands_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "33_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Rainbows_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Rainbows_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "48_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "49_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "48_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "46_Rainbows_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "46_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "46_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "44_Itcha-Ilgachuz_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "46_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "44_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "43_Rainbows_Northern_Summer_2012" |
                                                            prov.locs.summer.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Summer_2014" |
                                                            prov.locs.summer.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Summer_2013" |
                                                            prov.locs.summer.north@data$uniqueID == "GC23_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC16_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC21_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC08_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC16_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC08_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC07_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC07_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC04_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC06_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC04_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC09_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC10_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC09_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC14_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC12_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC12_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC11_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC13_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC11_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC20_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC20_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC19_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC19_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC03_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "GC03_Graham_Northern_Summer_2009" |
                                                            prov.locs.summer.north@data$uniqueID == "GC02_Graham_Northern_Summer_2008" |
                                                            prov.locs.summer.north@data$uniqueID == "C025A_Pink Mountain_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "C017A_Pink Mountain_Northern_Summer_2002" |
                                                            prov.locs.summer.north@data$uniqueID == "C012A_Pink Mountain_Northern_Summer_2002", ]     

# create factors without 0 records
prov.locs.summer.north.top@data$uniqueID <- factor (prov.locs.summer.north.top@data$uniqueID) # drop animals with no locations
prov.locs.summer.north.bottom@data$uniqueID <- factor (prov.locs.summer.north.bottom@data$uniqueID) # drop animals with no locations

# khr.summer.north.h1000.top <- kernelUD (prov.locs.summer.north.top [, 45], # new unique animal ID
#                                        h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
#                                        grid = 1000, # grid 1km x 1km
#                                        extent = 5)  # extent is 2x the 'normal' size
#homerange.summer.north.h1000.top <- getverticeshr (khr.summer.north.h1000.top, percent = 95)
#writeOGR (homerange.summer.north.h1000.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h1000_top.shp", 
#          layer = "hr_north_summer_h1000_top", driver = "ESRI Shapefile")
#rm (khr.summer.north.h1000.top)
khr.summer.north.h500.top <- kernelUD (prov.locs.summer.north.top [, 45], # new unique animal ID
                                       h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                       grid = 1000, # grid 1km x 1km
                                       extent = 5)  
homerange.summer.north.h500.top <- getverticeshr (khr.summer.north.h500.top, percent = 95)
writeOGR (homerange.summer.north.h500.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h500_top.shp", 
          layer = "hr_north_summer_h500_top", driver = "ESRI Shapefile")
rm (khr.summer.north.h500.top)
#khr.summer.north.h750.top <- kernelUD (prov.locs.summer.north.top [, 45], # new unique animal ID
#                                   h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
#                                   grid = 1000, # grid 1km x 1km
#                                   extent = 5)  
#homerange.summer.north.h750.top <- getverticeshr (khr.summer.north.h750.top, percent = 95)
#writeOGR (homerange.summer.north.h750.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h750_top.shp", 
#          layer = "hr_north_summer_h750_top", driver = "ESRI Shapefile")
#rm (khr.summer.north.h750.top)

#khr.summer.north.h1000.bottom <- kernelUD (prov.locs.summer.north.bottom [, 45], # new unique animal ID
#                                           h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
#                                           grid = 1000, # grid 1km x 1km
#                                           extent = 5)  # extent is 2x the 'normal' size
#homerange.summer.north.h1000.bottom <- getverticeshr (khr.summer.north.h1000.bottom, percent = 95)
#writeOGR (homerange.summer.north.h1000.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h1000_top.shp", 
#          layer = "hr_north_summer_h1000_top", driver = "ESRI Shapefile")
#rm (khr.summer.north.h1000.bottom)
khr.summer.north.h500.bottom <- kernelUD (prov.locs.summer.north.bottom [, 45], # new unique animal ID
                                          h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 5)  
homerange.summer.north.h500.bottom <- getverticeshr (khr.summer.north.h500.bottom, percent = 95)
writeOGR (homerange.summer.north.h500.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h500_bottom.shp", 
          layer = "hr_north_summer_h500_bottom", driver = "ESRI Shapefile")
rm (khr.summer.north.h500.bottom)
#khr.summer.north.h750 <- kernelUD (prov.locs.summer.north.bottom [, 45], # new unique animal ID
#                                   h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
#                                   grid = 1000, # grid 1km x 1km
#                                   extent = 5)  
#homerange.summer.north.h750.bottom <- getverticeshr (khr.summer.north.h750.bottom, percent = 95)
#writeOGR (homerange.summer.north.h750.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h750_top.shp", 
#          layer = "hr_north_summer_h750_top", driver = "ESRI Shapefile")
#rm (khr.summer.north.h750.bottom)

# EARLY WINTER
khr.early.winter.north.h1000 <- kernelUD (prov.locs.early.winter.north [, 45], # new unique animal ID
                                          h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
                                          grid = 1000, # grid 1km x 1km
                                          extent = 5)  # extent is 2x the 'normal' size
homerange.early.winter.north.h1000 <- getverticeshr (khr.early.winter.north.h1000, percent = 95)
writeOGR (homerange.early.winter.north.h1000, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_early.winter_h1000.shp", 
          layer = "hr_north_early.winter_h1000", driver = "ESRI Shapefile")
rm (khr.early.winter.north.h1000)
khr.early.winter.north.h500 <- kernelUD (prov.locs.early.winter.north [, 45], # new unique animal ID
                                         h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 5)  
homerange.early.winter.north.h500 <- getverticeshr (khr.early.winter.north.h500, percent = 95)
writeOGR (homerange.early.winter.north.h500, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_early.winter_h500.shp", 
          layer = "hr_north_early.winter_h500", driver = "ESRI Shapefile")
rm (khr.early.winter.north.h500)
khr.early.winter.north.h750 <- kernelUD (prov.locs.early.winter.north [, 45], # new unique animal ID
                                         h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                         grid = 1000, # grid 1km x 1km
                                         extent = 5)  
homerange.early.winter.north.h750 <- getverticeshr (khr.early.winter.north.h750, percent = 95)
writeOGR (homerange.early.winter.north.h750, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_early.winter_h750.shp", 
          layer = "hr_north_early.winter_h750", driver = "ESRI Shapefile")
rm (khr.early.winter.north.h750)

# LATE WINTER
# split the data to make it easier to handle
late.winter.north.ids <- list (unique (prov.locs.late.winter.north@data$uniqueID))
prov.locs.late.winter.north.top <-  prov.locs.late.winter.north [prov.locs.late.winter.north@data$uniqueID == "C02a_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C03_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C03_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C05a_Graham_Northern_Late Winter_2001" |  
                                                                   prov.locs.late.winter.north@data$uniqueID == "C04a_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C07_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C05a_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C09a_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C07_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C01a_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C01a_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C11_Graham_Northern_Late Winter_2001" |             
                                                                   prov.locs.late.winter.north@data$uniqueID == "C12a_Graham_Northern_Late Winter_2001" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C11_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C12a_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C04b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C06b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C10b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C06b_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C08b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C02b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C09b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C02b_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C12b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C09b_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C05b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C12b_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C01b_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C01b_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C14_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C14_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C15_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C15_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C16_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C16_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C17_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C18_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C13_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C17_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C18_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C20_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C20_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C19_Graham_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C22_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C21_Graham_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.559_Telkwa_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.559_Telkwa_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.669_Telkwa_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.669_Telkwa_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.59_Telkwa_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.59_Telkwa_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C1_Atlin_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C2_Atlin_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C3_Atlin_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C4_Atlin_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C5_Atlin_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL06_Swan Lake_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL06_Swan Lake_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL06_Swan Lake_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL28_Swan Lake_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL15_Swan Lake_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL28_Swan Lake_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL15_Little Rancheria_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "SL15_Swan Lake_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car055_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car054_Narraway_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car056_Narraway_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car056_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car056_Narraway_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car077_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car078_Narraway_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car077_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car078_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car077_Narraway_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car032_Burnt Pine_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car032_Burnt Pine_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car025_Kennedy Siding_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car024_Kennedy Siding_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car011_Kennedy Siding_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car024_Kennedy Siding_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car043_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car025_Kennedy Siding_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car044_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car047_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car044_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car047_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car048_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car048_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car048_Kennedy Siding_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car049_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car049_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car050_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car050_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car050_Kennedy Siding_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car051_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car051_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car053_Kennedy Siding_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car053_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car053_Kennedy Siding_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car010_Moberly_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car061_Kennedy Siding_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car061_Kennedy Siding_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car010_Moberly_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car020_Moberly_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car009_Moberly_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car020_Moberly_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car010_Moberly_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car052_Moberly_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car052_Moberly_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car066_Moberly_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car066_Moberly_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car067_Moberly_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car067_Moberly_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car080_Moberly_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car079_Moberly_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car079_Scott_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car080_Moberly_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car102_Moberly_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car015_Quintette_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car012_Quintette_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car012_Quintette_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car031_Quintette_Northern_Late Winter_2004" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car014_Quintette_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car012_Quintette_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car013_Quintette_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car040_Quintette_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car040_Quintette_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car045_Quintette_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car042_Quintette_Northern_Late Winter_2005" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car042_Quintette_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car046_Quintette_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car045_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car057_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car057_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car058_Quintette_Northern_Late Winter_2007" | 
                                                                   prov.locs.late.winter.north@data$uniqueID == "car058_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car059_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car059_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car068_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car068_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car068_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car069_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car069_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car070_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car070_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car070_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car071_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car071_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car072_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car074_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car074_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car074_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car075_Quintette_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car075_Quintette_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car105_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car075_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car109_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "car112_Quintette_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C043W_Wolverine_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C042W_Wolverine_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C068W_Wolverine_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C069W_Wolverine_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C056C_Chase_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C059C_Chase_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C059C_Chase_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C060C_Chase_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C057A_Finlay_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C067C_Chase_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C112A_Finlay_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C093A_Finlay_Northern_Late Winter_2000" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "C066C_Chase_Northern_Late Winter_1999" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.990b_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.990b_Tweedsmuir_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.960b_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.960b_Tweedsmuir_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.940b_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.890_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.890_Tweedsmuir_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.870_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.870_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.581b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.840b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.490b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.551b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.850_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.530_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.810b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.850_Tweedsmuir_Northern_Late Winter_2008" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.850_Tweedsmuir_Northern_Late Winter_2009" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "148.830b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.450b_Tweedsmuir_Northern_Late Winter_2006" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.551a_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.450b_Tweedsmuir_Northern_Late Winter_2007" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.581a_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.450a_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.531_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.110b_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.190b_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.120b_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.190b_Tweedsmuir_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.090b_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.090b_Tweedsmuir_Northern_Late Winter_2003" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.080b_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.098_Tweedsmuir_Northern_Late Winter_2002" |
                                                                   prov.locs.late.winter.north@data$uniqueID == "149.098_Tweedsmuir_Northern_Late Winter_2003", ]

prov.locs.late.winter.north.bottom <-  prov.locs.late.winter.north [prov.locs.late.winter.north@data$uniqueID == "149.200a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.190a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.160a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.110a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.120a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.150a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.080a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.090a_Tweedsmuir_Northern_Late Winter_2000" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C305T_Frog_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C303T_Spatsizi_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C303T_Spatsizi_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C296T_Chase_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C298T_Spatsizi_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C297T_Spatsizi_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C294T_Frog_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C293T_Frog_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.421_Level Kawdy_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.411_Level Kawdy_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.498_Edziza_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "149.441_Edziza_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car133_Narraway_Northern_Late Winter_2011" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car135_Narraway_Northern_Late Winter_2011" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car134_Narraway_Northern_Late Winter_2011" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car133_Narraway_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car132_Narraway_Northern_Late Winter_2011" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "car132_Narraway_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1002_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1002_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1003_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1002_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1003_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1003_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1004_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1006_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1007_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1006_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1007_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1001_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1001_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1001_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1005_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1005_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1005_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1008_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1008_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1012_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1012_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1012_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1009_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1009_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1009_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1017_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1017_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1017_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1011_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1014_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1014_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1014_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1016_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1016_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1016_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1024_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1015_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1015_Tweedsmuir_Northern_Late Winter_2015" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1015_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1026_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1027_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1027_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1028_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1029_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1028_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1029_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1033_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1035_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1030_Tweedsmuir_Northern_Late Winter_2016" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1030_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1036_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1034_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1032_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1037_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "TWC1038_Tweedsmuir_Northern_Late Winter_2017" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "4_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "3_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "4_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "56_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "55_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "54_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "53_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "52_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "52_Charlotte Alplands_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "51_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "41_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "40_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "40_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "39_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "38_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "39_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "38_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "37_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "36_Charlotte Alplands_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "35_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "36_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "34_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "33_Charlotte Alplands_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "34_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "33_Charlotte Alplands_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "33_Rainbows_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "49_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "48_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "48_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "46_Itcha-Ilgachuz_Northern_Late Winter_2013" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "46_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "45_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "44_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "43_Charlotte Alplands_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "42_Itcha-Ilgachuz_Northern_Late Winter_2014" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "44_Itcha-Ilgachuz_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "43_Rainbows_Northern_Late Winter_2012" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC23_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC23_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC21_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC16_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC16_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC16_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC08_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC08_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC07_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC08_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC07_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC07_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC04_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC06_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC04_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC10_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC09_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC09_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC09_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC14_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC12_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC12_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC11_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC11_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC12_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC13_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC11_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC20_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC20_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC19_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC19_Graham_Northern_Late Winter_2010" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC03_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC03_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC19_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC02_Graham_Northern_Late Winter_2008" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "GC02_Graham_Northern_Late Winter_2009" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C043A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C037A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C036A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C042A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C021B_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C018B_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C035A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C033A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C029A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C028A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C031A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C012B_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C025A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C023A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C008B_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C020A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C022A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C017A_Pink Mountain_Northern_Late Winter_2003" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C017A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C015A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C016A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C012A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C011A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C014A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C006A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C010A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C003A_Pink Mountain_Northern_Late Winter_2002" |
                                                                      prov.locs.late.winter.north@data$uniqueID == "C002A_Pink Mountain_Northern_Late Winter_2002", ]     


# create factors without 0 records
prov.locs.late.winter.north.top@data$uniqueID <- factor (prov.locs.late.winter.north.top@data$uniqueID) # drop animals with no locations
prov.locs.late.winter.north.bottom@data$uniqueID <- factor (prov.locs.late.winter.north.bottom@data$uniqueID) # drop animals with no locations

# khr.late.winter.north.h1000.top <- kernelUD (prov.locs.late.winter.north.top [, 45], # new unique animal ID
#                                        h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
#                                        grid = 1000, # grid 1km x 1km
#                                        extent = 5)  # extent is 2x the 'normal' size
#homerange.late.winter.north.h1000.top <- getverticeshr (khr.late.winter.north.h1000.top, percent = 95)
#writeOGR (homerange.late.winter.north.h1000.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h1000_top.shp", 
#          layer = "hr_north_late.winter_h1000_top", driver = "ESRI Shapefile")
#rm (khr.late.winter.north.h1000.top)
khr.late.winter.north.h500.top <- kernelUD (prov.locs.late.winter.north.top [, 45], # new unique animal ID
                                            h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                            grid = 1000, # grid 1km x 1km
                                            extent = 5)  
homerange.late.winter.north.h500.top <- getverticeshr (khr.late.winter.north.h500.top, percent = 95)
writeOGR (homerange.late.winter.north.h500.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h500_top.shp", 
          layer = "hr_north_late.winter_h500_top", driver = "ESRI Shapefile")
rm (khr.late.winter.north.h500.top)
#khr.late.winter.north.h750.top <- kernelUD (prov.locs.late.winter.north.top [, 45], # new unique animal ID
#                                   h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
#                                   grid = 1000, # grid 1km x 1km
#                                   extent = 5)  
#homerange.late.winter.north.h750.top <- getverticeshr (khr.late.winter.north.h750.top, percent = 95)
#writeOGR (homerange.late.winter.north.h750.top, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h750_top.shp", 
#          layer = "hr_north_late.winter_h750_top", driver = "ESRI Shapefile")
#rm (khr.late.winter.north.h750.top)

#khr.late.winter.north.h1000.bottom <- kernelUD (prov.locs.late.winter.north.bottom [, 45], # new unique animal ID
#                                           h = 1000, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 1000, 10000)
#                                           grid = 1000, # grid 1km x 1km
#                                           extent = 5)  # extent is 2x the 'normal' size
#homerange.late.winter.north.h1000.bottom <- getverticeshr (khr.late.winter.north.h1000.bottom, percent = 95)
#writeOGR (homerange.late.winter.north.h1000.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h1000_top.shp", 
#          layer = "hr_north_late.winter_h1000_top", driver = "ESRI Shapefile")
#rm (khr.late.winter.north.h1000.bottom)
khr.late.winter.north.h500.bottom <- kernelUD (prov.locs.late.winter.north.bottom [, 45], # new unique animal ID
                                               h = 500, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
                                               grid = 1000, # grid 1km x 1km
                                               extent = 5)  
homerange.late.winter.north.h500.bottom <- getverticeshr (khr.late.winter.north.h500.bottom, percent = 95)
writeOGR (homerange.late.winter.north.h500.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h500_bottom.shp", 
          layer = "hr_north_late.winter_h500_bottom", driver = "ESRI Shapefile")
rm (khr.late.winter.north.h500.bottom)
#khr.late.winter.north.h750 <- kernelUD (prov.locs.late.winter.north.bottom [, 45], # new unique animal ID
#                                   h = 750, # smoothing parameter (h) computed by Least Square Cross Validation did not converge, so tried different h values (100, 10000, 100000)
#                                   grid = 1000, # grid 1km x 1km
#                                   extent = 5)  
#homerange.late.winter.north.h750.bottom <- getverticeshr (khr.late.winter.north.h750.bottom, percent = 95)
#writeOGR (homerange.late.winter.north.h750.bottom, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h750_top.shp", 
#          layer = "hr_north_late.winter_h750_top", driver = "ESRI Shapefile")
#rm (khr.late.winter.north.h750.bottom)

#===============================================================
# Random sample of 'available' points in home ranges
#==============================================================
# https://gis.stackexchange.com/questions/108046/how-to-create-randomly-points-within-polygons-for-each-row-of-a-dataframe-matchi
homerange.summer.boreal.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_summer_h500.shp",
                                         layer = "hr_boreal_summer_h500")
homerange.early.winter.boreal.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_early.winter_h500.shp",
                                               layer = "hr_boreal_early.winter_h500")
homerange.late.winter.boreal.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_boreal_late.winter_h500.shp",
                                              layer = "hr_boreal_late.winter_h500")
homerange.summer.mount.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_summer_h500.shp",
                                        layer = "hr_mount_summer_h500")
homerange.early.winter.mount.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_early.winter_h500.shp",
                                              layer = "hr_mount_early.winter_h500")
homerange.late.winter.mount.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_mount_late.winter_h500.shp",
                                             layer = "hr_mount_late.winter_h500")
homerange.summer.north.h500.top <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h500_top.shp",
                                            layer = "hr_north_summer_h500_top")
homerange.summer.north.h500.bottom <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_summer_h500_bottom.shp",
                                               layer = "hr_north_summer_h500_bottom")
homerange.early.winter.north.h500 <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_early.winter_h500.shp",
                                              layer = "hr_north_early.winter_h500")
homerange.late.winter.north.h500.top <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h500_top.shp",
                                                 layer = "hr_north_late.winter_h500_top")
homerange.late.winter.north.h500.bottom <- readOGR (dsn = "C:\\Work\\caribou\\climate_analysis\\data\\caribou\\homeranges\\hr_north_late.winter_h500_bottom.shp",
                                                    layer = "hr_north_late.winter_h500_bottom")
homerange.all <- rbind (rbind (rbind (rbind (rbind (rbind (rbind (rbind (rbind (rbind (homerange.summer.boreal.h500, homerange.early.winter.boreal.h500),
                                                                                homerange.late.winter.boreal.h500), homerange.summer.mount.h500), 
                                                                  homerange.early.winter.mount.h500), homerange.late.winter.mount.h500), 
                                                    homerange.summer.north.h500.top), homerange.summer.north.h500.bottom), 
                                      homerange.early.winter.north.h500), homerange.late.winter.north.h500.top),
                        homerange.late.winter.north.h500.bottom)

# create spatialpointsdataframe to bind to in loop
sample.pts.boreal.C1_Maxhamish_Boreal_Summer_2006 <- spsample (homerange.summer.boreal.h500 [homerange.summer.boreal.h500@data$id == "C1_Maxhamish_Boreal_Summer_2006",], 
                                                               n = 1000, type = "random")
sample.pts.boreal.data.C1_Maxhamish_Boreal_Summer_2006 <- data.frame (matrix (ncol = 2, nrow = nrow (sample.pts.boreal.C1_Maxhamish_Boreal_Summer_2006@coords)))
colnames (sample.pts.boreal.data.C1_Maxhamish_Boreal_Summer_2006) <- c ("pttype", "uniqueID")
sample.pts.boreal.data.C1_Maxhamish_Boreal_Summer_2006$pttype <- 0
sample.pts.boreal.data.C1_Maxhamish_Boreal_Summer_2006$uniqueID <- paste (i)
id.points.out.all <- SpatialPointsDataFrame (sample.pts.boreal.C1_Maxhamish_Boreal_Summer_2006, data = sample.pts.boreal.data.C1_Maxhamish_Boreal_Summer_2006)

for (i in levels (homerange.all@data$id)) { # loop to sample 1000 random points for each polygon
  id.poly <- homerange.all [homerange.all@data$id == i,]
  id.points <- spsample (id.poly, 
                         n = 1000, type = "random", iter = 50)
  data.pts <- data.frame (matrix (ncol = 2, nrow = nrow (id.points@coords)))
  colnames (data.pts) <- c ("pttype", "uniqueID")
  data.pts$pttype <- 0
  data.pts$uniqueID <- i
  id.points.out <- SpatialPointsDataFrame (id.points, data = data.pts)
  id.points.out.all <- rbind (id.points.out.all, id.points.out)
}

id.points.out.all@data$ecotype <- gsub (".*(Northern|Mountain|Boreal).*$", # define ecotype, season, etc. 
                                        "\\1", 
                                        id.points.out.all@data$uniqueID, ignore.case = F)
id.points.out.all@data$season <- gsub (".*(Early Winter|Late Winter|Summer).*$", # define ecotype, season, etc. 
                                       "\\1", 
                                       id.points.out.all@data$uniqueID, ignore.case = F)
id.points.out.all@data$ANIMAL_ID <- sub ('_.*$', '', id.points.out.all@data$uniqueID)
id.points.out.all@data$OBSERVATION_YEAR <-  sub ('^.*_', '', id.points.out.all@data$uniqueID)
id.points.out.all@data$HERD_NAME <- gsub (".*(Snake-Sahtaneh|Maxhamish|Chinchaga|Hart Ranges|Wells Gray|Frisby-Boulder|Columbia North|Groundhog|Monashee|Purcells South|Graham|Telkwa|Atlin|Swan Lake|Quintette|Narraway|Kennedy Siding|Moberly|Scott|Wolverine|Chase|Finlay|Pink Mountain|Tweedsmuir|Frog|Spatsizi|Level Kawdy|Little Rancheria|Edziza|Itcha-Ilgachuz|Rainbows|Charlotte Alplands|Burnt Pine  
).*$", # define ecotype, season, etc. 
                                          "\\1", 
                                          id.points.out.all@data$uniqueID, ignore.case = F)
writeOGR (id.points.out.all, dsn = "C:\\Work\\caribou\\climate_analysis\\data\\samplepoints\\homerange_scale\\homerange_avail_points.shp", 
          layer = "homerange_avail_points", driver = "ESRI Shapefile")

#===============================
# Sample habitat at locations
#===============================

id.points.out.all
prov.locs.all.used

























#================================================
# Bind the available and used locations together
#===============================================
prov.locs.all.used@data$ecotype <- as.character (prov.locs.all.used@data$ecotype)
prov.locs.all.used@data$OBSERVATION_YEAR <- as.character (prov.locs.all.used@data$OBSERVATION_YEAR)
prov.locs.all.used@data$uniqueID <- as.character (prov.locs.all.used@data$uniqueID)
prov.locs.all.used@data$season <- as.character (prov.locs.all.used@data$season)
prov.locs.all.used@data$HERD_NAME <- as.character (prov.locs.all.used@data$HERD_NAME)
prov.locs.all.used@data$ANIMAL_ID <- as.character (prov.locs.all.used@data$ANIMAL_ID)

id.points.out.all <- spTransform (id.points.out.all, CRS = proj4string (prov.locs.all.used)) # reproject
id.points.out.all@data [setdiff (names (prov.locs.all.used@data), names(id.points.out.all@data))] <- NA # create the same column names
prov.locs.all.used@data [setdiff (names (id.points.out.all@data), names(prov.locs.all.used@data))] <- NA # create the same column names
id.points.out.all@data$ptID <- c (453377:1978377)
all.locations <- rbind (prov.locs.all.used, id.points.out.all)


select ()





all.locations@data$ecotype 
all.locations@data$season 
all.locations@data$season 
all.locations@data$year 


as.factor
