---
title: "dataLoaderCLUS"
author: ""
date: "04 September 2018"
output: pdf_document
---

```{r, eval =FALSE}
# Copyright 2018 Province of British Columbia
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and limitations under the License.

```

# Overview

The data loader preps the database connectivitiy and other objects required to run CLUS

#Dependendices

First need an area of interest.
+nameBoundaryFile <- the vector data of the areas to consider. Defaults to caribou herd boundaries.
+nameBoundary<-The specific area of interest
+nameBoundaryColumn<-The colume in the nameBoundaryFile that support the query for the area of interest
+nameBoundaryGeom<-the geometry column from which to run the spatial query containing the area of interest

The remaining files are:
+nameCompartmentRaster<- a provincial raster of compartments -- also known as supply blocks. Defaults to 1 compartment
+nameZoneRaster<-a provincial raster of management zones. Defaluts to 1 zone
+nameYieldRaster<-a provincial raster of id's that support a look up to yield tables. Deflauts to 1 yield table
+nameAgeRaster<- a provincial raster of age. This can be set to zero, if correctly used to look up yields and constraints. Defaults to a age of 120
+nameCrownClosureRaster<- a provincial raster of crown closure. Used for management constraints. Defaluts to a 0 crown closure
+nameMaskHarvestLandbaseRaster<- a provincial raster of the timber harvesting landbase (THLB) that delinates area feasible to harvest timber. Defaults to all of the area of interest being eligible for harvesting.

# Usage

```{r module_usage}
library(SpaDES)
library(SpaDES.core)
source("C:/Users/KLOCHHEA/clus/R/functions/R_Postgres.R")

moduleDir <- file.path("C:/Users/KLOCHHEA/clus/R/SpaDES-modules")
inputDir <- file.path(moduleDir, "inputs") %>% reproducible::checkPath(create = TRUE)
outputDir <- file.path(moduleDir, "outputs")
cacheDir <- file.path(outputDir, "cache")
times <- list(start = 0, end = 10)
parameters <-  list(.progress = list(type = NA, interval = NA),
  .globals = list(),
  dataLoaderCLUS = list(dbName='clus',
                  nameBoundaryFile="study_area_compart",
                  nameBoundaryColumn="tsa_name",
                  nameBoundary='Prince George TSA', 
                  nameBoundaryGeom='wkb_geometry',
                  nameMaskHarvestLandbaseRaster='rast.bc_thlb2018',
                  nameZoneRasters=c("rast.land_unit","rast.land_unit"),
                  nameAgeRaster= "rast.vri2017_projage1",
                  nameHeightRaster= "rast.vri2017_projheight1",
                  nameCrownClosureRaster= "rast.vri2017_crownclosure"))
modules <- list("dataLoaderCLUS")
objects <- list()
paths <- list(
  cachePath = cacheDir,
  modulePath = moduleDir,
  inputPath = inputDir,
  outputPath = outputDir
)

mySim <- simInit(times = times, params = parameters, modules = modules,
                 objects = objects, paths = paths)

spades(mySim)
```

# Events

The module only has an inititialization event for connecting to a database and establishing database objects


## Output data

The outputs contain the database connection object, functions needed to generate queries and the boundary and bounding box of the boundary needed for other queries

# Links to other modules

Links to every module required by CLUS

